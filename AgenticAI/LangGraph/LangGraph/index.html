
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="AIML">
      
      
        <meta name="author" content="Ganesh kinkar Giri">
      
      
      
        <link rel="prev" href="../../crewai/">
      
      
        <link rel="next" href="../LangGraphDetails/">
      
      
        
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.3">
    
    
      
        <title>Overview - AIML documents</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../css/extra.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#agent-architectures" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="AIML documents" class="md-header__button md-logo" aria-label="AIML documents" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            AIML documents
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Overview
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="AIML documents" class="md-nav__button md-logo" aria-label="AIML documents" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    AIML documents
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    AIML
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    AIML
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_1" >
        
          
          <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Programing
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Programing
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Programing/python/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    PYTHON
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Statistic
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Statistic
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_2_1" >
        
          
          <label class="md-nav__link" for="__nav_2_2_1" id="__nav_2_2_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Descriptive Statistics
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Descriptive Statistics
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_2_1_1" >
        
          
          <label class="md-nav__link" for="__nav_2_2_1_1" id="__nav_2_2_1_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Measures of Central Tendency
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_2_1_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_1_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Measures of Central Tendency
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Statistic/DescriptiveStatistics/Measures-of-Central-Tendency/Mean/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Mean
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Statistic/DescriptiveStatistics/Measures-of-Central-Tendency/Median/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Median
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Statistic/DescriptiveStatistics/Measures-of-Central-Tendency/Mode/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Mode
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_2_1_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2_1_2" id="__nav_2_2_1_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Measures of Position (Relative Standing)
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_2_1_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_1_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Measures of Position (Relative Standing)
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Statistic/DescriptiveStatistics/Measures-of-Position-Relative-Standing/Percentiles/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Percentiles
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Statistic/DescriptiveStatistics/Measures-of-Position-Relative-Standing/Quartiles/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Quartiles
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Statistic/DescriptiveStatistics/Measures-of-Position-Relative-Standing/Deciles/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Deciles
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Statistic/DescriptiveStatistics/Measures-of-Position-Relative-Standing/Z-Score/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Z-Score
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_2_1_3" >
        
          
          <label class="md-nav__link" for="__nav_2_2_1_3" id="__nav_2_2_1_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Shape of the Distribution
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_2_1_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_1_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Shape of the Distribution
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Statistic/DescriptiveStatistics/Shape-of-the-Distribution/Skewness/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Skewness
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Statistic/DescriptiveStatistics/Shape-of-the-Distribution/Kurtosis/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Kurtosis
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_2_1_4" >
        
          
          <label class="md-nav__link" for="__nav_2_2_1_4" id="__nav_2_2_1_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Visualization Tools
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_2_1_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_1_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Visualization Tools
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Statistic/DescriptiveStatistics/Visualization-Tools/Histogram/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Histogram
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Statistic/DescriptiveStatistics/Visualization-Tools/BarChart/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Bar Chart
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Statistic/DescriptiveStatistics/Visualization-Tools/PieChart/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Pie Chart
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Statistic/DescriptiveStatistics/Visualization-Tools/BoxPlot/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Box Plot
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Statistic/DescriptiveStatistics/Visualization-Tools/LinePlot/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Line Plot
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Statistic/DescriptiveStatistics/Visualization-Tools/DotPlot/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Dot Plot
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_2_1_5" >
        
          
          <label class="md-nav__link" for="__nav_2_2_1_5" id="__nav_2_2_1_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Measures of Dispersion (Variability)
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_2_1_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_1_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Measures of Dispersion (Variability)
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Statistic/DescriptiveStatistics/Measures-of-Dispersion/Range/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Range
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Statistic/DescriptiveStatistics/Measures-of-Dispersion/Variance/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Variance
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Statistic/DescriptiveStatistics/Measures-of-Dispersion/StandardDeviation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Standard Deviation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Statistic/DescriptiveStatistics/Measures-of-Dispersion/InterquartileRange/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Interquartile Range(IQR)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Statistic/DescriptiveStatistics/Measures-of-Dispersion/CofficientVariation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Cofficient of Variation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2_2" id="__nav_2_2_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Inferential Statistics
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Inferential Statistics
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_2_2_1" >
        
          
          <label class="md-nav__link" for="__nav_2_2_2_1" id="__nav_2_2_2_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Population and Sample
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_2_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_2_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Population and Sample
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Statistic/InferentialStatistics/Population-and-Sample/Population/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Population
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Statistic/InferentialStatistics/Population-and-Sample/Sample/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Sample
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Statistic/InferentialStatistics/Population-and-Sample/SamplingMethods/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Sampling Methods
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_2_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2_2_2" id="__nav_2_2_2_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Estimation
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_2_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_2_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Estimation
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Statistic/InferentialStatistics/Estimation/PointEstimation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Point Estimation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Statistic/InferentialStatistics/Estimation/IntervalEstimation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Interval Estimation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Statistic/InferentialStatistics/Estimation/MarginError/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Margin of Error
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_2_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_2_2_3" id="__nav_2_2_2_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Regression and Correlation Analysis
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_2_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_2_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Regression and Correlation Analysis
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Statistic/InferentialStatistics/Regression-and-Correlation-Analysis/LinearRegression/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Linear Regression
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Statistic/InferentialStatistics/Regression-and-Correlation-Analysis/LogisticRegression/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Logistic Regression
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Statistic/InferentialStatistics/Regression-and-Correlation-Analysis/MultipleRegression/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Multiple Regression
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Statistic/InferentialStatistics/Regression-and-Correlation-Analysis/CorrelationCoefficients/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Correlation Coefficients
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_2_2_4" >
        
          
          <label class="md-nav__link" for="__nav_2_2_2_4" id="__nav_2_2_2_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Hypothesis Testing
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_2_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_2_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Hypothesis Testing
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Statistic/InferentialStatistics/Hypothesis-Testing/NullHypothesis/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Null Hypothesis (H₀)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Statistic/InferentialStatistics/Hypothesis-Testing/AlternativeHypothesis/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Alternative Hypothesis (H₁)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Statistic/InferentialStatistics/Hypothesis-Testing/TestStatistic/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Test Statistic
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Statistic/InferentialStatistics/Hypothesis-Testing/pvalue/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    p-value
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Statistic/InferentialStatistics/Hypothesis-Testing/SignificanceLevel/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Significance Level (α)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Statistic/InferentialStatistics/Hypothesis-Testing/TypeIError/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Type I Error (α)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Statistic/InferentialStatistics/Hypothesis-Testing/TypeIIError/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Type II Error (β)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Statistic/InferentialStatistics/Hypothesis-Testing/PoweroftheTest/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Power of the Test
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_2_2_5" >
        
          
          <label class="md-nav__link" for="__nav_2_2_2_5" id="__nav_2_2_2_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Parametric Tests
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_2_2_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_2_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Parametric Tests
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Statistic/InferentialStatistics/Parametric-Tests/t-test/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    t-test
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Statistic/InferentialStatistics/Parametric-Tests/z-test/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    z-test
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Statistic/InferentialStatistics/Parametric-Tests/ANOVA/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ANOVA
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Statistic/InferentialStatistics/Parametric-Tests/F-test/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    F-test
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_2_2_6" >
        
          
          <label class="md-nav__link" for="__nav_2_2_2_6" id="__nav_2_2_2_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Non-Parametric Tests
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_2_2_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_2_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Non-Parametric Tests
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Statistic/InferentialStatistics/Non-Parametric-Tests/Mann-WhitneyU/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Mann-Whitney U
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Statistic/InferentialStatistics/Non-Parametric-Tests/Kruskal-Wallis/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Kruskal-Wallis
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Statistic/InferentialStatistics/Non-Parametric-Tests/Wilcoxon/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Wilcoxon
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Statistic/InferentialStatistics/Non-Parametric-Tests/Chi-square/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chi-square
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_2_2_7" >
        
          
          <label class="md-nav__link" for="__nav_2_2_2_7" id="__nav_2_2_2_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Resampling Methods
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_2_2_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_2_7">
            <span class="md-nav__icon md-icon"></span>
            
  
    Resampling Methods
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Statistic/InferentialStatistics/Resampling-Methods/Bootstrapping/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Bootstrapping
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Statistic/InferentialStatistics/Resampling-Methods/Jackknife/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Jackknife
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_2_2_8" >
        
          
          <label class="md-nav__link" for="__nav_2_2_2_8" id="__nav_2_2_2_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Analysis of Variance (ANOVA)
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_2_2_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_2_8">
            <span class="md-nav__icon md-icon"></span>
            
  
    Analysis of Variance (ANOVA)
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Statistic/InferentialStatistics/ANOVA/One-way-ANOVA/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    One-way ANOVA
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Statistic/InferentialStatistics/ANOVA/Two-way-ANOVA/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Two-way ANOVA
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Statistic/InferentialStatistics/ANOVA/Post-hoc-Tests/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Post-hoc Tests
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_2_2_9" >
        
          
          <label class="md-nav__link" for="__nav_2_2_2_9" id="__nav_2_2_2_9_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Probability Theory
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_2_2_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_2_9">
            <span class="md-nav__icon md-icon"></span>
            
  
    Probability Theory
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Statistic/InferentialStatistics/Probability-Theory/ProbabilityDistributions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Probability Distributions
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Statistic/InferentialStatistics/Probability-Theory/CentralLimitTheorem/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Central Limit Theorem
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Statistic/InferentialStatistics/Probability-Theory/BayesianInference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Bayesian Inference
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_2_3" id="__nav_2_2_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Time Series
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Time Series
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Statistic/TimeSeries/Trend/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Trend
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Statistic/TimeSeries/Seasonality/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Seasonality
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Statistic/TimeSeries/Cyclic/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Cyclic
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Statistic/TimeSeries/Noise/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Irregular/Noise
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Statistic/TimeSeries/Stationarity/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Stationarity
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Statistic/TimeSeries/Non-stationary/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Non-stationary
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Statistic/TimeSeries/Autocorrelation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Autocorrelation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Statistic/TimeSeries/Lag/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Lag
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Statistic/TimeSeries/MovingAverages/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Moving Averages
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Statistic/TimeSeries/Holt-Winters/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Holt-Winters Method
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Statistic/TimeSeries/Additive/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Additive
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Statistic/TimeSeries/Multiplicative/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Multiplicative
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Statistic/TimeSeries/AR/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    AR (Auto Regression)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Statistic/TimeSeries/ARIMA/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ARIMA
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Statistic/TimeSeries/Arimax/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Arimax
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Statistic/TimeSeries/Sarimax/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Sarimax
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Statistic/TimeSeries/Smoothing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Smoothing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Statistic/TimeSeries/AutomatedForecasting/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Automated Forecasting
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Statistic/TimeSeries/AutomatedTimeSeries/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Automated Time Series
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Statistic/TimeSeries/Multivariate/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Uni, Bi and Multivariate
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Statistic/metrics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Metrics Evaluation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Statistic/timeseries/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Time Series Old
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Statistic/statistic-details/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Statistic Details
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Data manipulation and analysis
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Data manipulation and analysis
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Data-manipulation-and-analysis/data-manipulation-analysis/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    PANDAS
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_4" >
        
          
          <label class="md-nav__link" for="__nav_2_4" id="__nav_2_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Data Processing
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Data Processing
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Data-processing/sql/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Basic SQL
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Data-processing/sql-datascience/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Using SQL for Data Science
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Data-processing/unstructured-data/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Unstructured Data
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Data-processing/exploratory-data-analysis/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Exploratory Data Analysis(EDA)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Data-processing/building-ml-models-on-text-data.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Building ML Models on Text Data
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_5" >
        
          
          <label class="md-nav__link" for="__nav_2_5" id="__nav_2_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Databases
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Databases
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Databases/PostgreSQL/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    PostgreSQL
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Databases/MySQL/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    MySQL
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Databases/MongoDB/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    MongoDB
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_6" >
        
          
          <label class="md-nav__link" for="__nav_2_6" id="__nav_2_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Machine Learning
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Machine Learning
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../MachineLearning/Overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_6_2" >
        
          
          <label class="md-nav__link" for="__nav_2_6_2" id="__nav_2_6_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Supervised Learning
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_6_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_6_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Supervised Learning
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../MachineLearning/SupervisedLearning/Overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../MachineLearning/SupervisedLearning/Regression/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Regression
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../MachineLearning/SupervisedLearning/Classification/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Classification
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../MachineLearning/SupervisedLearning/CrossValidation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Cross Validation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../MachineLearning/SupervisedLearning/HyperparameterTuning/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Hyperparameter Tuning
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../MachineLearning/SupervisedLearning/TuningDecisionThreshold/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Tuning decision threshold
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_6_2_7" >
        
          
          <label class="md-nav__link" for="__nav_2_6_2_7" id="__nav_2_6_2_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Regression Models
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_6_2_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_6_2_7">
            <span class="md-nav__icon md-icon"></span>
            
  
    Regression Models
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../MachineLearning/SupervisedLearning/RegressionModels/SimpleLinearRegression/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Simple Linear Regression
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../MachineLearning/SupervisedLearning/RegressionModels/MultipleLinearRegression/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Multiple Linear Regression
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../MachineLearning/SupervisedLearning/RegressionModels/PolynomialRegression/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Polynomial Regression
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../MachineLearning/SupervisedLearning/RegressionModels/RidgeLassoRegression/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Ridge & Lasso Regression
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../MachineLearning/SupervisedLearning/RegressionModels/SupportVectorRegression/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Support Vector Regression (SVR)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../MachineLearning/SupervisedLearning/RegressionModels/DecisionTreeRegression/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Decision Tree Regression
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../MachineLearning/SupervisedLearning/RegressionModels/RandomForestRegression/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Random Forest Regression
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_6_2_8" >
        
          
          <label class="md-nav__link" for="__nav_2_6_2_8" id="__nav_2_6_2_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Linear Classification Models
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_6_2_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_6_2_8">
            <span class="md-nav__icon md-icon"></span>
            
  
    Linear Classification Models
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../MachineLearning/SupervisedLearning/LinearClassificationModels/LogisticRegression/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Logistic Regression
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../MachineLearning/SupervisedLearning/LinearClassificationModels/SupportVectorMachines/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Support Vector Machines
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../MachineLearning/SupervisedLearning/LinearClassificationModels/SinglelayerPerceptron/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Single-layer Perceptron
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../MachineLearning/SupervisedLearning/LinearClassificationModels/StochasticGradientDescent/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Stochastic Gradient Descent (SGD)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_6_2_9" >
        
          
          <label class="md-nav__link" for="__nav_2_6_2_9" id="__nav_2_6_2_9_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Non-linear Classification Models
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_6_2_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_6_2_9">
            <span class="md-nav__icon md-icon"></span>
            
  
    Non-linear Classification Models
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../MachineLearning/SupervisedLearning/NonlinearClassificationModels/DecisionTreeClassification/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Decision Tree Classification
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../MachineLearning/SupervisedLearning/NonlinearClassificationModels/KNearestNeighbours/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    K-Nearest Neighbours
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../MachineLearning/SupervisedLearning/NonlinearClassificationModels/NaiveBayes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Naive Bayes
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../MachineLearning/SupervisedLearning/NonlinearClassificationModels/RandomForests/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Random Forests
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../MachineLearning/SupervisedLearning/NonlinearClassificationModels/AdaBoost/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    AdaBoost
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../MachineLearning/SupervisedLearning/NonlinearClassificationModels/BaggingClassifier/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Bagging Classifier
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../MachineLearning/SupervisedLearning/NonlinearClassificationModels/Ensemblelearningclassifiers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Ensemble learning classifiers
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../MachineLearning/SupervisedLearning/NonlinearClassificationModels/KernelSVM/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Kernel SVM
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_6_3" >
        
          
          <label class="md-nav__link" for="__nav_2_6_3" id="__nav_2_6_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Unsupervised Learning
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_6_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_6_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Unsupervised Learning
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../MachineLearning/UnsupervisedLearning/overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../MachineLearning/UnsupervisedLearning/Clustering/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Clustering
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../MachineLearning/UnsupervisedLearning/Pca/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Principal Component Analysis(PCA)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_6_4" >
        
          
          <label class="md-nav__link" for="__nav_2_6_4" id="__nav_2_6_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Reinforcement Learning
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_6_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_6_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Reinforcement Learning
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../MachineLearning/ReinforcementLearning/ReinforcementLearning/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_7" >
        
          
          <label class="md-nav__link" for="__nav_2_7" id="__nav_2_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Linear Algebra
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_7">
            <span class="md-nav__icon md-icon"></span>
            
  
    Linear Algebra
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../LinearAlgebra/Overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_8" >
        
          
          <label class="md-nav__link" for="__nav_2_8" id="__nav_2_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Deep Learning
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_8">
            <span class="md-nav__icon md-icon"></span>
            
  
    Deep Learning
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../DeepLearning/Overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../DeepLearning/Vanishing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Vanishing and Exploding Gradients Problems
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_8_3" >
        
          
          <label class="md-nav__link" for="__nav_2_8_3" id="__nav_2_8_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Components of Neural Networks
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_8_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_8_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Components of Neural Networks
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../DeepLearning/Components/LayersNeuralNetworks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Layers in Neural Networks
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../DeepLearning/Components/WeightsBiases/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Weights and Biases
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../DeepLearning/Components/ForwardPropagation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Forward Propagation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../DeepLearning/Components/ActivationFunctions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Activation Functions
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../DeepLearning/Components/LossFunctions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Loss Functions
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../DeepLearning/Components/Backpropagation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Backpropagation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../DeepLearning/Components/LearningRate/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Learning Rate
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_8_4" >
        
          
          <label class="md-nav__link" for="__nav_2_8_4" id="__nav_2_8_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Optimization Algorithm
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_8_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_8_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Optimization Algorithm
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../DeepLearning/OptimizationAlgorithm/GradientDescent/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Gradient Descent
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../DeepLearning/OptimizationAlgorithm/SGD/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Stochastic Gradient Descent (SGD)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../DeepLearning/OptimizationAlgorithm/Adam/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Adam (Adaptive Moment Estimation)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../DeepLearning/OptimizationAlgorithm/BatchNormalization/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Batch Normalization
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../DeepLearning/OptimizationAlgorithm/Mini-batch-GD/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Mini-batch Gradient Descent
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../DeepLearning/OptimizationAlgorithm/Momentum-based-GO/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Momentum-based Gradient Optimizer
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../DeepLearning/OptimizationAlgorithm/AdagradOptimizer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Adagrad Optimizer
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../DeepLearning/OptimizationAlgorithm/RMSPropOptimizer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    RMSProp Optimizer
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_8_5" >
        
          
          <label class="md-nav__link" for="__nav_2_8_5" id="__nav_2_8_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Models
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_8_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_8_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Models
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../DeepLearning/Models/FNN/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Feedforward Neural Network (FNN)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_8_5_2" >
        
          
          <label class="md-nav__link" for="__nav_2_8_5_2" id="__nav_2_8_5_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Recurrent Neural Network (RNN)
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_8_5_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_8_5_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Recurrent Neural Network (RNN)
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../DeepLearning/Models/RNN/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Recurrent Neural Network (RNN)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../DeepLearning/Models/LSTM/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    LSTM (Long Short-Term Memory)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../DeepLearning/Models/GRU/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    GRU (Gated Recurrent Unit)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../DeepLearning/Models/CNN/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Convolutional Neural Network (CNN)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../DeepLearning/Models/RBFN/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Radial Basis Function Network (RBFN)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../DeepLearning/Models/ComputerVision/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Computer Vision
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../DeepLearning/Models/GANs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Generative Adversarial Networks (GANs)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../DeepLearning/Models/Transformer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Transformer Networks
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../DeepLearning/Models/Autoencoders/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Autoencoders
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../DeepLearning/Models/SOM/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Self-Organizing Maps (SOM)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_9" >
        
          
          <label class="md-nav__link" for="__nav_2_9" id="__nav_2_9_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Natural Language Processing(NLP)
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_9">
            <span class="md-nav__icon md-icon"></span>
            
  
    Natural Language Processing(NLP)
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../NLP/overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../NLP/nlpdetails/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    NLP Details
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_10" >
        
          
          <label class="md-nav__link" for="__nav_2_10" id="__nav_2_10_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Computer Vision
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_10">
            <span class="md-nav__icon md-icon"></span>
            
  
    Computer Vision
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Computer-Vision/Overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_10_2" >
        
          
          <label class="md-nav__link" for="__nav_2_10_2" id="__nav_2_10_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Traditional CV (Before deep learning)
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_10_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_10_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Traditional CV (Before deep learning)
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Computer-Vision/Edge-detection.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Edge detection
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Computer-Vision/Feature-extraction.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Feature extraction
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Computer-Vision/Image-filtering.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Image filtering
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Computer-Vision/Template-matching.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Template matching
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Computer-Vision/Optical-flow.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Optical flow
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Computer-Vision/Histogram-analysis.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Histogram analysis
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Computer-Vision/Rule-based-vision-systems.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Rule-based vision systems
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_10_3" >
        
          
          <label class="md-nav__link" for="__nav_2_10_3" id="__nav_2_10_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Modern CV (Deep learning–based)
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_10_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_10_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Modern CV (Deep learning–based)
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Computer-Vision/CNNs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    CNNs
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Computer-Vision/ViT.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Vision Transformers (ViT)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Computer-Vision/YOLO.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    YOLO
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Computer-Vision/Faster-R-CNN.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Faster R-CNN
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Computer-Vision/Mask-R-CNN.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Mask R-CNN
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Computer-Vision/Diffusion-models.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Diffusion models (for vision generation)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_10_4" >
        
          
          <label class="md-nav__link" for="__nav_2_10_4" id="__nav_2_10_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Common Computer Vision tasks
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_10_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_10_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Common Computer Vision tasks
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Computer-Vision/Image-classification.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Image classification
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Computer-Vision/Object-detection.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Object detection
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Computer-Vision/Face-recognition.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Face recognition
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Computer-Vision/OCR.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    OCR (text from images)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Computer-Vision/Medical-imaging-analysis.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Medical imaging analysis
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Computer-Vision/Autonomous-driving-vision.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Autonomous driving vision
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Computer-Vision/Video-analytics.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Video analytics
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Computer-Vision/Industrial-inspection.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Industrial inspection
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../OpenCV/OpenCV/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    OpenCV
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_11" >
        
          
          <label class="md-nav__link" for="__nav_2_11" id="__nav_2_11_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Retrieval-Augmented Generation(RAG)
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_11">
            <span class="md-nav__icon md-icon"></span>
            
  
    Retrieval-Augmented Generation(RAG)
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../RAG/rag/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    RAG
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_12" >
        
          
          <label class="md-nav__link" for="__nav_2_12" id="__nav_2_12_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    AI agents
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_12_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_12">
            <span class="md-nav__icon md-icon"></span>
            
  
    AI agents
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../AIagents/aiagents/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    AI agents
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_13" checked>
        
          
          <label class="md-nav__link" for="__nav_2_13" id="__nav_2_13_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Agentic AI
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_13_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_13">
            <span class="md-nav__icon md-icon"></span>
            
  
    Agentic AI
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../framework/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Framework
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../design-patterns/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Design Patterns
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../general/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    general
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../crewai/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    crewai
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_13_6" checked>
        
          
          <label class="md-nav__link" for="__nav_2_13_6" id="__nav_2_13_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    LangGraph
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_13_6_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_13_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    LangGraph
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#agent-architectures" class="md-nav__link">
    <span class="md-ellipsis">
      
        Agent architectures
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tools" class="md-nav__link">
    <span class="md-ellipsis">
      
        Tools
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#custom-tools" class="md-nav__link">
    <span class="md-ellipsis">
      
        Custom tools
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#call-tools" class="md-nav__link">
    <span class="md-ellipsis">
      
        Call tools
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#use-in-an-agent" class="md-nav__link">
    <span class="md-ellipsis">
      
        Use in an agent
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dynamically-select-tools" class="md-nav__link">
    <span class="md-ellipsis">
      
        Dynamically select tools
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#use-in-a-workflow" class="md-nav__link">
    <span class="md-ellipsis">
      
        Use in a workflow
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tool-customization" class="md-nav__link">
    <span class="md-ellipsis">
      
        Tool customization
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#context-management" class="md-nav__link">
    <span class="md-ellipsis">
      
        Context management
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#advanced-tool-features" class="md-nav__link">
    <span class="md-ellipsis">
      
        Advanced tool features
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#human-in-the-loop" class="md-nav__link">
    <span class="md-ellipsis">
      
        Human-in-the-loop
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#enable-human-intervention" class="md-nav__link">
    <span class="md-ellipsis">
      
        Enable human intervention
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#time-travel" class="md-nav__link">
    <span class="md-ellipsis">
      
        Time Travel
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#subgraphs" class="md-nav__link">
    <span class="md-ellipsis">
      
        Subgraphs
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#use-subgraphs" class="md-nav__link">
    <span class="md-ellipsis">
      
        Use subgraphs
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#multi-agent-systems" class="md-nav__link">
    <span class="md-ellipsis">
      
        Multi-agent systems
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#multi-agent-architectures" class="md-nav__link">
    <span class="md-ellipsis">
      
        Multi-agent architectures
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#multi-agent" class="md-nav__link">
    <span class="md-ellipsis">
      
        Multi-agent
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#build-multi-agent-systems" class="md-nav__link">
    <span class="md-ellipsis">
      
        Build multi-agent systems
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mcp" class="md-nav__link">
    <span class="md-ellipsis">
      
        MCP
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tracing" class="md-nav__link">
    <span class="md-ellipsis">
      
        Tracing
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evals" class="md-nav__link">
    <span class="md-ellipsis">
      
        Evals
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#reference" class="md-nav__link">
    <span class="md-ellipsis">
      
        Reference
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../LangGraphDetails/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    LangGraph Graph API
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Subgraphs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Subgraphs
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Interrupts.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Interrupts
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../time-travel/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Time travel
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../LangGraph-runtime/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    LangGraph runtime
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Durable-execution/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Durable execution
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Install/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Install
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph-api/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Graph API
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../functional-api/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Functional API
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../local-server/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Run local server
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../workflows/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Workflows
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../agents/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Agents
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../persistence/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Persistence
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../memory/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Memory
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../streaming/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Streaming
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../interrupts/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Interrupts
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Graph
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../node/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Node
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../edge/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Edge
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../AutoGen/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    AutoGen
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../aws/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    AWS
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_13_9" >
        
          
          <label class="md-nav__link" for="__nav_2_13_9" id="__nav_2_13_9_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    AZURE
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_13_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_13_9">
            <span class="md-nav__icon md-icon"></span>
            
  
    AZURE
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../AZURE/azure/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../AZURE/azure-openai-foundry-modelsure/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Azure OpenAI Foundry models
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_13_10" >
        
          
          <label class="md-nav__link" for="__nav_2_13_10" id="__nav_2_13_10_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Agent Development Kit
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_13_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_13_10">
            <span class="md-nav__icon md-icon"></span>
            
  
    Agent Development Kit
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../GCP/adk/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ADK
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../GCP/Agents/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Agents
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../GCP/Tools/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Tools
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../GCP/a2a/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Tools
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_14" >
        
          
          <label class="md-nav__link" for="__nav_2_14" id="__nav_2_14_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Agent to Agent(A2A)
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_14_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_14">
            <span class="md-nav__icon md-icon"></span>
            
  
    Agent to Agent(A2A)
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../A2A/a2a/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    A2A
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_15" >
        
          
          <label class="md-nav__link" for="__nav_2_15" id="__nav_2_15_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Temporal
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_15_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_15">
            <span class="md-nav__icon md-icon"></span>
            
  
    Temporal
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Temporal/temporal-overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Temporal/setup/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Setup
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Temporal/core-application/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Core application
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Temporal/Temporal-client/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Temporal Client
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_16" >
        
          
          <label class="md-nav__link" for="__nav_2_16" id="__nav_2_16_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    MCPModel Context Protocol(MCP)
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_16_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_16">
            <span class="md-nav__icon md-icon"></span>
            
  
    MCPModel Context Protocol(MCP)
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../MCP/mcp/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    MCP
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_17" >
        
          
          <label class="md-nav__link" for="__nav_2_17" id="__nav_2_17_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Vector Databases
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_17_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_17">
            <span class="md-nav__icon md-icon"></span>
            
  
    Vector Databases
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../VectorDatabases/PgVector/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    PgVector
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../VectorDatabases/OpenSearch/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    OpenSearch
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_18" >
        
          
          <label class="md-nav__link" for="__nav_2_18" id="__nav_2_18_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Graph Databases
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_18_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_18">
            <span class="md-nav__icon md-icon"></span>
            
  
    Graph Databases
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../GraphDatabases/neo4j-setup/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    neo4j setup
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../GraphDatabases/neo4j-cypher/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    neo4j Cypher
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_19" >
        
          
          <label class="md-nav__link" for="__nav_2_19" id="__nav_2_19_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Models Details information
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_19_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_19">
            <span class="md-nav__icon md-icon"></span>
            
  
    Models Details information
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Models/Ollama/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Ollama
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_20" >
        
          
          <label class="md-nav__link" for="__nav_2_20" id="__nav_2_20_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Note Book
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_20_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_20">
            <span class="md-nav__icon md-icon"></span>
            
  
    Note Book
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Notebook/allnotebook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    All Notebook
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_21" >
        
          
          <label class="md-nav__link" for="__nav_2_21" id="__nav_2_21_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Pypi Library
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_21_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_21">
            <span class="md-nav__icon md-icon"></span>
            
  
    Pypi Library
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Pypi/Pypi-lib-details/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Pypi Library Details
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#agent-architectures" class="md-nav__link">
    <span class="md-ellipsis">
      
        Agent architectures
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tools" class="md-nav__link">
    <span class="md-ellipsis">
      
        Tools
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#custom-tools" class="md-nav__link">
    <span class="md-ellipsis">
      
        Custom tools
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#call-tools" class="md-nav__link">
    <span class="md-ellipsis">
      
        Call tools
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#use-in-an-agent" class="md-nav__link">
    <span class="md-ellipsis">
      
        Use in an agent
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dynamically-select-tools" class="md-nav__link">
    <span class="md-ellipsis">
      
        Dynamically select tools
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#use-in-a-workflow" class="md-nav__link">
    <span class="md-ellipsis">
      
        Use in a workflow
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tool-customization" class="md-nav__link">
    <span class="md-ellipsis">
      
        Tool customization
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#context-management" class="md-nav__link">
    <span class="md-ellipsis">
      
        Context management
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#advanced-tool-features" class="md-nav__link">
    <span class="md-ellipsis">
      
        Advanced tool features
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#human-in-the-loop" class="md-nav__link">
    <span class="md-ellipsis">
      
        Human-in-the-loop
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#enable-human-intervention" class="md-nav__link">
    <span class="md-ellipsis">
      
        Enable human intervention
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#time-travel" class="md-nav__link">
    <span class="md-ellipsis">
      
        Time Travel
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#subgraphs" class="md-nav__link">
    <span class="md-ellipsis">
      
        Subgraphs
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#use-subgraphs" class="md-nav__link">
    <span class="md-ellipsis">
      
        Use subgraphs
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#multi-agent-systems" class="md-nav__link">
    <span class="md-ellipsis">
      
        Multi-agent systems
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#multi-agent-architectures" class="md-nav__link">
    <span class="md-ellipsis">
      
        Multi-agent architectures
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#multi-agent" class="md-nav__link">
    <span class="md-ellipsis">
      
        Multi-agent
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#build-multi-agent-systems" class="md-nav__link">
    <span class="md-ellipsis">
      
        Build multi-agent systems
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mcp" class="md-nav__link">
    <span class="md-ellipsis">
      
        MCP
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tracing" class="md-nav__link">
    <span class="md-ellipsis">
      
        Tracing
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evals" class="md-nav__link">
    <span class="md-ellipsis">
      
        Evals
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#reference" class="md-nav__link">
    <span class="md-ellipsis">
      
        Reference
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
                



  


  <nav class="md-path" aria-label="Navigation" >
    <ol class="md-path__list">
      
        
  
  
    <li class="md-path__item">
      <a href="../../.." class="md-path__link">
        
  <span class="md-ellipsis">
    Home
  </span>

      </a>
    </li>
  

      
      
        
  
  
    
    
      
  
  
    
    
      <li class="md-path__item">
        <a href="../../../Programing/python/" class="md-path__link">
          
  <span class="md-ellipsis">
    AIML
  </span>

        </a>
      </li>
    
  

    
  

      
        
  
  
    
    
      <li class="md-path__item">
        <a href="../../framework/" class="md-path__link">
          
  <span class="md-ellipsis">
    Agentic AI
  </span>

        </a>
      </li>
    
  

      
        
  
  
    
    
      <li class="md-path__item">
        <a href="./" class="md-path__link">
          
  <span class="md-ellipsis">
    LangGraph
  </span>

        </a>
      </li>
    
  

      
    </ol>
  </nav>

              
              <article class="md-content__inner md-typeset">
                
                  



  <h1>Overview</h1>

<h3 style="color:red;">✅ LangGraph</h3>

<h3 style="color:blue;">📌 What is LangGraph?</h3>
<p>LangGraph is built for developers who want to build powerful, adaptable AI agents.Developers choose LangGraph for:</p>
<ul>
<li>
<p><strong>Reliability and controllability.</strong> Steer agent actions with moderation checks and human-in-the-loop approvals. LangGraph persists context for long-running workflows, keeping your agents on course.</p>
</li>
<li>
<p><strong>Low-level and extensible.</strong> Build custom agents with fully descriptive, low-level primitives free from rigid abstractions that limit customization. Design scalable multi-agent systems, with each agent serving a specific role tailored to your use case.</p>
</li>
<li>
<p><strong>First-class streaming support.</strong> With token-by-token streaming and streaming of intermediate steps, LangGraph gives users clear visibility into agent reasoning and actions as they unfold in real time.</p>
</li>
</ul>
<h3 style="color:blue;">📌 Learn LangGraph basics</h3>

<ol>
<li><strong>Build a basic chatbot</strong></li>
<li><strong>Add tools</strong></li>
<li><strong>Add memory</strong></li>
<li><strong>Add human-in-the-loop controls</strong></li>
<li><strong>Customize state</strong></li>
<li><strong>Time travel</strong></li>
</ol>
<h2 id="agent-architectures">Agent architectures<a class="headerlink" href="#agent-architectures" title="Permanent link">#</a></h2>
<p>Many LLM applications implement a particular control flow of steps before and / or after LLM calls. As an example, RAG performs retrieval of documents relevant to a user question, and passes those documents to an LLM in order to ground the model's response in the provided document context.</p>
<p>Instead of hard-coding a fixed control flow, we sometimes want LLM systems that can pick their own control flow to solve more complex problems! This is one definition of an agent: an agent is a system that uses an LLM to decide the control flow of an application. There are many ways that an LLM can control application:</p>
<ul>
<li>
<p>An LLM can route between two potential paths</p>
</li>
<li>
<p>An LLM can decide which of many tools to call</p>
</li>
<li>
<p>An LLM can decide whether the generated answer is sufficient or more work is needed</p>
</li>
</ul>
<p><strong>Router</strong></p>
<p>A router allows an LLM to select a single step from a specified set of options. This is an agent architecture that exhibits a relatively limited level of control because the LLM usually focuses on making a single decision and produces a specific output from a limited set of pre-defined options. Routers typically employ a few different concepts to achieve this.</p>
<p><strong>Structured Output</strong></p>
<p>Structured outputs with LLMs work by providing a specific format or schema that the LLM should follow in its response. This is similar to tool calling, but more general. While tool calling typically involves selecting and using predefined functions, structured outputs can be used for any type of formatted response. Common methods to achieve structured outputs include:</p>
<ol>
<li>
<p><strong>Prompt engineering:</strong> Instructing the LLM to respond in a specific format via the system prompt.</p>
</li>
<li>
<p><strong>Output parsers:</strong> Using post-processing to extract structured data from LLM responses.</p>
</li>
<li>
<p><strong>Tool calling:</strong> Leveraging built-in tool calling capabilities of some LLMs to generate structured outputs.</p>
</li>
</ol>
<p><strong>Tool-calling agent</strong></p>
<p>cWhile a router allows an LLM to make a single decision, more complex agent architectures expand the LLM's control in two key ways:</p>
<ol>
<li>
<p>Multi-step decision making: The LLM can make a series of decisions, one after another, instead of just one.</p>
</li>
<li>
<p>Tool access:The LLM can choose from and use a variety of tools to accomplish tasks.</p>
</li>
</ol>
<h3 style="color:blue;">📌 Install LangGraph:</h3>

<div class="language-text highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>pip install -U langgraph
</span></code></pre></div>
<h3 style="color:blue;">📌 create an agent using prebuilt components:</h3>

<div class="language-text highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>import os
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>from langgraph.prebuilt import create_react_agent
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>from langchain.chat_models import init_chat_model
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a>
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a>os.environ[&quot;OPENAI_API_KEY&quot;] = &quot;sk-proj-*****&quot;
</span><span id="__span-1-7"><a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a>llm = init_chat_model(&quot;openai:gpt-4.1&quot;)
</span><span id="__span-1-8"><a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a>
</span><span id="__span-1-9"><a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a>def get_weather(city: str) -&gt; str:
</span><span id="__span-1-10"><a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a>    &quot;&quot;&quot;Get weather for a given city.&quot;&quot;&quot;
</span><span id="__span-1-11"><a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a>    return f&quot;It&#39;s always sunny in {city}!&quot;
</span><span id="__span-1-12"><a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a>
</span><span id="__span-1-13"><a id="__codelineno-1-13" name="__codelineno-1-13" href="#__codelineno-1-13"></a>agent = create_react_agent(
</span><span id="__span-1-14"><a id="__codelineno-1-14" name="__codelineno-1-14" href="#__codelineno-1-14"></a>    model=llm,
</span><span id="__span-1-15"><a id="__codelineno-1-15" name="__codelineno-1-15" href="#__codelineno-1-15"></a>    tools=[get_weather],
</span><span id="__span-1-16"><a id="__codelineno-1-16" name="__codelineno-1-16" href="#__codelineno-1-16"></a>    prompt=&quot;You are a helpful assistant&quot;
</span><span id="__span-1-17"><a id="__codelineno-1-17" name="__codelineno-1-17" href="#__codelineno-1-17"></a>)
</span><span id="__span-1-18"><a id="__codelineno-1-18" name="__codelineno-1-18" href="#__codelineno-1-18"></a>
</span><span id="__span-1-19"><a id="__codelineno-1-19" name="__codelineno-1-19" href="#__codelineno-1-19"></a># Run the agent
</span><span id="__span-1-20"><a id="__codelineno-1-20" name="__codelineno-1-20" href="#__codelineno-1-20"></a>result = agent.invoke(
</span><span id="__span-1-21"><a id="__codelineno-1-21" name="__codelineno-1-21" href="#__codelineno-1-21"></a>    {&quot;messages&quot;: [{&quot;role&quot;: &quot;user&quot;, &quot;content&quot;: &quot;what is the weather in sf&quot;}]}
</span><span id="__span-1-22"><a id="__codelineno-1-22" name="__codelineno-1-22" href="#__codelineno-1-22"></a>)
</span><span id="__span-1-23"><a id="__codelineno-1-23" name="__codelineno-1-23" href="#__codelineno-1-23"></a>
</span><span id="__span-1-24"><a id="__codelineno-1-24" name="__codelineno-1-24" href="#__codelineno-1-24"></a># Print the output
</span><span id="__span-1-25"><a id="__codelineno-1-25" name="__codelineno-1-25" href="#__codelineno-1-25"></a>print(result[&#39;messages&#39;][-1].content)
</span></code></pre></div>
<p><strong>Output:</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>python langgraph_test.py
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>The weather in San Francisco is reported to be always sunny! If you need a more detailed or up-to-date weather report, please let me know.
</span></code></pre></div>
<h3 style="color:blue;">📌 Core benefits</h3>

<p>LangGraph provides low-level supporting infrastructure for any long-running, stateful workflow or agent. LangGraph does not abstract prompts or architecture, and provides the following central benefits:</p>
<ul>
<li>
<p><strong>Durable execution:</strong> Build agents that persist through failures and can run for extended periods, automatically resuming from exactly where they left off.</p>
</li>
<li>
<p><strong>Human-in-the-loop:</strong> Seamlessly incorporate human oversight by inspecting and modifying agent state at any point during execution.</p>
</li>
<li>
<p><strong>Comprehensive memory:</strong> Create truly stateful agents with both short-term working memory for ongoing reasoning and long-term persistent memory across sessions.</p>
</li>
<li>
<p><strong>Debugging with LangSmith:</strong> Gain deep visibility into complex agent behavior with visualization tools that trace execution paths, capture state transitions, and provide detailed runtime metrics.</p>
</li>
<li>
<p><strong>Production-ready deployment:</strong> Deploy sophisticated agent systems confidently with scalable infrastructure designed to handle the unique challenges of stateful, long-running workflows.</p>
</li>
</ul>
<h3 style="color:blue;">📌 LangGraph’s ecosystem</h3>

<p>While LangGraph can be used standalone, it also integrates seamlessly with any LangChain product, giving developers a full suite of tools for building agents. To improve your LLM application development, pair LangGraph with:</p>
<ul>
<li>
<p><strong>LangSmith</strong> — Helpful for agent evals and observability. Debug poor-performing LLM app runs, evaluate agent trajectories, gain visibility in production, and improve performance over time.</p>
</li>
<li>
<p><strong>LangGraph Platform</strong> — Deploy and scale agents effortlessly with a purpose-built deployment platform for long running, stateful workflows. Discover, reuse, configure, and share agents across teams — and iterate quickly with visual prototyping in LangGraph Studio.</p>
</li>
<li>
<p><strong>LangChain</strong> – Provides integrations and composable components to streamline LLM application development.</p>
</li>
</ul>
<h3 style="color:blue;">📌 Models</h3>

<p>LangGraph provides built-in support for LLMs (language models) via the LangChain library. This makes it easy to integrate various LLMs into your agents and workflows.</p>
<p><strong>Initialize a model</strong></p>
<p>Use <code>init_chat_model</code> to initialize models:</p>
<h3 style="color:blue;">📌 OpenAI:</h3>

<div class="language-text highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>pip install -U &quot;langchain[openai]&quot;
</span></code></pre></div>
<div class="language-text highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>import os
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>from langchain.chat_models import init_chat_model
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a>os.environ[&quot;OPENAI_API_KEY&quot;] = &quot;sk-...&quot;
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a>
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a>llm = init_chat_model(&quot;openai:gpt-4.1&quot;)
</span></code></pre></div>
<h3 style="color:blue;">📌 Anthropic:</h3>

<div class="language-text highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>pip install -U &quot;langchain[anthropic]&quot;
</span></code></pre></div>
<div class="language-text highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>import os
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>from langchain.chat_models import init_chat_model
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a>
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a>os.environ[&quot;ANTHROPIC_API_KEY&quot;] = &quot;sk-...&quot;
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a>
</span><span id="__span-6-6"><a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a>llm = init_chat_model(&quot;anthropic:claude-3-5-sonnet-latest&quot;)
</span></code></pre></div>
<h3 style="color:blue;">📌 Azure:</h3>

<div class="language-text highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>pip install -U &quot;langchain[openai]&quot;
</span></code></pre></div>
<div class="language-text highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>import os
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>from langchain.chat_models import init_chat_model
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a>
</span><span id="__span-8-4"><a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a>os.environ[&quot;AZURE_OPENAI_API_KEY&quot;] = &quot;...&quot;
</span><span id="__span-8-5"><a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a>os.environ[&quot;AZURE_OPENAI_ENDPOINT&quot;] = &quot;...&quot;
</span><span id="__span-8-6"><a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a>os.environ[&quot;OPENAI_API_VERSION&quot;] = &quot;2025-03-01-preview&quot;
</span><span id="__span-8-7"><a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a>
</span><span id="__span-8-8"><a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a>llm = init_chat_model(
</span><span id="__span-8-9"><a id="__codelineno-8-9" name="__codelineno-8-9" href="#__codelineno-8-9"></a>    &quot;azure_openai:gpt-4.1&quot;,
</span><span id="__span-8-10"><a id="__codelineno-8-10" name="__codelineno-8-10" href="#__codelineno-8-10"></a>    azure_deployment=os.environ[&quot;AZURE_OPENAI_DEPLOYMENT_NAME&quot;],
</span><span id="__span-8-11"><a id="__codelineno-8-11" name="__codelineno-8-11" href="#__codelineno-8-11"></a>)
</span></code></pre></div>
<h3 style="color:blue;">📌 Google Gemini:</h3>

<div class="language-text highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a>pip install -U &quot;langchain[google-genai]&quot;
</span></code></pre></div>
<div class="language-text highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a>import os
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a>from langchain.chat_models import init_chat_model
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a>
</span><span id="__span-10-4"><a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a>os.environ[&quot;GOOGLE_API_KEY&quot;] = &quot;...&quot;
</span><span id="__span-10-5"><a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a>
</span><span id="__span-10-6"><a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a>llm = init_chat_model(&quot;google_genai:gemini-2.0-flash&quot;)
</span></code></pre></div>
<h3 style="color:blue;">📌 AWS Bedrock:</h3>

<div class="language-text highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a>pip install -U &quot;langchain[aws]&quot;
</span></code></pre></div>
<div class="language-text highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a>from langchain.chat_models import init_chat_model
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a>
</span><span id="__span-12-3"><a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a># Follow the steps here to configure your credentials:
</span><span id="__span-12-4"><a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a># https://docs.aws.amazon.com/bedrock/latest/userguide/getting-started.html
</span><span id="__span-12-5"><a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a>
</span><span id="__span-12-6"><a id="__codelineno-12-6" name="__codelineno-12-6" href="#__codelineno-12-6"></a>llm = init_chat_model(
</span><span id="__span-12-7"><a id="__codelineno-12-7" name="__codelineno-12-7" href="#__codelineno-12-7"></a>    &quot;anthropic.claude-3-5-sonnet-20240620-v1:0&quot;,
</span><span id="__span-12-8"><a id="__codelineno-12-8" name="__codelineno-12-8" href="#__codelineno-12-8"></a>    model_provider=&quot;bedrock_converse&quot;,
</span><span id="__span-12-9"><a id="__codelineno-12-9" name="__codelineno-12-9" href="#__codelineno-12-9"></a>)
</span></code></pre></div>
<h3 style="color:blue;">📌 Instantiate a model directly</h3>

<p>If a model provider is not available via init_chat_model, you can instantiate the provider's model class directly. The model must implement the BaseChatModel interface and support tool calling:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a># Anthropic is already supported by `init_chat_model`,
</span><span id="__span-13-2"><a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a># but you can also instantiate it directly.
</span><span id="__span-13-3"><a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a>from langchain_anthropic import ChatAnthropic
</span><span id="__span-13-4"><a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a>
</span><span id="__span-13-5"><a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a>model = ChatAnthropic(
</span><span id="__span-13-6"><a id="__codelineno-13-6" name="__codelineno-13-6" href="#__codelineno-13-6"></a>  model=&quot;claude-3-7-sonnet-latest&quot;,
</span><span id="__span-13-7"><a id="__codelineno-13-7" name="__codelineno-13-7" href="#__codelineno-13-7"></a>  temperature=0,
</span><span id="__span-13-8"><a id="__codelineno-13-8" name="__codelineno-13-8" href="#__codelineno-13-8"></a>  max_tokens=2048
</span><span id="__span-13-9"><a id="__codelineno-13-9" name="__codelineno-13-9" href="#__codelineno-13-9"></a>)
</span></code></pre></div>
<h3 style="color:blue;">📌 Dynamic model selection</h3>

<p>Pass a callable function to create_react_agent to dynamically select the model at runtime. This is useful for scenarios where you want to choose a model based on user input, configuration settings, or other runtime conditions.</p>
<p>The selector function must return a chat model. If you're using tools, you must bind the tools to the model within the selector function.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a>from dataclasses import dataclass
</span><span id="__span-14-2"><a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a>from typing import Literal
</span><span id="__span-14-3"><a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a>from langchain.chat_models import init_chat_model
</span><span id="__span-14-4"><a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a>from langchain_core.language_models import BaseChatModel
</span><span id="__span-14-5"><a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a>from langchain_core.tools import tool
</span><span id="__span-14-6"><a id="__codelineno-14-6" name="__codelineno-14-6" href="#__codelineno-14-6"></a>from langgraph.prebuilt import create_react_agent
</span><span id="__span-14-7"><a id="__codelineno-14-7" name="__codelineno-14-7" href="#__codelineno-14-7"></a>from langgraph.prebuilt.chat_agent_executor import AgentState
</span><span id="__span-14-8"><a id="__codelineno-14-8" name="__codelineno-14-8" href="#__codelineno-14-8"></a>from langgraph.runtime import Runtime
</span><span id="__span-14-9"><a id="__codelineno-14-9" name="__codelineno-14-9" href="#__codelineno-14-9"></a>
</span><span id="__span-14-10"><a id="__codelineno-14-10" name="__codelineno-14-10" href="#__codelineno-14-10"></a>@tool
</span><span id="__span-14-11"><a id="__codelineno-14-11" name="__codelineno-14-11" href="#__codelineno-14-11"></a>def weather() -&gt; str:
</span><span id="__span-14-12"><a id="__codelineno-14-12" name="__codelineno-14-12" href="#__codelineno-14-12"></a>    &quot;&quot;&quot;Returns the current weather conditions.&quot;&quot;&quot;
</span><span id="__span-14-13"><a id="__codelineno-14-13" name="__codelineno-14-13" href="#__codelineno-14-13"></a>    return &quot;It&#39;s nice and sunny.&quot;
</span><span id="__span-14-14"><a id="__codelineno-14-14" name="__codelineno-14-14" href="#__codelineno-14-14"></a>
</span><span id="__span-14-15"><a id="__codelineno-14-15" name="__codelineno-14-15" href="#__codelineno-14-15"></a>
</span><span id="__span-14-16"><a id="__codelineno-14-16" name="__codelineno-14-16" href="#__codelineno-14-16"></a># Define the runtime context
</span><span id="__span-14-17"><a id="__codelineno-14-17" name="__codelineno-14-17" href="#__codelineno-14-17"></a>@dataclass
</span><span id="__span-14-18"><a id="__codelineno-14-18" name="__codelineno-14-18" href="#__codelineno-14-18"></a>class CustomContext:
</span><span id="__span-14-19"><a id="__codelineno-14-19" name="__codelineno-14-19" href="#__codelineno-14-19"></a>    provider: Literal[&quot;anthropic&quot;, &quot;openai&quot;]
</span><span id="__span-14-20"><a id="__codelineno-14-20" name="__codelineno-14-20" href="#__codelineno-14-20"></a>
</span><span id="__span-14-21"><a id="__codelineno-14-21" name="__codelineno-14-21" href="#__codelineno-14-21"></a># Initialize models
</span><span id="__span-14-22"><a id="__codelineno-14-22" name="__codelineno-14-22" href="#__codelineno-14-22"></a>openai_model = init_chat_model(&quot;openai:gpt-4o&quot;)
</span><span id="__span-14-23"><a id="__codelineno-14-23" name="__codelineno-14-23" href="#__codelineno-14-23"></a>anthropic_model = init_chat_model(&quot;anthropic:claude-sonnet-4-20250514&quot;)
</span><span id="__span-14-24"><a id="__codelineno-14-24" name="__codelineno-14-24" href="#__codelineno-14-24"></a>
</span><span id="__span-14-25"><a id="__codelineno-14-25" name="__codelineno-14-25" href="#__codelineno-14-25"></a>
</span><span id="__span-14-26"><a id="__codelineno-14-26" name="__codelineno-14-26" href="#__codelineno-14-26"></a># Selector function for model choice
</span><span id="__span-14-27"><a id="__codelineno-14-27" name="__codelineno-14-27" href="#__codelineno-14-27"></a>def select_model(state: AgentState, runtime: Runtime[CustomContext]) -&gt; BaseChatModel:
</span><span id="__span-14-28"><a id="__codelineno-14-28" name="__codelineno-14-28" href="#__codelineno-14-28"></a>    if runtime.context.provider == &quot;anthropic&quot;:
</span><span id="__span-14-29"><a id="__codelineno-14-29" name="__codelineno-14-29" href="#__codelineno-14-29"></a>        model = anthropic_model
</span><span id="__span-14-30"><a id="__codelineno-14-30" name="__codelineno-14-30" href="#__codelineno-14-30"></a>    elif runtime.context.provider == &quot;openai&quot;:
</span><span id="__span-14-31"><a id="__codelineno-14-31" name="__codelineno-14-31" href="#__codelineno-14-31"></a>        model = openai_model
</span><span id="__span-14-32"><a id="__codelineno-14-32" name="__codelineno-14-32" href="#__codelineno-14-32"></a>    else:
</span><span id="__span-14-33"><a id="__codelineno-14-33" name="__codelineno-14-33" href="#__codelineno-14-33"></a>        raise ValueError(f&quot;Unsupported provider: {runtime.context.provider}&quot;)
</span><span id="__span-14-34"><a id="__codelineno-14-34" name="__codelineno-14-34" href="#__codelineno-14-34"></a>
</span><span id="__span-14-35"><a id="__codelineno-14-35" name="__codelineno-14-35" href="#__codelineno-14-35"></a>    # With dynamic model selection, you must bind tools explicitly
</span><span id="__span-14-36"><a id="__codelineno-14-36" name="__codelineno-14-36" href="#__codelineno-14-36"></a>    return model.bind_tools([weather])
</span><span id="__span-14-37"><a id="__codelineno-14-37" name="__codelineno-14-37" href="#__codelineno-14-37"></a>
</span><span id="__span-14-38"><a id="__codelineno-14-38" name="__codelineno-14-38" href="#__codelineno-14-38"></a>
</span><span id="__span-14-39"><a id="__codelineno-14-39" name="__codelineno-14-39" href="#__codelineno-14-39"></a># Create agent with dynamic model selection
</span><span id="__span-14-40"><a id="__codelineno-14-40" name="__codelineno-14-40" href="#__codelineno-14-40"></a>agent = create_react_agent(select_model, tools=[weather])
</span><span id="__span-14-41"><a id="__codelineno-14-41" name="__codelineno-14-41" href="#__codelineno-14-41"></a>
</span><span id="__span-14-42"><a id="__codelineno-14-42" name="__codelineno-14-42" href="#__codelineno-14-42"></a># Invoke with context to select model
</span><span id="__span-14-43"><a id="__codelineno-14-43" name="__codelineno-14-43" href="#__codelineno-14-43"></a>output = agent.invoke(
</span><span id="__span-14-44"><a id="__codelineno-14-44" name="__codelineno-14-44" href="#__codelineno-14-44"></a>    {
</span><span id="__span-14-45"><a id="__codelineno-14-45" name="__codelineno-14-45" href="#__codelineno-14-45"></a>        &quot;messages&quot;: [
</span><span id="__span-14-46"><a id="__codelineno-14-46" name="__codelineno-14-46" href="#__codelineno-14-46"></a>            {
</span><span id="__span-14-47"><a id="__codelineno-14-47" name="__codelineno-14-47" href="#__codelineno-14-47"></a>                &quot;role&quot;: &quot;user&quot;,
</span><span id="__span-14-48"><a id="__codelineno-14-48" name="__codelineno-14-48" href="#__codelineno-14-48"></a>                &quot;content&quot;: &quot;Which model is handling this?&quot;,
</span><span id="__span-14-49"><a id="__codelineno-14-49" name="__codelineno-14-49" href="#__codelineno-14-49"></a>            }
</span><span id="__span-14-50"><a id="__codelineno-14-50" name="__codelineno-14-50" href="#__codelineno-14-50"></a>        ]
</span><span id="__span-14-51"><a id="__codelineno-14-51" name="__codelineno-14-51" href="#__codelineno-14-51"></a>    },
</span><span id="__span-14-52"><a id="__codelineno-14-52" name="__codelineno-14-52" href="#__codelineno-14-52"></a>    context=CustomContext(provider=&quot;openai&quot;),
</span><span id="__span-14-53"><a id="__codelineno-14-53" name="__codelineno-14-53" href="#__codelineno-14-53"></a>)
</span><span id="__span-14-54"><a id="__codelineno-14-54" name="__codelineno-14-54" href="#__codelineno-14-54"></a>
</span><span id="__span-14-55"><a id="__codelineno-14-55" name="__codelineno-14-55" href="#__codelineno-14-55"></a>print(output[&quot;messages&quot;][-1].text())
</span></code></pre></div>
<h3 style="color:blue;">📌 Advanced model configuration</h3>

<p><strong>Disable streaming</strong></p>
<p>To disable streaming of the individual LLM tokens, set disable_streaming=True when initializing the model:</p>
<p><strong>init_chat_model</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a>from langchain.chat_models import init_chat_model
</span><span id="__span-15-2"><a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a>
</span><span id="__span-15-3"><a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a>model = init_chat_model(
</span><span id="__span-15-4"><a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a>    &quot;anthropic:claude-3-7-sonnet-latest&quot;,
</span><span id="__span-15-5"><a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a>    disable_streaming=True
</span><span id="__span-15-6"><a id="__codelineno-15-6" name="__codelineno-15-6" href="#__codelineno-15-6"></a>)
</span></code></pre></div>
<p><strong>ChatModel</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a>from langchain_anthropic import ChatAnthropic
</span><span id="__span-16-2"><a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a>
</span><span id="__span-16-3"><a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a>model = ChatAnthropic(
</span><span id="__span-16-4"><a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a>    model=&quot;claude-3-7-sonnet-latest&quot;,
</span><span id="__span-16-5"><a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a>    disable_streaming=True
</span><span id="__span-16-6"><a id="__codelineno-16-6" name="__codelineno-16-6" href="#__codelineno-16-6"></a>)
</span></code></pre></div>
<h3 style="color:blue;">📌 Add model fallbacks</h3>

<p>You can add a fallback to a different model or a different LLM provider using <code>model.with_fallbacks([...])</code>:</p>
<p><strong>init_chat_model</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a>from langchain.chat_models import init_chat_model
</span><span id="__span-17-2"><a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a>
</span><span id="__span-17-3"><a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a>model_with_fallbacks = (
</span><span id="__span-17-4"><a id="__codelineno-17-4" name="__codelineno-17-4" href="#__codelineno-17-4"></a>    init_chat_model(&quot;anthropic:claude-3-5-haiku-latest&quot;)
</span><span id="__span-17-5"><a id="__codelineno-17-5" name="__codelineno-17-5" href="#__codelineno-17-5"></a>    .with_fallbacks([
</span><span id="__span-17-6"><a id="__codelineno-17-6" name="__codelineno-17-6" href="#__codelineno-17-6"></a>        init_chat_model(&quot;openai:gpt-4.1-mini&quot;),
</span><span id="__span-17-7"><a id="__codelineno-17-7" name="__codelineno-17-7" href="#__codelineno-17-7"></a>    ])
</span><span id="__span-17-8"><a id="__codelineno-17-8" name="__codelineno-17-8" href="#__codelineno-17-8"></a>)
</span></code></pre></div>
<p><strong>ChatModel</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a>from langchain.chat_models import init_chat_model
</span><span id="__span-18-2"><a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a>
</span><span id="__span-18-3"><a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a>model_with_fallbacks = (
</span><span id="__span-18-4"><a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a>    init_chat_model(&quot;anthropic:claude-3-5-haiku-latest&quot;)
</span><span id="__span-18-5"><a id="__codelineno-18-5" name="__codelineno-18-5" href="#__codelineno-18-5"></a>    .with_fallbacks([
</span><span id="__span-18-6"><a id="__codelineno-18-6" name="__codelineno-18-6" href="#__codelineno-18-6"></a>        init_chat_model(&quot;openai:gpt-4.1-mini&quot;),
</span><span id="__span-18-7"><a id="__codelineno-18-7" name="__codelineno-18-7" href="#__codelineno-18-7"></a>    ])
</span><span id="__span-18-8"><a id="__codelineno-18-8" name="__codelineno-18-8" href="#__codelineno-18-8"></a>)
</span></code></pre></div>
<h3 style="color:blue;">📌 Use the built-in rate limiter</h3>

<p>Langchain includes a built-in in-memory rate limiter. This rate limiter is thread safe and can be shared by multiple threads in the same process.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a>from langchain_core.rate_limiters import InMemoryRateLimiter
</span><span id="__span-19-2"><a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a>from langchain_anthropic import ChatAnthropic
</span><span id="__span-19-3"><a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a>
</span><span id="__span-19-4"><a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a>rate_limiter = InMemoryRateLimiter(
</span><span id="__span-19-5"><a id="__codelineno-19-5" name="__codelineno-19-5" href="#__codelineno-19-5"></a>    requests_per_second=0.1,  # &lt;-- Super slow! We can only make a request once every 10 seconds!!
</span><span id="__span-19-6"><a id="__codelineno-19-6" name="__codelineno-19-6" href="#__codelineno-19-6"></a>    check_every_n_seconds=0.1,  # Wake up every 100 ms to check whether allowed to make a request,
</span><span id="__span-19-7"><a id="__codelineno-19-7" name="__codelineno-19-7" href="#__codelineno-19-7"></a>    max_bucket_size=10,  # Controls the maximum burst size.
</span><span id="__span-19-8"><a id="__codelineno-19-8" name="__codelineno-19-8" href="#__codelineno-19-8"></a>)
</span><span id="__span-19-9"><a id="__codelineno-19-9" name="__codelineno-19-9" href="#__codelineno-19-9"></a>
</span><span id="__span-19-10"><a id="__codelineno-19-10" name="__codelineno-19-10" href="#__codelineno-19-10"></a>model = ChatAnthropic(
</span><span id="__span-19-11"><a id="__codelineno-19-11" name="__codelineno-19-11" href="#__codelineno-19-11"></a>   model_name=&quot;claude-3-opus-20240229&quot;,
</span><span id="__span-19-12"><a id="__codelineno-19-12" name="__codelineno-19-12" href="#__codelineno-19-12"></a>   rate_limiter=rate_limiter
</span><span id="__span-19-13"><a id="__codelineno-19-13" name="__codelineno-19-13" href="#__codelineno-19-13"></a>)
</span></code></pre></div>
<h3 style="color:blue;">📌 Bring your own model</h3>

<p>If your desired LLM isn't officially supported by LangChain, consider these options:</p>
<ol>
<li>
<p><strong>Implement a custom LangChain chat model:</strong> Create a model conforming to the LangChain chat model interface. This enables full compatibility with LangGraph's agents and workflows but requires understanding of the LangChain framework.</p>
</li>
<li>
<p><strong>Direct invocation with custom streaming:</strong> Use your model directly by adding custom streaming logic with StreamWriter.</p>
</li>
</ol>
<h2 id="tools">Tools<a class="headerlink" href="#tools" title="Permanent link">#</a></h2>
<p>Many AI applications interact with users via natural language. However, some use cases require models to interface directly with external systems—such as APIs, databases, or file systems—using structured input. In these scenarios, <strong>tool calling</strong> enables models to generate requests that conform to a specified input schema.</p>
<p><strong>Tools</strong> encapsulate a callable function and its input schema. These can be passed to compatible chat models, allowing the model to decide whether to invoke a tool and with what arguments.</p>
<p><img alt="alt text" src="../image/langgraph1.png" /></p>
<p>Tool calling is typically <strong>conditional</strong>. Based on the user input and available tools, the model may choose to issue a tool call request. This request is returned in an AIMessage object, which includes a tool_calls field that specifies the tool name and input arguments:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a>llm_with_tools.invoke(&quot;What is 2 multiplied by 3?&quot;)
</span><span id="__span-20-2"><a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a># -&gt; AIMessage(tool_calls=[{&#39;name&#39;: &#39;multiply&#39;, &#39;args&#39;: {&#39;a&#39;: 2, &#39;b&#39;: 3}, ...}])
</span></code></pre></div>
<div class="language-text highlight"><pre><span></span><code><span id="__span-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a>AIMessage(
</span><span id="__span-21-2"><a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a>  tool_calls=[
</span><span id="__span-21-3"><a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a>    ToolCall(name=&quot;multiply&quot;, args={&quot;a&quot;: 2, &quot;b&quot;: 3}),
</span><span id="__span-21-4"><a id="__codelineno-21-4" name="__codelineno-21-4" href="#__codelineno-21-4"></a>    ...
</span><span id="__span-21-5"><a id="__codelineno-21-5" name="__codelineno-21-5" href="#__codelineno-21-5"></a>  ]
</span><span id="__span-21-6"><a id="__codelineno-21-6" name="__codelineno-21-6" href="#__codelineno-21-6"></a>)
</span></code></pre></div>
<p>If the input is unrelated to any tool, the model returns only a natural language message:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a>llm_with_tools.invoke(&quot;Hello world!&quot;)  # -&gt; AIMessage(content=&quot;Hello!&quot;)
</span></code></pre></div>
<p>Importantly, the model does not execute the tool—it only generates a request. A separate executor (such as a runtime or agent) is responsible for handling the tool call and returning the result.</p>
<h2 id="custom-tools">Custom tools<a class="headerlink" href="#custom-tools" title="Permanent link">#</a></h2>
<p>You can define custom tools using the @tool decorator or plain Python functions. For example:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-23-1"><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a>from langchain_core.tools import tool
</span><span id="__span-23-2"><a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a>
</span><span id="__span-23-3"><a id="__codelineno-23-3" name="__codelineno-23-3" href="#__codelineno-23-3"></a>@tool
</span><span id="__span-23-4"><a id="__codelineno-23-4" name="__codelineno-23-4" href="#__codelineno-23-4"></a>def multiply(a: int, b: int) -&gt; int:
</span><span id="__span-23-5"><a id="__codelineno-23-5" name="__codelineno-23-5" href="#__codelineno-23-5"></a>    &quot;&quot;&quot;Multiply two numbers.&quot;&quot;&quot;
</span><span id="__span-23-6"><a id="__codelineno-23-6" name="__codelineno-23-6" href="#__codelineno-23-6"></a>    return a * b
</span></code></pre></div>
<h2 id="call-tools">Call tools<a class="headerlink" href="#call-tools" title="Permanent link">#</a></h2>
<p><strong>Tools</strong> encapsulate a callable function and its input schema. These can be passed to compatible chat models, allowing the model to decide whether to invoke a tool and determine the appropriate arguments.</p>
<p>You can <strong>define your own tools</strong> or use <strong>prebuilt tools</strong></p>
<p><strong>Define a tool</strong></p>
<p>Define a basic tool with the <strong>@tool</strong> decorator:</p>
<p><strong>Run a tool</strong></p>
<p>Tools conform to the <strong>Runnable interface</strong>, which means you can run a tool using the invoke method:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-24-1"><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a>multiply.invoke({&quot;a&quot;: 6, &quot;b&quot;: 7})  # returns 42
</span></code></pre></div>
<p>If the tool is invoked with <code>type="tool_call"</code>, it will return a ToolMessage:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-25-1"><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a>tool_call = {
</span><span id="__span-25-2"><a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a>    &quot;type&quot;: &quot;tool_call&quot;,
</span><span id="__span-25-3"><a id="__codelineno-25-3" name="__codelineno-25-3" href="#__codelineno-25-3"></a>    &quot;id&quot;: &quot;1&quot;,
</span><span id="__span-25-4"><a id="__codelineno-25-4" name="__codelineno-25-4" href="#__codelineno-25-4"></a>    &quot;args&quot;: {&quot;a&quot;: 42, &quot;b&quot;: 7}
</span><span id="__span-25-5"><a id="__codelineno-25-5" name="__codelineno-25-5" href="#__codelineno-25-5"></a>}
</span><span id="__span-25-6"><a id="__codelineno-25-6" name="__codelineno-25-6" href="#__codelineno-25-6"></a>multiply.invoke(tool_call) # returns a ToolMessage object
</span></code></pre></div>
<p><strong>Output:</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-26-1"><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a>ToolMessage(content=&#39;294&#39;, name=&#39;multiply&#39;, tool_call_id=&#39;1&#39;)
</span></code></pre></div>
<h2 id="use-in-an-agent">Use in an agent<a class="headerlink" href="#use-in-an-agent" title="Permanent link">#</a></h2>
<p>To create a tool-calling agent, you can use the prebuilt <code>create_react_agent</code>:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-27-1"><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a>from langchain_core.tools import tool
</span><span id="__span-27-2"><a id="__codelineno-27-2" name="__codelineno-27-2" href="#__codelineno-27-2"></a>from langgraph.prebuilt import create_react_agent
</span><span id="__span-27-3"><a id="__codelineno-27-3" name="__codelineno-27-3" href="#__codelineno-27-3"></a>
</span><span id="__span-27-4"><a id="__codelineno-27-4" name="__codelineno-27-4" href="#__codelineno-27-4"></a>@tool
</span><span id="__span-27-5"><a id="__codelineno-27-5" name="__codelineno-27-5" href="#__codelineno-27-5"></a>def multiply(a: int, b: int) -&gt; int:
</span><span id="__span-27-6"><a id="__codelineno-27-6" name="__codelineno-27-6" href="#__codelineno-27-6"></a>    &quot;&quot;&quot;Multiply two numbers.&quot;&quot;&quot;
</span><span id="__span-27-7"><a id="__codelineno-27-7" name="__codelineno-27-7" href="#__codelineno-27-7"></a>    return a * b
</span><span id="__span-27-8"><a id="__codelineno-27-8" name="__codelineno-27-8" href="#__codelineno-27-8"></a>
</span><span id="__span-27-9"><a id="__codelineno-27-9" name="__codelineno-27-9" href="#__codelineno-27-9"></a>agent = create_react_agent(
</span><span id="__span-27-10"><a id="__codelineno-27-10" name="__codelineno-27-10" href="#__codelineno-27-10"></a>    model=&quot;anthropic:claude-3-7-sonnet&quot;,
</span><span id="__span-27-11"><a id="__codelineno-27-11" name="__codelineno-27-11" href="#__codelineno-27-11"></a>    tools=[multiply]
</span><span id="__span-27-12"><a id="__codelineno-27-12" name="__codelineno-27-12" href="#__codelineno-27-12"></a>)
</span><span id="__span-27-13"><a id="__codelineno-27-13" name="__codelineno-27-13" href="#__codelineno-27-13"></a>agent.invoke({&quot;messages&quot;: [{&quot;role&quot;: &quot;user&quot;, &quot;content&quot;: &quot;what&#39;s 42 x 7?&quot;}]})
</span></code></pre></div>
<h2 id="dynamically-select-tools">Dynamically select tools<a class="headerlink" href="#dynamically-select-tools" title="Permanent link">#</a></h2>
<p>Configure tool availability at runtime based on context:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-28-1"><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a>from dataclasses import dataclass
</span><span id="__span-28-2"><a id="__codelineno-28-2" name="__codelineno-28-2" href="#__codelineno-28-2"></a>from typing import Literal
</span><span id="__span-28-3"><a id="__codelineno-28-3" name="__codelineno-28-3" href="#__codelineno-28-3"></a>
</span><span id="__span-28-4"><a id="__codelineno-28-4" name="__codelineno-28-4" href="#__codelineno-28-4"></a>from langchain.chat_models import init_chat_model
</span><span id="__span-28-5"><a id="__codelineno-28-5" name="__codelineno-28-5" href="#__codelineno-28-5"></a>from langchain_core.tools import tool
</span><span id="__span-28-6"><a id="__codelineno-28-6" name="__codelineno-28-6" href="#__codelineno-28-6"></a>
</span><span id="__span-28-7"><a id="__codelineno-28-7" name="__codelineno-28-7" href="#__codelineno-28-7"></a>from langgraph.prebuilt import create_react_agent
</span><span id="__span-28-8"><a id="__codelineno-28-8" name="__codelineno-28-8" href="#__codelineno-28-8"></a>from langgraph.prebuilt.chat_agent_executor import AgentState
</span><span id="__span-28-9"><a id="__codelineno-28-9" name="__codelineno-28-9" href="#__codelineno-28-9"></a>from langgraph.runtime import Runtime
</span><span id="__span-28-10"><a id="__codelineno-28-10" name="__codelineno-28-10" href="#__codelineno-28-10"></a>
</span><span id="__span-28-11"><a id="__codelineno-28-11" name="__codelineno-28-11" href="#__codelineno-28-11"></a>
</span><span id="__span-28-12"><a id="__codelineno-28-12" name="__codelineno-28-12" href="#__codelineno-28-12"></a>@dataclass
</span><span id="__span-28-13"><a id="__codelineno-28-13" name="__codelineno-28-13" href="#__codelineno-28-13"></a>class CustomContext:
</span><span id="__span-28-14"><a id="__codelineno-28-14" name="__codelineno-28-14" href="#__codelineno-28-14"></a>    tools: list[Literal[&quot;weather&quot;, &quot;compass&quot;]]
</span><span id="__span-28-15"><a id="__codelineno-28-15" name="__codelineno-28-15" href="#__codelineno-28-15"></a>
</span><span id="__span-28-16"><a id="__codelineno-28-16" name="__codelineno-28-16" href="#__codelineno-28-16"></a>
</span><span id="__span-28-17"><a id="__codelineno-28-17" name="__codelineno-28-17" href="#__codelineno-28-17"></a>@tool
</span><span id="__span-28-18"><a id="__codelineno-28-18" name="__codelineno-28-18" href="#__codelineno-28-18"></a>def weather() -&gt; str:
</span><span id="__span-28-19"><a id="__codelineno-28-19" name="__codelineno-28-19" href="#__codelineno-28-19"></a>    &quot;&quot;&quot;Returns the current weather conditions.&quot;&quot;&quot;
</span><span id="__span-28-20"><a id="__codelineno-28-20" name="__codelineno-28-20" href="#__codelineno-28-20"></a>    return &quot;It&#39;s nice and sunny.&quot;
</span><span id="__span-28-21"><a id="__codelineno-28-21" name="__codelineno-28-21" href="#__codelineno-28-21"></a>
</span><span id="__span-28-22"><a id="__codelineno-28-22" name="__codelineno-28-22" href="#__codelineno-28-22"></a>
</span><span id="__span-28-23"><a id="__codelineno-28-23" name="__codelineno-28-23" href="#__codelineno-28-23"></a>@tool
</span><span id="__span-28-24"><a id="__codelineno-28-24" name="__codelineno-28-24" href="#__codelineno-28-24"></a>def compass() -&gt; str:
</span><span id="__span-28-25"><a id="__codelineno-28-25" name="__codelineno-28-25" href="#__codelineno-28-25"></a>    &quot;&quot;&quot;Returns the direction the user is facing.&quot;&quot;&quot;
</span><span id="__span-28-26"><a id="__codelineno-28-26" name="__codelineno-28-26" href="#__codelineno-28-26"></a>    return &quot;North&quot;
</span><span id="__span-28-27"><a id="__codelineno-28-27" name="__codelineno-28-27" href="#__codelineno-28-27"></a>
</span><span id="__span-28-28"><a id="__codelineno-28-28" name="__codelineno-28-28" href="#__codelineno-28-28"></a>model = init_chat_model(&quot;anthropic:claude-sonnet-4-20250514&quot;)
</span><span id="__span-28-29"><a id="__codelineno-28-29" name="__codelineno-28-29" href="#__codelineno-28-29"></a>
</span><span id="__span-28-30"><a id="__codelineno-28-30" name="__codelineno-28-30" href="#__codelineno-28-30"></a>def configure_model(state: AgentState, runtime: Runtime[CustomContext]):
</span><span id="__span-28-31"><a id="__codelineno-28-31" name="__codelineno-28-31" href="#__codelineno-28-31"></a>    &quot;&quot;&quot;Configure the model with tools based on runtime context.&quot;&quot;&quot;
</span><span id="__span-28-32"><a id="__codelineno-28-32" name="__codelineno-28-32" href="#__codelineno-28-32"></a>    selected_tools = [
</span><span id="__span-28-33"><a id="__codelineno-28-33" name="__codelineno-28-33" href="#__codelineno-28-33"></a>        tool
</span><span id="__span-28-34"><a id="__codelineno-28-34" name="__codelineno-28-34" href="#__codelineno-28-34"></a>        for tool in [weather, compass]
</span><span id="__span-28-35"><a id="__codelineno-28-35" name="__codelineno-28-35" href="#__codelineno-28-35"></a>        if tool.name in runtime.context.tools
</span><span id="__span-28-36"><a id="__codelineno-28-36" name="__codelineno-28-36" href="#__codelineno-28-36"></a>    ]
</span><span id="__span-28-37"><a id="__codelineno-28-37" name="__codelineno-28-37" href="#__codelineno-28-37"></a>    return model.bind_tools(selected_tools)
</span><span id="__span-28-38"><a id="__codelineno-28-38" name="__codelineno-28-38" href="#__codelineno-28-38"></a>
</span><span id="__span-28-39"><a id="__codelineno-28-39" name="__codelineno-28-39" href="#__codelineno-28-39"></a>
</span><span id="__span-28-40"><a id="__codelineno-28-40" name="__codelineno-28-40" href="#__codelineno-28-40"></a>agent = create_react_agent(
</span><span id="__span-28-41"><a id="__codelineno-28-41" name="__codelineno-28-41" href="#__codelineno-28-41"></a>    # Dynamically configure the model with tools based on runtime context
</span><span id="__span-28-42"><a id="__codelineno-28-42" name="__codelineno-28-42" href="#__codelineno-28-42"></a>    configure_model,
</span><span id="__span-28-43"><a id="__codelineno-28-43" name="__codelineno-28-43" href="#__codelineno-28-43"></a>    # Initialize with all tools available
</span><span id="__span-28-44"><a id="__codelineno-28-44" name="__codelineno-28-44" href="#__codelineno-28-44"></a>    tools=[weather, compass]
</span><span id="__span-28-45"><a id="__codelineno-28-45" name="__codelineno-28-45" href="#__codelineno-28-45"></a>)
</span><span id="__span-28-46"><a id="__codelineno-28-46" name="__codelineno-28-46" href="#__codelineno-28-46"></a>
</span><span id="__span-28-47"><a id="__codelineno-28-47" name="__codelineno-28-47" href="#__codelineno-28-47"></a>output = agent.invoke(
</span><span id="__span-28-48"><a id="__codelineno-28-48" name="__codelineno-28-48" href="#__codelineno-28-48"></a>    {
</span><span id="__span-28-49"><a id="__codelineno-28-49" name="__codelineno-28-49" href="#__codelineno-28-49"></a>        &quot;messages&quot;: [
</span><span id="__span-28-50"><a id="__codelineno-28-50" name="__codelineno-28-50" href="#__codelineno-28-50"></a>            {
</span><span id="__span-28-51"><a id="__codelineno-28-51" name="__codelineno-28-51" href="#__codelineno-28-51"></a>                &quot;role&quot;: &quot;user&quot;,
</span><span id="__span-28-52"><a id="__codelineno-28-52" name="__codelineno-28-52" href="#__codelineno-28-52"></a>                &quot;content&quot;: &quot;Who are you and what tools do you have access to?&quot;,
</span><span id="__span-28-53"><a id="__codelineno-28-53" name="__codelineno-28-53" href="#__codelineno-28-53"></a>            }
</span><span id="__span-28-54"><a id="__codelineno-28-54" name="__codelineno-28-54" href="#__codelineno-28-54"></a>        ]
</span><span id="__span-28-55"><a id="__codelineno-28-55" name="__codelineno-28-55" href="#__codelineno-28-55"></a>    },
</span><span id="__span-28-56"><a id="__codelineno-28-56" name="__codelineno-28-56" href="#__codelineno-28-56"></a>    context=CustomContext(tools=[&quot;weather&quot;]),  # Only enable the weather tool
</span><span id="__span-28-57"><a id="__codelineno-28-57" name="__codelineno-28-57" href="#__codelineno-28-57"></a>)
</span><span id="__span-28-58"><a id="__codelineno-28-58" name="__codelineno-28-58" href="#__codelineno-28-58"></a>
</span><span id="__span-28-59"><a id="__codelineno-28-59" name="__codelineno-28-59" href="#__codelineno-28-59"></a>print(output[&quot;messages&quot;][-1].text())
</span></code></pre></div>
<h2 id="use-in-a-workflow">Use in a workflow<a class="headerlink" href="#use-in-a-workflow" title="Permanent link">#</a></h2>
<p>If you are writing a custom workflow, you will need to:</p>
<ol>
<li>
<p>register the tools with the chat model</p>
</li>
<li>
<p>call the tool if the model decides to use it</p>
</li>
</ol>
<p>Use <code>model.bind_tools()</code> to register the tools with the model.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-29-1"><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a>from langchain.chat_models import init_chat_model
</span><span id="__span-29-2"><a id="__codelineno-29-2" name="__codelineno-29-2" href="#__codelineno-29-2"></a>
</span><span id="__span-29-3"><a id="__codelineno-29-3" name="__codelineno-29-3" href="#__codelineno-29-3"></a>model = init_chat_model(model=&quot;claude-3-5-haiku-latest&quot;)
</span><span id="__span-29-4"><a id="__codelineno-29-4" name="__codelineno-29-4" href="#__codelineno-29-4"></a>
</span><span id="__span-29-5"><a id="__codelineno-29-5" name="__codelineno-29-5" href="#__codelineno-29-5"></a>model_with_tools = model.bind_tools([multiply])
</span></code></pre></div>
<p><strong>ToolNode</strong></p>
<p>To execute tools in custom workflows, use the prebuilt ToolNode or implement your own custom node.</p>
<p>ToolNode is a specialized node for executing tools in a workflow. It provides the following features:</p>
<ul>
<li>
<p>Supports both synchronous and asynchronous tools.</p>
</li>
<li>
<p>Executes multiple tools concurrently.</p>
</li>
<li>
<p>Handles errors during tool execution (handle_tool_errors=True, enabled by default).</p>
</li>
</ul>
<p>ToolNode operates on <code>MessagesState</code>:</p>
<ul>
<li>
<p><strong>Input:</strong> MessagesState, where the last message is an AIMessage containing the tool_calls parameter.</p>
</li>
<li>
<p><strong>Output:</strong> MessagesState updated with the resulting ToolMessage from executed tools.</p>
</li>
</ul>
<div class="language-text highlight"><pre><span></span><code><span id="__span-30-1"><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a>from langgraph.prebuilt import ToolNode
</span><span id="__span-30-2"><a id="__codelineno-30-2" name="__codelineno-30-2" href="#__codelineno-30-2"></a>
</span><span id="__span-30-3"><a id="__codelineno-30-3" name="__codelineno-30-3" href="#__codelineno-30-3"></a>def get_weather(location: str):
</span><span id="__span-30-4"><a id="__codelineno-30-4" name="__codelineno-30-4" href="#__codelineno-30-4"></a>    &quot;&quot;&quot;Call to get the current weather.&quot;&quot;&quot;
</span><span id="__span-30-5"><a id="__codelineno-30-5" name="__codelineno-30-5" href="#__codelineno-30-5"></a>    if location.lower() in [&quot;sf&quot;, &quot;san francisco&quot;]:
</span><span id="__span-30-6"><a id="__codelineno-30-6" name="__codelineno-30-6" href="#__codelineno-30-6"></a>        return &quot;It&#39;s 60 degrees and foggy.&quot;
</span><span id="__span-30-7"><a id="__codelineno-30-7" name="__codelineno-30-7" href="#__codelineno-30-7"></a>    else:
</span><span id="__span-30-8"><a id="__codelineno-30-8" name="__codelineno-30-8" href="#__codelineno-30-8"></a>        return &quot;It&#39;s 90 degrees and sunny.&quot;
</span><span id="__span-30-9"><a id="__codelineno-30-9" name="__codelineno-30-9" href="#__codelineno-30-9"></a>
</span><span id="__span-30-10"><a id="__codelineno-30-10" name="__codelineno-30-10" href="#__codelineno-30-10"></a>def get_coolest_cities():
</span><span id="__span-30-11"><a id="__codelineno-30-11" name="__codelineno-30-11" href="#__codelineno-30-11"></a>    &quot;&quot;&quot;Get a list of coolest cities&quot;&quot;&quot;
</span><span id="__span-30-12"><a id="__codelineno-30-12" name="__codelineno-30-12" href="#__codelineno-30-12"></a>    return &quot;nyc, sf&quot;
</span><span id="__span-30-13"><a id="__codelineno-30-13" name="__codelineno-30-13" href="#__codelineno-30-13"></a>
</span><span id="__span-30-14"><a id="__codelineno-30-14" name="__codelineno-30-14" href="#__codelineno-30-14"></a>tool_node = ToolNode([get_weather, get_coolest_cities])
</span><span id="__span-30-15"><a id="__codelineno-30-15" name="__codelineno-30-15" href="#__codelineno-30-15"></a>tool_node.invoke({&quot;messages&quot;: [...]})
</span></code></pre></div>
<p><strong>Single tool call</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-31-1"><a id="__codelineno-31-1" name="__codelineno-31-1" href="#__codelineno-31-1"></a>from langchain_core.messages import AIMessage
</span><span id="__span-31-2"><a id="__codelineno-31-2" name="__codelineno-31-2" href="#__codelineno-31-2"></a>from langgraph.prebuilt import ToolNode
</span><span id="__span-31-3"><a id="__codelineno-31-3" name="__codelineno-31-3" href="#__codelineno-31-3"></a>
</span><span id="__span-31-4"><a id="__codelineno-31-4" name="__codelineno-31-4" href="#__codelineno-31-4"></a># Define tools
</span><span id="__span-31-5"><a id="__codelineno-31-5" name="__codelineno-31-5" href="#__codelineno-31-5"></a>@tool
</span><span id="__span-31-6"><a id="__codelineno-31-6" name="__codelineno-31-6" href="#__codelineno-31-6"></a>def get_weather(location: str):
</span><span id="__span-31-7"><a id="__codelineno-31-7" name="__codelineno-31-7" href="#__codelineno-31-7"></a>    &quot;&quot;&quot;Call to get the current weather.&quot;&quot;&quot;
</span><span id="__span-31-8"><a id="__codelineno-31-8" name="__codelineno-31-8" href="#__codelineno-31-8"></a>    if location.lower() in [&quot;sf&quot;, &quot;san francisco&quot;]:
</span><span id="__span-31-9"><a id="__codelineno-31-9" name="__codelineno-31-9" href="#__codelineno-31-9"></a>        return &quot;It&#39;s 60 degrees and foggy.&quot;
</span><span id="__span-31-10"><a id="__codelineno-31-10" name="__codelineno-31-10" href="#__codelineno-31-10"></a>    else:
</span><span id="__span-31-11"><a id="__codelineno-31-11" name="__codelineno-31-11" href="#__codelineno-31-11"></a>        return &quot;It&#39;s 90 degrees and sunny.&quot;
</span><span id="__span-31-12"><a id="__codelineno-31-12" name="__codelineno-31-12" href="#__codelineno-31-12"></a>
</span><span id="__span-31-13"><a id="__codelineno-31-13" name="__codelineno-31-13" href="#__codelineno-31-13"></a>tool_node = ToolNode([get_weather])
</span><span id="__span-31-14"><a id="__codelineno-31-14" name="__codelineno-31-14" href="#__codelineno-31-14"></a>
</span><span id="__span-31-15"><a id="__codelineno-31-15" name="__codelineno-31-15" href="#__codelineno-31-15"></a>message_with_single_tool_call = AIMessage(
</span><span id="__span-31-16"><a id="__codelineno-31-16" name="__codelineno-31-16" href="#__codelineno-31-16"></a>    content=&quot;&quot;,
</span><span id="__span-31-17"><a id="__codelineno-31-17" name="__codelineno-31-17" href="#__codelineno-31-17"></a>    tool_calls=[
</span><span id="__span-31-18"><a id="__codelineno-31-18" name="__codelineno-31-18" href="#__codelineno-31-18"></a>        {
</span><span id="__span-31-19"><a id="__codelineno-31-19" name="__codelineno-31-19" href="#__codelineno-31-19"></a>            &quot;name&quot;: &quot;get_weather&quot;,
</span><span id="__span-31-20"><a id="__codelineno-31-20" name="__codelineno-31-20" href="#__codelineno-31-20"></a>            &quot;args&quot;: {&quot;location&quot;: &quot;sf&quot;},
</span><span id="__span-31-21"><a id="__codelineno-31-21" name="__codelineno-31-21" href="#__codelineno-31-21"></a>            &quot;id&quot;: &quot;tool_call_id&quot;,
</span><span id="__span-31-22"><a id="__codelineno-31-22" name="__codelineno-31-22" href="#__codelineno-31-22"></a>            &quot;type&quot;: &quot;tool_call&quot;,
</span><span id="__span-31-23"><a id="__codelineno-31-23" name="__codelineno-31-23" href="#__codelineno-31-23"></a>        }
</span><span id="__span-31-24"><a id="__codelineno-31-24" name="__codelineno-31-24" href="#__codelineno-31-24"></a>    ],
</span><span id="__span-31-25"><a id="__codelineno-31-25" name="__codelineno-31-25" href="#__codelineno-31-25"></a>)
</span><span id="__span-31-26"><a id="__codelineno-31-26" name="__codelineno-31-26" href="#__codelineno-31-26"></a>
</span><span id="__span-31-27"><a id="__codelineno-31-27" name="__codelineno-31-27" href="#__codelineno-31-27"></a>tool_node.invoke({&quot;messages&quot;: [message_with_single_tool_call]})
</span></code></pre></div>
<p><strong>Multiple tool calls</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-32-1"><a id="__codelineno-32-1" name="__codelineno-32-1" href="#__codelineno-32-1"></a>from langchain_core.messages import AIMessage
</span><span id="__span-32-2"><a id="__codelineno-32-2" name="__codelineno-32-2" href="#__codelineno-32-2"></a>from langgraph.prebuilt import ToolNode
</span><span id="__span-32-3"><a id="__codelineno-32-3" name="__codelineno-32-3" href="#__codelineno-32-3"></a>
</span><span id="__span-32-4"><a id="__codelineno-32-4" name="__codelineno-32-4" href="#__codelineno-32-4"></a># Define tools
</span><span id="__span-32-5"><a id="__codelineno-32-5" name="__codelineno-32-5" href="#__codelineno-32-5"></a>
</span><span id="__span-32-6"><a id="__codelineno-32-6" name="__codelineno-32-6" href="#__codelineno-32-6"></a>def get_weather(location: str):
</span><span id="__span-32-7"><a id="__codelineno-32-7" name="__codelineno-32-7" href="#__codelineno-32-7"></a>    &quot;&quot;&quot;Call to get the current weather.&quot;&quot;&quot;
</span><span id="__span-32-8"><a id="__codelineno-32-8" name="__codelineno-32-8" href="#__codelineno-32-8"></a>    if location.lower() in [&quot;sf&quot;, &quot;san francisco&quot;]:
</span><span id="__span-32-9"><a id="__codelineno-32-9" name="__codelineno-32-9" href="#__codelineno-32-9"></a>        return &quot;It&#39;s 60 degrees and foggy.&quot;
</span><span id="__span-32-10"><a id="__codelineno-32-10" name="__codelineno-32-10" href="#__codelineno-32-10"></a>    else:
</span><span id="__span-32-11"><a id="__codelineno-32-11" name="__codelineno-32-11" href="#__codelineno-32-11"></a>        return &quot;It&#39;s 90 degrees and sunny.&quot;
</span><span id="__span-32-12"><a id="__codelineno-32-12" name="__codelineno-32-12" href="#__codelineno-32-12"></a>
</span><span id="__span-32-13"><a id="__codelineno-32-13" name="__codelineno-32-13" href="#__codelineno-32-13"></a>def get_coolest_cities():
</span><span id="__span-32-14"><a id="__codelineno-32-14" name="__codelineno-32-14" href="#__codelineno-32-14"></a>    &quot;&quot;&quot;Get a list of coolest cities&quot;&quot;&quot;
</span><span id="__span-32-15"><a id="__codelineno-32-15" name="__codelineno-32-15" href="#__codelineno-32-15"></a>    return &quot;nyc, sf&quot;
</span><span id="__span-32-16"><a id="__codelineno-32-16" name="__codelineno-32-16" href="#__codelineno-32-16"></a>
</span><span id="__span-32-17"><a id="__codelineno-32-17" name="__codelineno-32-17" href="#__codelineno-32-17"></a>tool_node = ToolNode([get_weather, get_coolest_cities])
</span><span id="__span-32-18"><a id="__codelineno-32-18" name="__codelineno-32-18" href="#__codelineno-32-18"></a>
</span><span id="__span-32-19"><a id="__codelineno-32-19" name="__codelineno-32-19" href="#__codelineno-32-19"></a>message_with_multiple_tool_calls = AIMessage(
</span><span id="__span-32-20"><a id="__codelineno-32-20" name="__codelineno-32-20" href="#__codelineno-32-20"></a>    content=&quot;&quot;,
</span><span id="__span-32-21"><a id="__codelineno-32-21" name="__codelineno-32-21" href="#__codelineno-32-21"></a>    tool_calls=[
</span><span id="__span-32-22"><a id="__codelineno-32-22" name="__codelineno-32-22" href="#__codelineno-32-22"></a>        {
</span><span id="__span-32-23"><a id="__codelineno-32-23" name="__codelineno-32-23" href="#__codelineno-32-23"></a>            &quot;name&quot;: &quot;get_coolest_cities&quot;,
</span><span id="__span-32-24"><a id="__codelineno-32-24" name="__codelineno-32-24" href="#__codelineno-32-24"></a>            &quot;args&quot;: {},
</span><span id="__span-32-25"><a id="__codelineno-32-25" name="__codelineno-32-25" href="#__codelineno-32-25"></a>            &quot;id&quot;: &quot;tool_call_id_1&quot;,
</span><span id="__span-32-26"><a id="__codelineno-32-26" name="__codelineno-32-26" href="#__codelineno-32-26"></a>            &quot;type&quot;: &quot;tool_call&quot;,
</span><span id="__span-32-27"><a id="__codelineno-32-27" name="__codelineno-32-27" href="#__codelineno-32-27"></a>        },
</span><span id="__span-32-28"><a id="__codelineno-32-28" name="__codelineno-32-28" href="#__codelineno-32-28"></a>        {
</span><span id="__span-32-29"><a id="__codelineno-32-29" name="__codelineno-32-29" href="#__codelineno-32-29"></a>            &quot;name&quot;: &quot;get_weather&quot;,
</span><span id="__span-32-30"><a id="__codelineno-32-30" name="__codelineno-32-30" href="#__codelineno-32-30"></a>            &quot;args&quot;: {&quot;location&quot;: &quot;sf&quot;},
</span><span id="__span-32-31"><a id="__codelineno-32-31" name="__codelineno-32-31" href="#__codelineno-32-31"></a>            &quot;id&quot;: &quot;tool_call_id_2&quot;,
</span><span id="__span-32-32"><a id="__codelineno-32-32" name="__codelineno-32-32" href="#__codelineno-32-32"></a>            &quot;type&quot;: &quot;tool_call&quot;,
</span><span id="__span-32-33"><a id="__codelineno-32-33" name="__codelineno-32-33" href="#__codelineno-32-33"></a>        },
</span><span id="__span-32-34"><a id="__codelineno-32-34" name="__codelineno-32-34" href="#__codelineno-32-34"></a>    ],
</span><span id="__span-32-35"><a id="__codelineno-32-35" name="__codelineno-32-35" href="#__codelineno-32-35"></a>)
</span><span id="__span-32-36"><a id="__codelineno-32-36" name="__codelineno-32-36" href="#__codelineno-32-36"></a>
</span><span id="__span-32-37"><a id="__codelineno-32-37" name="__codelineno-32-37" href="#__codelineno-32-37"></a>tool_node.invoke({&quot;messages&quot;: [message_with_multiple_tool_calls]})
</span></code></pre></div>
<p><strong>Use with a chat model</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-33-1"><a id="__codelineno-33-1" name="__codelineno-33-1" href="#__codelineno-33-1"></a>from langchain.chat_models import init_chat_model
</span><span id="__span-33-2"><a id="__codelineno-33-2" name="__codelineno-33-2" href="#__codelineno-33-2"></a>from langgraph.prebuilt import ToolNode
</span><span id="__span-33-3"><a id="__codelineno-33-3" name="__codelineno-33-3" href="#__codelineno-33-3"></a>
</span><span id="__span-33-4"><a id="__codelineno-33-4" name="__codelineno-33-4" href="#__codelineno-33-4"></a>def get_weather(location: str):
</span><span id="__span-33-5"><a id="__codelineno-33-5" name="__codelineno-33-5" href="#__codelineno-33-5"></a>    &quot;&quot;&quot;Call to get the current weather.&quot;&quot;&quot;
</span><span id="__span-33-6"><a id="__codelineno-33-6" name="__codelineno-33-6" href="#__codelineno-33-6"></a>    if location.lower() in [&quot;sf&quot;, &quot;san francisco&quot;]:
</span><span id="__span-33-7"><a id="__codelineno-33-7" name="__codelineno-33-7" href="#__codelineno-33-7"></a>        return &quot;It&#39;s 60 degrees and foggy.&quot;
</span><span id="__span-33-8"><a id="__codelineno-33-8" name="__codelineno-33-8" href="#__codelineno-33-8"></a>    else:
</span><span id="__span-33-9"><a id="__codelineno-33-9" name="__codelineno-33-9" href="#__codelineno-33-9"></a>        return &quot;It&#39;s 90 degrees and sunny.&quot;
</span><span id="__span-33-10"><a id="__codelineno-33-10" name="__codelineno-33-10" href="#__codelineno-33-10"></a>
</span><span id="__span-33-11"><a id="__codelineno-33-11" name="__codelineno-33-11" href="#__codelineno-33-11"></a>tool_node = ToolNode([get_weather])
</span><span id="__span-33-12"><a id="__codelineno-33-12" name="__codelineno-33-12" href="#__codelineno-33-12"></a>
</span><span id="__span-33-13"><a id="__codelineno-33-13" name="__codelineno-33-13" href="#__codelineno-33-13"></a>model = init_chat_model(model=&quot;claude-3-5-haiku-latest&quot;)
</span><span id="__span-33-14"><a id="__codelineno-33-14" name="__codelineno-33-14" href="#__codelineno-33-14"></a>model_with_tools = model.bind_tools([get_weather])  
</span><span id="__span-33-15"><a id="__codelineno-33-15" name="__codelineno-33-15" href="#__codelineno-33-15"></a>
</span><span id="__span-33-16"><a id="__codelineno-33-16" name="__codelineno-33-16" href="#__codelineno-33-16"></a>
</span><span id="__span-33-17"><a id="__codelineno-33-17" name="__codelineno-33-17" href="#__codelineno-33-17"></a>response_message = model_with_tools.invoke(&quot;what&#39;s the weather in sf?&quot;)
</span><span id="__span-33-18"><a id="__codelineno-33-18" name="__codelineno-33-18" href="#__codelineno-33-18"></a>tool_node.invoke({&quot;messages&quot;: [response_message]})
</span></code></pre></div>
<p><strong>Use in a tool-calling agent</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-34-1"><a id="__codelineno-34-1" name="__codelineno-34-1" href="#__codelineno-34-1"></a>from langchain.chat_models import init_chat_model
</span><span id="__span-34-2"><a id="__codelineno-34-2" name="__codelineno-34-2" href="#__codelineno-34-2"></a>from langgraph.prebuilt import ToolNode
</span><span id="__span-34-3"><a id="__codelineno-34-3" name="__codelineno-34-3" href="#__codelineno-34-3"></a>from langgraph.graph import StateGraph, MessagesState, START, END
</span><span id="__span-34-4"><a id="__codelineno-34-4" name="__codelineno-34-4" href="#__codelineno-34-4"></a>
</span><span id="__span-34-5"><a id="__codelineno-34-5" name="__codelineno-34-5" href="#__codelineno-34-5"></a>def get_weather(location: str):
</span><span id="__span-34-6"><a id="__codelineno-34-6" name="__codelineno-34-6" href="#__codelineno-34-6"></a>    &quot;&quot;&quot;Call to get the current weather.&quot;&quot;&quot;
</span><span id="__span-34-7"><a id="__codelineno-34-7" name="__codelineno-34-7" href="#__codelineno-34-7"></a>    if location.lower() in [&quot;sf&quot;, &quot;san francisco&quot;]:
</span><span id="__span-34-8"><a id="__codelineno-34-8" name="__codelineno-34-8" href="#__codelineno-34-8"></a>        return &quot;It&#39;s 60 degrees and foggy.&quot;
</span><span id="__span-34-9"><a id="__codelineno-34-9" name="__codelineno-34-9" href="#__codelineno-34-9"></a>    else:
</span><span id="__span-34-10"><a id="__codelineno-34-10" name="__codelineno-34-10" href="#__codelineno-34-10"></a>        return &quot;It&#39;s 90 degrees and sunny.&quot;
</span><span id="__span-34-11"><a id="__codelineno-34-11" name="__codelineno-34-11" href="#__codelineno-34-11"></a>
</span><span id="__span-34-12"><a id="__codelineno-34-12" name="__codelineno-34-12" href="#__codelineno-34-12"></a>tool_node = ToolNode([get_weather])
</span><span id="__span-34-13"><a id="__codelineno-34-13" name="__codelineno-34-13" href="#__codelineno-34-13"></a>
</span><span id="__span-34-14"><a id="__codelineno-34-14" name="__codelineno-34-14" href="#__codelineno-34-14"></a>model = init_chat_model(model=&quot;claude-3-5-haiku-latest&quot;)
</span><span id="__span-34-15"><a id="__codelineno-34-15" name="__codelineno-34-15" href="#__codelineno-34-15"></a>model_with_tools = model.bind_tools([get_weather])
</span><span id="__span-34-16"><a id="__codelineno-34-16" name="__codelineno-34-16" href="#__codelineno-34-16"></a>
</span><span id="__span-34-17"><a id="__codelineno-34-17" name="__codelineno-34-17" href="#__codelineno-34-17"></a>def should_continue(state: MessagesState):
</span><span id="__span-34-18"><a id="__codelineno-34-18" name="__codelineno-34-18" href="#__codelineno-34-18"></a>    messages = state[&quot;messages&quot;]
</span><span id="__span-34-19"><a id="__codelineno-34-19" name="__codelineno-34-19" href="#__codelineno-34-19"></a>    last_message = messages[-1]
</span><span id="__span-34-20"><a id="__codelineno-34-20" name="__codelineno-34-20" href="#__codelineno-34-20"></a>    if last_message.tool_calls:
</span><span id="__span-34-21"><a id="__codelineno-34-21" name="__codelineno-34-21" href="#__codelineno-34-21"></a>        return &quot;tools&quot;
</span><span id="__span-34-22"><a id="__codelineno-34-22" name="__codelineno-34-22" href="#__codelineno-34-22"></a>    return END
</span><span id="__span-34-23"><a id="__codelineno-34-23" name="__codelineno-34-23" href="#__codelineno-34-23"></a>
</span><span id="__span-34-24"><a id="__codelineno-34-24" name="__codelineno-34-24" href="#__codelineno-34-24"></a>def call_model(state: MessagesState):
</span><span id="__span-34-25"><a id="__codelineno-34-25" name="__codelineno-34-25" href="#__codelineno-34-25"></a>    messages = state[&quot;messages&quot;]
</span><span id="__span-34-26"><a id="__codelineno-34-26" name="__codelineno-34-26" href="#__codelineno-34-26"></a>    response = model_with_tools.invoke(messages)
</span><span id="__span-34-27"><a id="__codelineno-34-27" name="__codelineno-34-27" href="#__codelineno-34-27"></a>    return {&quot;messages&quot;: [response]}
</span><span id="__span-34-28"><a id="__codelineno-34-28" name="__codelineno-34-28" href="#__codelineno-34-28"></a>
</span><span id="__span-34-29"><a id="__codelineno-34-29" name="__codelineno-34-29" href="#__codelineno-34-29"></a>builder = StateGraph(MessagesState)
</span><span id="__span-34-30"><a id="__codelineno-34-30" name="__codelineno-34-30" href="#__codelineno-34-30"></a>
</span><span id="__span-34-31"><a id="__codelineno-34-31" name="__codelineno-34-31" href="#__codelineno-34-31"></a># Define the two nodes we will cycle between
</span><span id="__span-34-32"><a id="__codelineno-34-32" name="__codelineno-34-32" href="#__codelineno-34-32"></a>builder.add_node(&quot;call_model&quot;, call_model)
</span><span id="__span-34-33"><a id="__codelineno-34-33" name="__codelineno-34-33" href="#__codelineno-34-33"></a>builder.add_node(&quot;tools&quot;, tool_node)
</span><span id="__span-34-34"><a id="__codelineno-34-34" name="__codelineno-34-34" href="#__codelineno-34-34"></a>
</span><span id="__span-34-35"><a id="__codelineno-34-35" name="__codelineno-34-35" href="#__codelineno-34-35"></a>builder.add_edge(START, &quot;call_model&quot;)
</span><span id="__span-34-36"><a id="__codelineno-34-36" name="__codelineno-34-36" href="#__codelineno-34-36"></a>builder.add_conditional_edges(&quot;call_model&quot;, should_continue, [&quot;tools&quot;, END])
</span><span id="__span-34-37"><a id="__codelineno-34-37" name="__codelineno-34-37" href="#__codelineno-34-37"></a>builder.add_edge(&quot;tools&quot;, &quot;call_model&quot;)
</span><span id="__span-34-38"><a id="__codelineno-34-38" name="__codelineno-34-38" href="#__codelineno-34-38"></a>
</span><span id="__span-34-39"><a id="__codelineno-34-39" name="__codelineno-34-39" href="#__codelineno-34-39"></a>graph = builder.compile()
</span><span id="__span-34-40"><a id="__codelineno-34-40" name="__codelineno-34-40" href="#__codelineno-34-40"></a>
</span><span id="__span-34-41"><a id="__codelineno-34-41" name="__codelineno-34-41" href="#__codelineno-34-41"></a>graph.invoke({&quot;messages&quot;: [{&quot;role&quot;: &quot;user&quot;, &quot;content&quot;: &quot;what&#39;s the weather in sf?&quot;}]})
</span></code></pre></div>
<h2 id="tool-customization">Tool customization<a class="headerlink" href="#tool-customization" title="Permanent link">#</a></h2>
<p>For more control over tool behavior, use the @tool decorator.</p>
<p><strong>Parameter descriptions</strong></p>
<p>Auto-generate descriptions from docstrings:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-35-1"><a id="__codelineno-35-1" name="__codelineno-35-1" href="#__codelineno-35-1"></a>from langchain_core.tools import tool
</span><span id="__span-35-2"><a id="__codelineno-35-2" name="__codelineno-35-2" href="#__codelineno-35-2"></a>
</span><span id="__span-35-3"><a id="__codelineno-35-3" name="__codelineno-35-3" href="#__codelineno-35-3"></a>@tool(&quot;multiply_tool&quot;, parse_docstring=True)
</span><span id="__span-35-4"><a id="__codelineno-35-4" name="__codelineno-35-4" href="#__codelineno-35-4"></a>def multiply(a: int, b: int) -&gt; int:
</span><span id="__span-35-5"><a id="__codelineno-35-5" name="__codelineno-35-5" href="#__codelineno-35-5"></a>    &quot;&quot;&quot;Multiply two numbers.
</span><span id="__span-35-6"><a id="__codelineno-35-6" name="__codelineno-35-6" href="#__codelineno-35-6"></a>
</span><span id="__span-35-7"><a id="__codelineno-35-7" name="__codelineno-35-7" href="#__codelineno-35-7"></a>    Args:
</span><span id="__span-35-8"><a id="__codelineno-35-8" name="__codelineno-35-8" href="#__codelineno-35-8"></a>        a: First operand
</span><span id="__span-35-9"><a id="__codelineno-35-9" name="__codelineno-35-9" href="#__codelineno-35-9"></a>        b: Second operand
</span><span id="__span-35-10"><a id="__codelineno-35-10" name="__codelineno-35-10" href="#__codelineno-35-10"></a>    &quot;&quot;&quot;
</span><span id="__span-35-11"><a id="__codelineno-35-11" name="__codelineno-35-11" href="#__codelineno-35-11"></a>    return a * b
</span></code></pre></div>
<p><strong>Explicit input schema</strong></p>
<p>Define schemas using args_schema:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-36-1"><a id="__codelineno-36-1" name="__codelineno-36-1" href="#__codelineno-36-1"></a>from pydantic import BaseModel, Field
</span><span id="__span-36-2"><a id="__codelineno-36-2" name="__codelineno-36-2" href="#__codelineno-36-2"></a>from langchain_core.tools import tool
</span><span id="__span-36-3"><a id="__codelineno-36-3" name="__codelineno-36-3" href="#__codelineno-36-3"></a>
</span><span id="__span-36-4"><a id="__codelineno-36-4" name="__codelineno-36-4" href="#__codelineno-36-4"></a>class MultiplyInputSchema(BaseModel):
</span><span id="__span-36-5"><a id="__codelineno-36-5" name="__codelineno-36-5" href="#__codelineno-36-5"></a>    &quot;&quot;&quot;Multiply two numbers&quot;&quot;&quot;
</span><span id="__span-36-6"><a id="__codelineno-36-6" name="__codelineno-36-6" href="#__codelineno-36-6"></a>    a: int = Field(description=&quot;First operand&quot;)
</span><span id="__span-36-7"><a id="__codelineno-36-7" name="__codelineno-36-7" href="#__codelineno-36-7"></a>    b: int = Field(description=&quot;Second operand&quot;)
</span><span id="__span-36-8"><a id="__codelineno-36-8" name="__codelineno-36-8" href="#__codelineno-36-8"></a>
</span><span id="__span-36-9"><a id="__codelineno-36-9" name="__codelineno-36-9" href="#__codelineno-36-9"></a>@tool(&quot;multiply_tool&quot;, args_schema=MultiplyInputSchema)
</span><span id="__span-36-10"><a id="__codelineno-36-10" name="__codelineno-36-10" href="#__codelineno-36-10"></a>def multiply(a: int, b: int) -&gt; int:
</span><span id="__span-36-11"><a id="__codelineno-36-11" name="__codelineno-36-11" href="#__codelineno-36-11"></a>    return a * b
</span></code></pre></div>
<p><strong>Tool name</strong></p>
<p>Override the default tool name using the first argument or name property:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-37-1"><a id="__codelineno-37-1" name="__codelineno-37-1" href="#__codelineno-37-1"></a>from langchain_core.tools import tool
</span><span id="__span-37-2"><a id="__codelineno-37-2" name="__codelineno-37-2" href="#__codelineno-37-2"></a>
</span><span id="__span-37-3"><a id="__codelineno-37-3" name="__codelineno-37-3" href="#__codelineno-37-3"></a>@tool(&quot;multiply_tool&quot;)
</span><span id="__span-37-4"><a id="__codelineno-37-4" name="__codelineno-37-4" href="#__codelineno-37-4"></a>def multiply(a: int, b: int) -&gt; int:
</span><span id="__span-37-5"><a id="__codelineno-37-5" name="__codelineno-37-5" href="#__codelineno-37-5"></a>    &quot;&quot;&quot;Multiply two numbers.&quot;&quot;&quot;
</span><span id="__span-37-6"><a id="__codelineno-37-6" name="__codelineno-37-6" href="#__codelineno-37-6"></a>    return a * b
</span></code></pre></div>
<h2 id="context-management">Context management<a class="headerlink" href="#context-management" title="Permanent link">#</a></h2>
<p>Tools within LangGraph sometimes require context data, such as runtime-only arguments (e.g., user IDs or session details), that should not be controlled by the model. LangGraph provides three methods for managing such context:</p>
<p><strong>Configuration</strong></p>
<p>Use configuration when you have <strong>immutable</strong> runtime data that tools require, such as user identifiers. You pass these arguments via RunnableConfig at invocation and access them in the tool:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-38-1"><a id="__codelineno-38-1" name="__codelineno-38-1" href="#__codelineno-38-1"></a>from langchain_core.tools import tool
</span><span id="__span-38-2"><a id="__codelineno-38-2" name="__codelineno-38-2" href="#__codelineno-38-2"></a>from langchain_core.runnables import RunnableConfig
</span><span id="__span-38-3"><a id="__codelineno-38-3" name="__codelineno-38-3" href="#__codelineno-38-3"></a>
</span><span id="__span-38-4"><a id="__codelineno-38-4" name="__codelineno-38-4" href="#__codelineno-38-4"></a>@tool
</span><span id="__span-38-5"><a id="__codelineno-38-5" name="__codelineno-38-5" href="#__codelineno-38-5"></a>def get_user_info(config: RunnableConfig) -&gt; str:
</span><span id="__span-38-6"><a id="__codelineno-38-6" name="__codelineno-38-6" href="#__codelineno-38-6"></a>    &quot;&quot;&quot;Retrieve user information based on user ID.&quot;&quot;&quot;
</span><span id="__span-38-7"><a id="__codelineno-38-7" name="__codelineno-38-7" href="#__codelineno-38-7"></a>    user_id = config[&quot;configurable&quot;].get(&quot;user_id&quot;)
</span><span id="__span-38-8"><a id="__codelineno-38-8" name="__codelineno-38-8" href="#__codelineno-38-8"></a>    return &quot;User is John Smith&quot; if user_id == &quot;user_123&quot; else &quot;Unknown user&quot;
</span><span id="__span-38-9"><a id="__codelineno-38-9" name="__codelineno-38-9" href="#__codelineno-38-9"></a>
</span><span id="__span-38-10"><a id="__codelineno-38-10" name="__codelineno-38-10" href="#__codelineno-38-10"></a># Invocation example with an agent
</span><span id="__span-38-11"><a id="__codelineno-38-11" name="__codelineno-38-11" href="#__codelineno-38-11"></a>agent.invoke(
</span><span id="__span-38-12"><a id="__codelineno-38-12" name="__codelineno-38-12" href="#__codelineno-38-12"></a>    {&quot;messages&quot;: [{&quot;role&quot;: &quot;user&quot;, &quot;content&quot;: &quot;look up user info&quot;}]},
</span><span id="__span-38-13"><a id="__codelineno-38-13" name="__codelineno-38-13" href="#__codelineno-38-13"></a>    config={&quot;configurable&quot;: {&quot;user_id&quot;: &quot;user_123&quot;}}
</span><span id="__span-38-14"><a id="__codelineno-38-14" name="__codelineno-38-14" href="#__codelineno-38-14"></a>)
</span></code></pre></div>
<p><strong>Extended example: Access config in tools</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-39-1"><a id="__codelineno-39-1" name="__codelineno-39-1" href="#__codelineno-39-1"></a>from langchain_core.runnables import RunnableConfig
</span><span id="__span-39-2"><a id="__codelineno-39-2" name="__codelineno-39-2" href="#__codelineno-39-2"></a>from langchain_core.tools import tool
</span><span id="__span-39-3"><a id="__codelineno-39-3" name="__codelineno-39-3" href="#__codelineno-39-3"></a>from langgraph.prebuilt import create_react_agent
</span><span id="__span-39-4"><a id="__codelineno-39-4" name="__codelineno-39-4" href="#__codelineno-39-4"></a>
</span><span id="__span-39-5"><a id="__codelineno-39-5" name="__codelineno-39-5" href="#__codelineno-39-5"></a>def get_user_info(
</span><span id="__span-39-6"><a id="__codelineno-39-6" name="__codelineno-39-6" href="#__codelineno-39-6"></a>    config: RunnableConfig,
</span><span id="__span-39-7"><a id="__codelineno-39-7" name="__codelineno-39-7" href="#__codelineno-39-7"></a>) -&gt; str:
</span><span id="__span-39-8"><a id="__codelineno-39-8" name="__codelineno-39-8" href="#__codelineno-39-8"></a>    &quot;&quot;&quot;Look up user info.&quot;&quot;&quot;
</span><span id="__span-39-9"><a id="__codelineno-39-9" name="__codelineno-39-9" href="#__codelineno-39-9"></a>    user_id = config[&quot;configurable&quot;].get(&quot;user_id&quot;)
</span><span id="__span-39-10"><a id="__codelineno-39-10" name="__codelineno-39-10" href="#__codelineno-39-10"></a>    return &quot;User is John Smith&quot; if user_id == &quot;user_123&quot; else &quot;Unknown user&quot;
</span><span id="__span-39-11"><a id="__codelineno-39-11" name="__codelineno-39-11" href="#__codelineno-39-11"></a>
</span><span id="__span-39-12"><a id="__codelineno-39-12" name="__codelineno-39-12" href="#__codelineno-39-12"></a>agent = create_react_agent(
</span><span id="__span-39-13"><a id="__codelineno-39-13" name="__codelineno-39-13" href="#__codelineno-39-13"></a>    model=&quot;anthropic:claude-3-7-sonnet-latest&quot;,
</span><span id="__span-39-14"><a id="__codelineno-39-14" name="__codelineno-39-14" href="#__codelineno-39-14"></a>    tools=[get_user_info],
</span><span id="__span-39-15"><a id="__codelineno-39-15" name="__codelineno-39-15" href="#__codelineno-39-15"></a>)
</span><span id="__span-39-16"><a id="__codelineno-39-16" name="__codelineno-39-16" href="#__codelineno-39-16"></a>
</span><span id="__span-39-17"><a id="__codelineno-39-17" name="__codelineno-39-17" href="#__codelineno-39-17"></a>agent.invoke(
</span><span id="__span-39-18"><a id="__codelineno-39-18" name="__codelineno-39-18" href="#__codelineno-39-18"></a>    {&quot;messages&quot;: [{&quot;role&quot;: &quot;user&quot;, &quot;content&quot;: &quot;look up user information&quot;}]},
</span><span id="__span-39-19"><a id="__codelineno-39-19" name="__codelineno-39-19" href="#__codelineno-39-19"></a>    config={&quot;configurable&quot;: {&quot;user_id&quot;: &quot;user_123&quot;}}
</span><span id="__span-39-20"><a id="__codelineno-39-20" name="__codelineno-39-20" href="#__codelineno-39-20"></a>)
</span></code></pre></div>
<p><strong>Short-term memory</strong></p>
<p>Short-term memory maintains dynamic state that changes during a single execution.</p>
<p>To <strong>access</strong> (read) the graph state inside the tools, you can use a special parameter <strong>annotation</strong> — InjectedState:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-40-1"><a id="__codelineno-40-1" name="__codelineno-40-1" href="#__codelineno-40-1"></a>from typing import Annotated, NotRequired
</span><span id="__span-40-2"><a id="__codelineno-40-2" name="__codelineno-40-2" href="#__codelineno-40-2"></a>from langchain_core.tools import tool
</span><span id="__span-40-3"><a id="__codelineno-40-3" name="__codelineno-40-3" href="#__codelineno-40-3"></a>from langgraph.prebuilt import InjectedState, create_react_agent
</span><span id="__span-40-4"><a id="__codelineno-40-4" name="__codelineno-40-4" href="#__codelineno-40-4"></a>from langgraph.prebuilt.chat_agent_executor import AgentState
</span><span id="__span-40-5"><a id="__codelineno-40-5" name="__codelineno-40-5" href="#__codelineno-40-5"></a>
</span><span id="__span-40-6"><a id="__codelineno-40-6" name="__codelineno-40-6" href="#__codelineno-40-6"></a>class CustomState(AgentState):
</span><span id="__span-40-7"><a id="__codelineno-40-7" name="__codelineno-40-7" href="#__codelineno-40-7"></a>    # The user_name field in short-term state
</span><span id="__span-40-8"><a id="__codelineno-40-8" name="__codelineno-40-8" href="#__codelineno-40-8"></a>    user_name: NotRequired[str]
</span><span id="__span-40-9"><a id="__codelineno-40-9" name="__codelineno-40-9" href="#__codelineno-40-9"></a>
</span><span id="__span-40-10"><a id="__codelineno-40-10" name="__codelineno-40-10" href="#__codelineno-40-10"></a>@tool
</span><span id="__span-40-11"><a id="__codelineno-40-11" name="__codelineno-40-11" href="#__codelineno-40-11"></a>def get_user_name(
</span><span id="__span-40-12"><a id="__codelineno-40-12" name="__codelineno-40-12" href="#__codelineno-40-12"></a>    state: Annotated[CustomState, InjectedState]
</span><span id="__span-40-13"><a id="__codelineno-40-13" name="__codelineno-40-13" href="#__codelineno-40-13"></a>) -&gt; str:
</span><span id="__span-40-14"><a id="__codelineno-40-14" name="__codelineno-40-14" href="#__codelineno-40-14"></a>    &quot;&quot;&quot;Retrieve the current user-name from state.&quot;&quot;&quot;
</span><span id="__span-40-15"><a id="__codelineno-40-15" name="__codelineno-40-15" href="#__codelineno-40-15"></a>    # Return stored name or a default if not set
</span><span id="__span-40-16"><a id="__codelineno-40-16" name="__codelineno-40-16" href="#__codelineno-40-16"></a>    return state.get(&quot;user_name&quot;, &quot;Unknown user&quot;)
</span><span id="__span-40-17"><a id="__codelineno-40-17" name="__codelineno-40-17" href="#__codelineno-40-17"></a>
</span><span id="__span-40-18"><a id="__codelineno-40-18" name="__codelineno-40-18" href="#__codelineno-40-18"></a># Example agent setup
</span><span id="__span-40-19"><a id="__codelineno-40-19" name="__codelineno-40-19" href="#__codelineno-40-19"></a>agent = create_react_agent(
</span><span id="__span-40-20"><a id="__codelineno-40-20" name="__codelineno-40-20" href="#__codelineno-40-20"></a>    model=&quot;anthropic:claude-3-7-sonnet-latest&quot;,
</span><span id="__span-40-21"><a id="__codelineno-40-21" name="__codelineno-40-21" href="#__codelineno-40-21"></a>    tools=[get_user_name],
</span><span id="__span-40-22"><a id="__codelineno-40-22" name="__codelineno-40-22" href="#__codelineno-40-22"></a>    state_schema=CustomState,
</span><span id="__span-40-23"><a id="__codelineno-40-23" name="__codelineno-40-23" href="#__codelineno-40-23"></a>)
</span><span id="__span-40-24"><a id="__codelineno-40-24" name="__codelineno-40-24" href="#__codelineno-40-24"></a>
</span><span id="__span-40-25"><a id="__codelineno-40-25" name="__codelineno-40-25" href="#__codelineno-40-25"></a># Invocation: reads the name from state (initially empty)
</span><span id="__span-40-26"><a id="__codelineno-40-26" name="__codelineno-40-26" href="#__codelineno-40-26"></a>agent.invoke({&quot;messages&quot;: &quot;what&#39;s my name?&quot;})
</span></code></pre></div>
<p><strong>Long-term memory</strong></p>
<p>Use <strong>long-term memory</strong> to store user-specific or application-specific data across conversations. This is useful for applications like chatbots, where you want to remember user preferences or other information.</p>
<p>To use long-term memory, you need to:</p>
<ol>
<li>
<p>Configure a store to persist data across invocations.</p>
</li>
<li>
<p>Access the store from within tools.</p>
</li>
</ol>
<p>To <strong>access</strong> information in the store:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-41-1"><a id="__codelineno-41-1" name="__codelineno-41-1" href="#__codelineno-41-1"></a>from langchain_core.runnables import RunnableConfig
</span><span id="__span-41-2"><a id="__codelineno-41-2" name="__codelineno-41-2" href="#__codelineno-41-2"></a>from langchain_core.tools import tool
</span><span id="__span-41-3"><a id="__codelineno-41-3" name="__codelineno-41-3" href="#__codelineno-41-3"></a>from langgraph.graph import StateGraph
</span><span id="__span-41-4"><a id="__codelineno-41-4" name="__codelineno-41-4" href="#__codelineno-41-4"></a>from langgraph.config import get_store
</span><span id="__span-41-5"><a id="__codelineno-41-5" name="__codelineno-41-5" href="#__codelineno-41-5"></a>
</span><span id="__span-41-6"><a id="__codelineno-41-6" name="__codelineno-41-6" href="#__codelineno-41-6"></a>@tool
</span><span id="__span-41-7"><a id="__codelineno-41-7" name="__codelineno-41-7" href="#__codelineno-41-7"></a>def get_user_info(config: RunnableConfig) -&gt; str:
</span><span id="__span-41-8"><a id="__codelineno-41-8" name="__codelineno-41-8" href="#__codelineno-41-8"></a>    &quot;&quot;&quot;Look up user info.&quot;&quot;&quot;
</span><span id="__span-41-9"><a id="__codelineno-41-9" name="__codelineno-41-9" href="#__codelineno-41-9"></a>    # Same as that provided to `builder.compile(store=store)`
</span><span id="__span-41-10"><a id="__codelineno-41-10" name="__codelineno-41-10" href="#__codelineno-41-10"></a>    # or `create_react_agent`
</span><span id="__span-41-11"><a id="__codelineno-41-11" name="__codelineno-41-11" href="#__codelineno-41-11"></a>    store = get_store()
</span><span id="__span-41-12"><a id="__codelineno-41-12" name="__codelineno-41-12" href="#__codelineno-41-12"></a>    user_id = config[&quot;configurable&quot;].get(&quot;user_id&quot;)
</span><span id="__span-41-13"><a id="__codelineno-41-13" name="__codelineno-41-13" href="#__codelineno-41-13"></a>    user_info = store.get((&quot;users&quot;,), user_id)
</span><span id="__span-41-14"><a id="__codelineno-41-14" name="__codelineno-41-14" href="#__codelineno-41-14"></a>    return str(user_info.value) if user_info else &quot;Unknown user&quot;
</span><span id="__span-41-15"><a id="__codelineno-41-15" name="__codelineno-41-15" href="#__codelineno-41-15"></a>
</span><span id="__span-41-16"><a id="__codelineno-41-16" name="__codelineno-41-16" href="#__codelineno-41-16"></a>builder = StateGraph(...)
</span><span id="__span-41-17"><a id="__codelineno-41-17" name="__codelineno-41-17" href="#__codelineno-41-17"></a>...
</span><span id="__span-41-18"><a id="__codelineno-41-18" name="__codelineno-41-18" href="#__codelineno-41-18"></a>graph = builder.compile(store=store)
</span></code></pre></div>
<p><strong>Access long-term memory</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-42-1"><a id="__codelineno-42-1" name="__codelineno-42-1" href="#__codelineno-42-1"></a>from langchain_core.runnables import RunnableConfig
</span><span id="__span-42-2"><a id="__codelineno-42-2" name="__codelineno-42-2" href="#__codelineno-42-2"></a>from langchain_core.tools import tool
</span><span id="__span-42-3"><a id="__codelineno-42-3" name="__codelineno-42-3" href="#__codelineno-42-3"></a>from langgraph.config import get_store
</span><span id="__span-42-4"><a id="__codelineno-42-4" name="__codelineno-42-4" href="#__codelineno-42-4"></a>from langgraph.prebuilt import create_react_agent
</span><span id="__span-42-5"><a id="__codelineno-42-5" name="__codelineno-42-5" href="#__codelineno-42-5"></a>from langgraph.store.memory import InMemoryStore
</span><span id="__span-42-6"><a id="__codelineno-42-6" name="__codelineno-42-6" href="#__codelineno-42-6"></a>
</span><span id="__span-42-7"><a id="__codelineno-42-7" name="__codelineno-42-7" href="#__codelineno-42-7"></a>store = InMemoryStore() 
</span><span id="__span-42-8"><a id="__codelineno-42-8" name="__codelineno-42-8" href="#__codelineno-42-8"></a>
</span><span id="__span-42-9"><a id="__codelineno-42-9" name="__codelineno-42-9" href="#__codelineno-42-9"></a>store.put(  
</span><span id="__span-42-10"><a id="__codelineno-42-10" name="__codelineno-42-10" href="#__codelineno-42-10"></a>    (&quot;users&quot;,),  
</span><span id="__span-42-11"><a id="__codelineno-42-11" name="__codelineno-42-11" href="#__codelineno-42-11"></a>    &quot;user_123&quot;,  
</span><span id="__span-42-12"><a id="__codelineno-42-12" name="__codelineno-42-12" href="#__codelineno-42-12"></a>    {
</span><span id="__span-42-13"><a id="__codelineno-42-13" name="__codelineno-42-13" href="#__codelineno-42-13"></a>        &quot;name&quot;: &quot;John Smith&quot;,
</span><span id="__span-42-14"><a id="__codelineno-42-14" name="__codelineno-42-14" href="#__codelineno-42-14"></a>        &quot;language&quot;: &quot;English&quot;,
</span><span id="__span-42-15"><a id="__codelineno-42-15" name="__codelineno-42-15" href="#__codelineno-42-15"></a>    } 
</span><span id="__span-42-16"><a id="__codelineno-42-16" name="__codelineno-42-16" href="#__codelineno-42-16"></a>)
</span><span id="__span-42-17"><a id="__codelineno-42-17" name="__codelineno-42-17" href="#__codelineno-42-17"></a>
</span><span id="__span-42-18"><a id="__codelineno-42-18" name="__codelineno-42-18" href="#__codelineno-42-18"></a>@tool
</span><span id="__span-42-19"><a id="__codelineno-42-19" name="__codelineno-42-19" href="#__codelineno-42-19"></a>def get_user_info(config: RunnableConfig) -&gt; str:
</span><span id="__span-42-20"><a id="__codelineno-42-20" name="__codelineno-42-20" href="#__codelineno-42-20"></a>    &quot;&quot;&quot;Look up user info.&quot;&quot;&quot;
</span><span id="__span-42-21"><a id="__codelineno-42-21" name="__codelineno-42-21" href="#__codelineno-42-21"></a>    # Same as that provided to `create_react_agent`
</span><span id="__span-42-22"><a id="__codelineno-42-22" name="__codelineno-42-22" href="#__codelineno-42-22"></a>    store = get_store() 
</span><span id="__span-42-23"><a id="__codelineno-42-23" name="__codelineno-42-23" href="#__codelineno-42-23"></a>    user_id = config[&quot;configurable&quot;].get(&quot;user_id&quot;)
</span><span id="__span-42-24"><a id="__codelineno-42-24" name="__codelineno-42-24" href="#__codelineno-42-24"></a>    user_info = store.get((&quot;users&quot;,), user_id) 
</span><span id="__span-42-25"><a id="__codelineno-42-25" name="__codelineno-42-25" href="#__codelineno-42-25"></a>    return str(user_info.value) if user_info else &quot;Unknown user&quot;
</span><span id="__span-42-26"><a id="__codelineno-42-26" name="__codelineno-42-26" href="#__codelineno-42-26"></a>
</span><span id="__span-42-27"><a id="__codelineno-42-27" name="__codelineno-42-27" href="#__codelineno-42-27"></a>agent = create_react_agent(
</span><span id="__span-42-28"><a id="__codelineno-42-28" name="__codelineno-42-28" href="#__codelineno-42-28"></a>    model=&quot;anthropic:claude-3-7-sonnet-latest&quot;,
</span><span id="__span-42-29"><a id="__codelineno-42-29" name="__codelineno-42-29" href="#__codelineno-42-29"></a>    tools=[get_user_info],
</span><span id="__span-42-30"><a id="__codelineno-42-30" name="__codelineno-42-30" href="#__codelineno-42-30"></a>    store=store 
</span><span id="__span-42-31"><a id="__codelineno-42-31" name="__codelineno-42-31" href="#__codelineno-42-31"></a>)
</span><span id="__span-42-32"><a id="__codelineno-42-32" name="__codelineno-42-32" href="#__codelineno-42-32"></a>
</span><span id="__span-42-33"><a id="__codelineno-42-33" name="__codelineno-42-33" href="#__codelineno-42-33"></a># Run the agent
</span><span id="__span-42-34"><a id="__codelineno-42-34" name="__codelineno-42-34" href="#__codelineno-42-34"></a>agent.invoke(
</span><span id="__span-42-35"><a id="__codelineno-42-35" name="__codelineno-42-35" href="#__codelineno-42-35"></a>    {&quot;messages&quot;: [{&quot;role&quot;: &quot;user&quot;, &quot;content&quot;: &quot;look up user information&quot;}]},
</span><span id="__span-42-36"><a id="__codelineno-42-36" name="__codelineno-42-36" href="#__codelineno-42-36"></a>    config={&quot;configurable&quot;: {&quot;user_id&quot;: &quot;user_123&quot;}}
</span><span id="__span-42-37"><a id="__codelineno-42-37" name="__codelineno-42-37" href="#__codelineno-42-37"></a>)
</span></code></pre></div>
<p>To <strong>update</strong> information in the store:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-43-1"><a id="__codelineno-43-1" name="__codelineno-43-1" href="#__codelineno-43-1"></a>from langchain_core.runnables import RunnableConfig
</span><span id="__span-43-2"><a id="__codelineno-43-2" name="__codelineno-43-2" href="#__codelineno-43-2"></a>from langchain_core.tools import tool
</span><span id="__span-43-3"><a id="__codelineno-43-3" name="__codelineno-43-3" href="#__codelineno-43-3"></a>from langgraph.graph import StateGraph
</span><span id="__span-43-4"><a id="__codelineno-43-4" name="__codelineno-43-4" href="#__codelineno-43-4"></a>from langgraph.config import get_store
</span><span id="__span-43-5"><a id="__codelineno-43-5" name="__codelineno-43-5" href="#__codelineno-43-5"></a>
</span><span id="__span-43-6"><a id="__codelineno-43-6" name="__codelineno-43-6" href="#__codelineno-43-6"></a>@tool
</span><span id="__span-43-7"><a id="__codelineno-43-7" name="__codelineno-43-7" href="#__codelineno-43-7"></a>def save_user_info(user_info: str, config: RunnableConfig) -&gt; str:
</span><span id="__span-43-8"><a id="__codelineno-43-8" name="__codelineno-43-8" href="#__codelineno-43-8"></a>    &quot;&quot;&quot;Save user info.&quot;&quot;&quot;
</span><span id="__span-43-9"><a id="__codelineno-43-9" name="__codelineno-43-9" href="#__codelineno-43-9"></a>    # Same as that provided to `builder.compile(store=store)`
</span><span id="__span-43-10"><a id="__codelineno-43-10" name="__codelineno-43-10" href="#__codelineno-43-10"></a>    # or `create_react_agent`
</span><span id="__span-43-11"><a id="__codelineno-43-11" name="__codelineno-43-11" href="#__codelineno-43-11"></a>    store = get_store()
</span><span id="__span-43-12"><a id="__codelineno-43-12" name="__codelineno-43-12" href="#__codelineno-43-12"></a>    user_id = config[&quot;configurable&quot;].get(&quot;user_id&quot;)
</span><span id="__span-43-13"><a id="__codelineno-43-13" name="__codelineno-43-13" href="#__codelineno-43-13"></a>    store.put((&quot;users&quot;,), user_id, user_info)
</span><span id="__span-43-14"><a id="__codelineno-43-14" name="__codelineno-43-14" href="#__codelineno-43-14"></a>    return &quot;Successfully saved user info.&quot;
</span><span id="__span-43-15"><a id="__codelineno-43-15" name="__codelineno-43-15" href="#__codelineno-43-15"></a>
</span><span id="__span-43-16"><a id="__codelineno-43-16" name="__codelineno-43-16" href="#__codelineno-43-16"></a>builder = StateGraph(...)
</span><span id="__span-43-17"><a id="__codelineno-43-17" name="__codelineno-43-17" href="#__codelineno-43-17"></a>...
</span><span id="__span-43-18"><a id="__codelineno-43-18" name="__codelineno-43-18" href="#__codelineno-43-18"></a>graph = builder.compile(store=store)
</span></code></pre></div>
<p><strong>Update long-term memory</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-44-1"><a id="__codelineno-44-1" name="__codelineno-44-1" href="#__codelineno-44-1"></a>from typing_extensions import TypedDict
</span><span id="__span-44-2"><a id="__codelineno-44-2" name="__codelineno-44-2" href="#__codelineno-44-2"></a>
</span><span id="__span-44-3"><a id="__codelineno-44-3" name="__codelineno-44-3" href="#__codelineno-44-3"></a>from langchain_core.tools import tool
</span><span id="__span-44-4"><a id="__codelineno-44-4" name="__codelineno-44-4" href="#__codelineno-44-4"></a>from langgraph.config import get_store
</span><span id="__span-44-5"><a id="__codelineno-44-5" name="__codelineno-44-5" href="#__codelineno-44-5"></a>from langchain_core.runnables import RunnableConfig
</span><span id="__span-44-6"><a id="__codelineno-44-6" name="__codelineno-44-6" href="#__codelineno-44-6"></a>from langgraph.prebuilt import create_react_agent
</span><span id="__span-44-7"><a id="__codelineno-44-7" name="__codelineno-44-7" href="#__codelineno-44-7"></a>from langgraph.store.memory import InMemoryStore
</span><span id="__span-44-8"><a id="__codelineno-44-8" name="__codelineno-44-8" href="#__codelineno-44-8"></a>
</span><span id="__span-44-9"><a id="__codelineno-44-9" name="__codelineno-44-9" href="#__codelineno-44-9"></a>store = InMemoryStore() 
</span><span id="__span-44-10"><a id="__codelineno-44-10" name="__codelineno-44-10" href="#__codelineno-44-10"></a>
</span><span id="__span-44-11"><a id="__codelineno-44-11" name="__codelineno-44-11" href="#__codelineno-44-11"></a>class UserInfo(TypedDict): 
</span><span id="__span-44-12"><a id="__codelineno-44-12" name="__codelineno-44-12" href="#__codelineno-44-12"></a>    name: str
</span><span id="__span-44-13"><a id="__codelineno-44-13" name="__codelineno-44-13" href="#__codelineno-44-13"></a>
</span><span id="__span-44-14"><a id="__codelineno-44-14" name="__codelineno-44-14" href="#__codelineno-44-14"></a>@tool
</span><span id="__span-44-15"><a id="__codelineno-44-15" name="__codelineno-44-15" href="#__codelineno-44-15"></a>def save_user_info(user_info: UserInfo, config: RunnableConfig) -&gt; str: 
</span><span id="__span-44-16"><a id="__codelineno-44-16" name="__codelineno-44-16" href="#__codelineno-44-16"></a>    &quot;&quot;&quot;Save user info.&quot;&quot;&quot;
</span><span id="__span-44-17"><a id="__codelineno-44-17" name="__codelineno-44-17" href="#__codelineno-44-17"></a>    # Same as that provided to `create_react_agent`
</span><span id="__span-44-18"><a id="__codelineno-44-18" name="__codelineno-44-18" href="#__codelineno-44-18"></a>    store = get_store() 
</span><span id="__span-44-19"><a id="__codelineno-44-19" name="__codelineno-44-19" href="#__codelineno-44-19"></a>    user_id = config[&quot;configurable&quot;].get(&quot;user_id&quot;)
</span><span id="__span-44-20"><a id="__codelineno-44-20" name="__codelineno-44-20" href="#__codelineno-44-20"></a>    store.put((&quot;users&quot;,), user_id, user_info) 
</span><span id="__span-44-21"><a id="__codelineno-44-21" name="__codelineno-44-21" href="#__codelineno-44-21"></a>    return &quot;Successfully saved user info.&quot;
</span><span id="__span-44-22"><a id="__codelineno-44-22" name="__codelineno-44-22" href="#__codelineno-44-22"></a>
</span><span id="__span-44-23"><a id="__codelineno-44-23" name="__codelineno-44-23" href="#__codelineno-44-23"></a>agent = create_react_agent(
</span><span id="__span-44-24"><a id="__codelineno-44-24" name="__codelineno-44-24" href="#__codelineno-44-24"></a>    model=&quot;anthropic:claude-3-7-sonnet-latest&quot;,
</span><span id="__span-44-25"><a id="__codelineno-44-25" name="__codelineno-44-25" href="#__codelineno-44-25"></a>    tools=[save_user_info],
</span><span id="__span-44-26"><a id="__codelineno-44-26" name="__codelineno-44-26" href="#__codelineno-44-26"></a>    store=store
</span><span id="__span-44-27"><a id="__codelineno-44-27" name="__codelineno-44-27" href="#__codelineno-44-27"></a>)
</span><span id="__span-44-28"><a id="__codelineno-44-28" name="__codelineno-44-28" href="#__codelineno-44-28"></a>
</span><span id="__span-44-29"><a id="__codelineno-44-29" name="__codelineno-44-29" href="#__codelineno-44-29"></a># Run the agent
</span><span id="__span-44-30"><a id="__codelineno-44-30" name="__codelineno-44-30" href="#__codelineno-44-30"></a>agent.invoke(
</span><span id="__span-44-31"><a id="__codelineno-44-31" name="__codelineno-44-31" href="#__codelineno-44-31"></a>    {&quot;messages&quot;: [{&quot;role&quot;: &quot;user&quot;, &quot;content&quot;: &quot;My name is John Smith&quot;}]},
</span><span id="__span-44-32"><a id="__codelineno-44-32" name="__codelineno-44-32" href="#__codelineno-44-32"></a>    config={&quot;configurable&quot;: {&quot;user_id&quot;: &quot;user_123&quot;}} 
</span><span id="__span-44-33"><a id="__codelineno-44-33" name="__codelineno-44-33" href="#__codelineno-44-33"></a>)
</span><span id="__span-44-34"><a id="__codelineno-44-34" name="__codelineno-44-34" href="#__codelineno-44-34"></a>
</span><span id="__span-44-35"><a id="__codelineno-44-35" name="__codelineno-44-35" href="#__codelineno-44-35"></a># You can access the store directly to get the value
</span><span id="__span-44-36"><a id="__codelineno-44-36" name="__codelineno-44-36" href="#__codelineno-44-36"></a>store.get((&quot;users&quot;,), &quot;user_123&quot;).value
</span></code></pre></div>
<h2 id="advanced-tool-features">Advanced tool features<a class="headerlink" href="#advanced-tool-features" title="Permanent link">#</a></h2>
<p><strong>Immediate return</strong></p>
<p>Use <code>return_direct=True</code> to immediately return a tool's result without executing additional logic.</p>
<p>This is useful for tools that should not trigger further processing or tool calls, allowing you to return results directly to the user.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-45-1"><a id="__codelineno-45-1" name="__codelineno-45-1" href="#__codelineno-45-1"></a>@tool(return_direct=True)
</span><span id="__span-45-2"><a id="__codelineno-45-2" name="__codelineno-45-2" href="#__codelineno-45-2"></a>def add(a: int, b: int) -&gt; int:
</span><span id="__span-45-3"><a id="__codelineno-45-3" name="__codelineno-45-3" href="#__codelineno-45-3"></a>    &quot;&quot;&quot;Add two numbers&quot;&quot;&quot;
</span><span id="__span-45-4"><a id="__codelineno-45-4" name="__codelineno-45-4" href="#__codelineno-45-4"></a>    return a + b
</span></code></pre></div>
<p><strong>Extended example: Using return_direct in a prebuilt agent</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-46-1"><a id="__codelineno-46-1" name="__codelineno-46-1" href="#__codelineno-46-1"></a>from langchain_core.tools import tool
</span><span id="__span-46-2"><a id="__codelineno-46-2" name="__codelineno-46-2" href="#__codelineno-46-2"></a>from langgraph.prebuilt import create_react_agent
</span><span id="__span-46-3"><a id="__codelineno-46-3" name="__codelineno-46-3" href="#__codelineno-46-3"></a>
</span><span id="__span-46-4"><a id="__codelineno-46-4" name="__codelineno-46-4" href="#__codelineno-46-4"></a>@tool(return_direct=True)
</span><span id="__span-46-5"><a id="__codelineno-46-5" name="__codelineno-46-5" href="#__codelineno-46-5"></a>def add(a: int, b: int) -&gt; int:
</span><span id="__span-46-6"><a id="__codelineno-46-6" name="__codelineno-46-6" href="#__codelineno-46-6"></a>    &quot;&quot;&quot;Add two numbers&quot;&quot;&quot;
</span><span id="__span-46-7"><a id="__codelineno-46-7" name="__codelineno-46-7" href="#__codelineno-46-7"></a>    return a + b
</span><span id="__span-46-8"><a id="__codelineno-46-8" name="__codelineno-46-8" href="#__codelineno-46-8"></a>
</span><span id="__span-46-9"><a id="__codelineno-46-9" name="__codelineno-46-9" href="#__codelineno-46-9"></a>agent = create_react_agent(
</span><span id="__span-46-10"><a id="__codelineno-46-10" name="__codelineno-46-10" href="#__codelineno-46-10"></a>    model=&quot;anthropic:claude-3-7-sonnet-latest&quot;,
</span><span id="__span-46-11"><a id="__codelineno-46-11" name="__codelineno-46-11" href="#__codelineno-46-11"></a>    tools=[add]
</span><span id="__span-46-12"><a id="__codelineno-46-12" name="__codelineno-46-12" href="#__codelineno-46-12"></a>)
</span><span id="__span-46-13"><a id="__codelineno-46-13" name="__codelineno-46-13" href="#__codelineno-46-13"></a>
</span><span id="__span-46-14"><a id="__codelineno-46-14" name="__codelineno-46-14" href="#__codelineno-46-14"></a>agent.invoke(
</span><span id="__span-46-15"><a id="__codelineno-46-15" name="__codelineno-46-15" href="#__codelineno-46-15"></a>    {&quot;messages&quot;: [{&quot;role&quot;: &quot;user&quot;, &quot;content&quot;: &quot;what&#39;s 3 + 5?&quot;}]}
</span><span id="__span-46-16"><a id="__codelineno-46-16" name="__codelineno-46-16" href="#__codelineno-46-16"></a>)
</span></code></pre></div>
<p><strong>Force tool use</strong></p>
<p>If you need to force a specific tool to be used, you will need to configure this at the model level using the <code>tool_choice</code> parameter in the bind_tools method.</p>
<p>Force specific tool usage via tool_choice:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-47-1"><a id="__codelineno-47-1" name="__codelineno-47-1" href="#__codelineno-47-1"></a>@tool(return_direct=True)
</span><span id="__span-47-2"><a id="__codelineno-47-2" name="__codelineno-47-2" href="#__codelineno-47-2"></a>def greet(user_name: str) -&gt; int:
</span><span id="__span-47-3"><a id="__codelineno-47-3" name="__codelineno-47-3" href="#__codelineno-47-3"></a>    &quot;&quot;&quot;Greet user.&quot;&quot;&quot;
</span><span id="__span-47-4"><a id="__codelineno-47-4" name="__codelineno-47-4" href="#__codelineno-47-4"></a>    return f&quot;Hello {user_name}!&quot;
</span><span id="__span-47-5"><a id="__codelineno-47-5" name="__codelineno-47-5" href="#__codelineno-47-5"></a>
</span><span id="__span-47-6"><a id="__codelineno-47-6" name="__codelineno-47-6" href="#__codelineno-47-6"></a>tools = [greet]
</span><span id="__span-47-7"><a id="__codelineno-47-7" name="__codelineno-47-7" href="#__codelineno-47-7"></a>
</span><span id="__span-47-8"><a id="__codelineno-47-8" name="__codelineno-47-8" href="#__codelineno-47-8"></a>configured_model = model.bind_tools(
</span><span id="__span-47-9"><a id="__codelineno-47-9" name="__codelineno-47-9" href="#__codelineno-47-9"></a>    tools,
</span><span id="__span-47-10"><a id="__codelineno-47-10" name="__codelineno-47-10" href="#__codelineno-47-10"></a>    # Force the use of the &#39;greet&#39; tool
</span><span id="__span-47-11"><a id="__codelineno-47-11" name="__codelineno-47-11" href="#__codelineno-47-11"></a>    tool_choice={&quot;type&quot;: &quot;tool&quot;, &quot;name&quot;: &quot;greet&quot;}
</span><span id="__span-47-12"><a id="__codelineno-47-12" name="__codelineno-47-12" href="#__codelineno-47-12"></a>)
</span></code></pre></div>
<p><strong>Extended example: Force tool usage in an agent</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-48-1"><a id="__codelineno-48-1" name="__codelineno-48-1" href="#__codelineno-48-1"></a>from langchain_core.tools import tool
</span><span id="__span-48-2"><a id="__codelineno-48-2" name="__codelineno-48-2" href="#__codelineno-48-2"></a>
</span><span id="__span-48-3"><a id="__codelineno-48-3" name="__codelineno-48-3" href="#__codelineno-48-3"></a>@tool(return_direct=True)
</span><span id="__span-48-4"><a id="__codelineno-48-4" name="__codelineno-48-4" href="#__codelineno-48-4"></a>def greet(user_name: str) -&gt; int:
</span><span id="__span-48-5"><a id="__codelineno-48-5" name="__codelineno-48-5" href="#__codelineno-48-5"></a>    &quot;&quot;&quot;Greet user.&quot;&quot;&quot;
</span><span id="__span-48-6"><a id="__codelineno-48-6" name="__codelineno-48-6" href="#__codelineno-48-6"></a>    return f&quot;Hello {user_name}!&quot;
</span><span id="__span-48-7"><a id="__codelineno-48-7" name="__codelineno-48-7" href="#__codelineno-48-7"></a>
</span><span id="__span-48-8"><a id="__codelineno-48-8" name="__codelineno-48-8" href="#__codelineno-48-8"></a>tools = [greet]
</span><span id="__span-48-9"><a id="__codelineno-48-9" name="__codelineno-48-9" href="#__codelineno-48-9"></a>
</span><span id="__span-48-10"><a id="__codelineno-48-10" name="__codelineno-48-10" href="#__codelineno-48-10"></a>agent = create_react_agent(
</span><span id="__span-48-11"><a id="__codelineno-48-11" name="__codelineno-48-11" href="#__codelineno-48-11"></a>    model=model.bind_tools(tools, tool_choice={&quot;type&quot;: &quot;tool&quot;, &quot;name&quot;: &quot;greet&quot;}),
</span><span id="__span-48-12"><a id="__codelineno-48-12" name="__codelineno-48-12" href="#__codelineno-48-12"></a>    tools=tools
</span><span id="__span-48-13"><a id="__codelineno-48-13" name="__codelineno-48-13" href="#__codelineno-48-13"></a>)
</span><span id="__span-48-14"><a id="__codelineno-48-14" name="__codelineno-48-14" href="#__codelineno-48-14"></a>
</span><span id="__span-48-15"><a id="__codelineno-48-15" name="__codelineno-48-15" href="#__codelineno-48-15"></a>agent.invoke(
</span><span id="__span-48-16"><a id="__codelineno-48-16" name="__codelineno-48-16" href="#__codelineno-48-16"></a>    {&quot;messages&quot;: [{&quot;role&quot;: &quot;user&quot;, &quot;content&quot;: &quot;Hi, I am Bob&quot;}]}
</span><span id="__span-48-17"><a id="__codelineno-48-17" name="__codelineno-48-17" href="#__codelineno-48-17"></a>)
</span></code></pre></div>
<p><code>Forcing tool usage without stopping conditions can create infinite loops. Use one of the following safeguards:</code></p>
<ul>
<li>
<p>Mark the tool with <code>return_direct=True</code> to end the loop after execution.</p>
</li>
<li>
<p>Set <code>recursion_limit</code> to restrict the number of execution steps.</p>
</li>
</ul>
<p><strong>Disable parallel calls</strong></p>
<p>For supported providers, you can disable parallel tool calling by setting <code>parallel_tool_calls=False</code> via the <code>model.bind_tools()</code> method:</p>
<p><strong>Extended example: disable parallel tool calls in a prebuilt agent</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-49-1"><a id="__codelineno-49-1" name="__codelineno-49-1" href="#__codelineno-49-1"></a>from langchain.chat_models import init_chat_model
</span><span id="__span-49-2"><a id="__codelineno-49-2" name="__codelineno-49-2" href="#__codelineno-49-2"></a>
</span><span id="__span-49-3"><a id="__codelineno-49-3" name="__codelineno-49-3" href="#__codelineno-49-3"></a>def add(a: int, b: int) -&gt; int:
</span><span id="__span-49-4"><a id="__codelineno-49-4" name="__codelineno-49-4" href="#__codelineno-49-4"></a>    &quot;&quot;&quot;Add two numbers&quot;&quot;&quot;
</span><span id="__span-49-5"><a id="__codelineno-49-5" name="__codelineno-49-5" href="#__codelineno-49-5"></a>    return a + b
</span><span id="__span-49-6"><a id="__codelineno-49-6" name="__codelineno-49-6" href="#__codelineno-49-6"></a>
</span><span id="__span-49-7"><a id="__codelineno-49-7" name="__codelineno-49-7" href="#__codelineno-49-7"></a>def multiply(a: int, b: int) -&gt; int:
</span><span id="__span-49-8"><a id="__codelineno-49-8" name="__codelineno-49-8" href="#__codelineno-49-8"></a>    &quot;&quot;&quot;Multiply two numbers.&quot;&quot;&quot;
</span><span id="__span-49-9"><a id="__codelineno-49-9" name="__codelineno-49-9" href="#__codelineno-49-9"></a>    return a * b
</span><span id="__span-49-10"><a id="__codelineno-49-10" name="__codelineno-49-10" href="#__codelineno-49-10"></a>
</span><span id="__span-49-11"><a id="__codelineno-49-11" name="__codelineno-49-11" href="#__codelineno-49-11"></a>model = init_chat_model(&quot;anthropic:claude-3-5-sonnet-latest&quot;, temperature=0)
</span><span id="__span-49-12"><a id="__codelineno-49-12" name="__codelineno-49-12" href="#__codelineno-49-12"></a>tools = [add, multiply]
</span><span id="__span-49-13"><a id="__codelineno-49-13" name="__codelineno-49-13" href="#__codelineno-49-13"></a>agent = create_react_agent(
</span><span id="__span-49-14"><a id="__codelineno-49-14" name="__codelineno-49-14" href="#__codelineno-49-14"></a>    # disable parallel tool calls
</span><span id="__span-49-15"><a id="__codelineno-49-15" name="__codelineno-49-15" href="#__codelineno-49-15"></a>    model=model.bind_tools(tools, parallel_tool_calls=False),
</span><span id="__span-49-16"><a id="__codelineno-49-16" name="__codelineno-49-16" href="#__codelineno-49-16"></a>    tools=tools
</span><span id="__span-49-17"><a id="__codelineno-49-17" name="__codelineno-49-17" href="#__codelineno-49-17"></a>)
</span><span id="__span-49-18"><a id="__codelineno-49-18" name="__codelineno-49-18" href="#__codelineno-49-18"></a>
</span><span id="__span-49-19"><a id="__codelineno-49-19" name="__codelineno-49-19" href="#__codelineno-49-19"></a>agent.invoke(
</span><span id="__span-49-20"><a id="__codelineno-49-20" name="__codelineno-49-20" href="#__codelineno-49-20"></a>    {&quot;messages&quot;: [{&quot;role&quot;: &quot;user&quot;, &quot;content&quot;: &quot;what&#39;s 3 + 5 and 4 * 7?&quot;}]}
</span><span id="__span-49-21"><a id="__codelineno-49-21" name="__codelineno-49-21" href="#__codelineno-49-21"></a>)
</span></code></pre></div>
<p><strong>Handle errors</strong></p>
<p>LangGraph provides built-in error handling for tool execution through the prebuilt ToolNode component, used both independently and in prebuilt agents.</p>
<p>By default, ToolNode catches exceptions raised during tool execution and returns them as ToolMessage objects with a status indicating an error.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-50-1"><a id="__codelineno-50-1" name="__codelineno-50-1" href="#__codelineno-50-1"></a>from langchain_core.messages import AIMessage
</span><span id="__span-50-2"><a id="__codelineno-50-2" name="__codelineno-50-2" href="#__codelineno-50-2"></a>from langgraph.prebuilt import ToolNode
</span><span id="__span-50-3"><a id="__codelineno-50-3" name="__codelineno-50-3" href="#__codelineno-50-3"></a>
</span><span id="__span-50-4"><a id="__codelineno-50-4" name="__codelineno-50-4" href="#__codelineno-50-4"></a>def multiply(a: int, b: int) -&gt; int:
</span><span id="__span-50-5"><a id="__codelineno-50-5" name="__codelineno-50-5" href="#__codelineno-50-5"></a>    if a == 42:
</span><span id="__span-50-6"><a id="__codelineno-50-6" name="__codelineno-50-6" href="#__codelineno-50-6"></a>        raise ValueError(&quot;The ultimate error&quot;)
</span><span id="__span-50-7"><a id="__codelineno-50-7" name="__codelineno-50-7" href="#__codelineno-50-7"></a>    return a * b
</span><span id="__span-50-8"><a id="__codelineno-50-8" name="__codelineno-50-8" href="#__codelineno-50-8"></a>
</span><span id="__span-50-9"><a id="__codelineno-50-9" name="__codelineno-50-9" href="#__codelineno-50-9"></a># Default error handling (enabled by default)
</span><span id="__span-50-10"><a id="__codelineno-50-10" name="__codelineno-50-10" href="#__codelineno-50-10"></a>tool_node = ToolNode([multiply])
</span><span id="__span-50-11"><a id="__codelineno-50-11" name="__codelineno-50-11" href="#__codelineno-50-11"></a>
</span><span id="__span-50-12"><a id="__codelineno-50-12" name="__codelineno-50-12" href="#__codelineno-50-12"></a>message = AIMessage(
</span><span id="__span-50-13"><a id="__codelineno-50-13" name="__codelineno-50-13" href="#__codelineno-50-13"></a>    content=&quot;&quot;,
</span><span id="__span-50-14"><a id="__codelineno-50-14" name="__codelineno-50-14" href="#__codelineno-50-14"></a>    tool_calls=[{
</span><span id="__span-50-15"><a id="__codelineno-50-15" name="__codelineno-50-15" href="#__codelineno-50-15"></a>        &quot;name&quot;: &quot;multiply&quot;,
</span><span id="__span-50-16"><a id="__codelineno-50-16" name="__codelineno-50-16" href="#__codelineno-50-16"></a>        &quot;args&quot;: {&quot;a&quot;: 42, &quot;b&quot;: 7},
</span><span id="__span-50-17"><a id="__codelineno-50-17" name="__codelineno-50-17" href="#__codelineno-50-17"></a>        &quot;id&quot;: &quot;tool_call_id&quot;,
</span><span id="__span-50-18"><a id="__codelineno-50-18" name="__codelineno-50-18" href="#__codelineno-50-18"></a>        &quot;type&quot;: &quot;tool_call&quot;
</span><span id="__span-50-19"><a id="__codelineno-50-19" name="__codelineno-50-19" href="#__codelineno-50-19"></a>    }]
</span><span id="__span-50-20"><a id="__codelineno-50-20" name="__codelineno-50-20" href="#__codelineno-50-20"></a>)
</span><span id="__span-50-21"><a id="__codelineno-50-21" name="__codelineno-50-21" href="#__codelineno-50-21"></a>
</span><span id="__span-50-22"><a id="__codelineno-50-22" name="__codelineno-50-22" href="#__codelineno-50-22"></a>result = tool_node.invoke({&quot;messages&quot;: [message]})
</span></code></pre></div>
<p><strong>Output:</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-51-1"><a id="__codelineno-51-1" name="__codelineno-51-1" href="#__codelineno-51-1"></a>{&#39;messages&#39;: [
</span><span id="__span-51-2"><a id="__codelineno-51-2" name="__codelineno-51-2" href="#__codelineno-51-2"></a>    ToolMessage(
</span><span id="__span-51-3"><a id="__codelineno-51-3" name="__codelineno-51-3" href="#__codelineno-51-3"></a>        content=&quot;Error: ValueError(&#39;The ultimate error&#39;)\n Please fix your mistakes.&quot;,
</span><span id="__span-51-4"><a id="__codelineno-51-4" name="__codelineno-51-4" href="#__codelineno-51-4"></a>        name=&#39;multiply&#39;,
</span><span id="__span-51-5"><a id="__codelineno-51-5" name="__codelineno-51-5" href="#__codelineno-51-5"></a>        tool_call_id=&#39;tool_call_id&#39;,
</span><span id="__span-51-6"><a id="__codelineno-51-6" name="__codelineno-51-6" href="#__codelineno-51-6"></a>        status=&#39;error&#39;
</span><span id="__span-51-7"><a id="__codelineno-51-7" name="__codelineno-51-7" href="#__codelineno-51-7"></a>    )
</span><span id="__span-51-8"><a id="__codelineno-51-8" name="__codelineno-51-8" href="#__codelineno-51-8"></a>]}
</span></code></pre></div>
<p><strong>Disable error handling</strong></p>
<p>To propagate exceptions directly, disable error handling:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-52-1"><a id="__codelineno-52-1" name="__codelineno-52-1" href="#__codelineno-52-1"></a>tool_node = ToolNode([multiply], handle_tool_errors=False)
</span></code></pre></div>
<p><strong>Example output:</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-53-1"><a id="__codelineno-53-1" name="__codelineno-53-1" href="#__codelineno-53-1"></a>{&#39;messages&#39;: [
</span><span id="__span-53-2"><a id="__codelineno-53-2" name="__codelineno-53-2" href="#__codelineno-53-2"></a>    ToolMessage(
</span><span id="__span-53-3"><a id="__codelineno-53-3" name="__codelineno-53-3" href="#__codelineno-53-3"></a>        content=&quot;Can&#39;t use 42 as the first operand, please switch operands!&quot;,
</span><span id="__span-53-4"><a id="__codelineno-53-4" name="__codelineno-53-4" href="#__codelineno-53-4"></a>        name=&#39;multiply&#39;,
</span><span id="__span-53-5"><a id="__codelineno-53-5" name="__codelineno-53-5" href="#__codelineno-53-5"></a>        tool_call_id=&#39;tool_call_id&#39;,
</span><span id="__span-53-6"><a id="__codelineno-53-6" name="__codelineno-53-6" href="#__codelineno-53-6"></a>        status=&#39;error&#39;
</span><span id="__span-53-7"><a id="__codelineno-53-7" name="__codelineno-53-7" href="#__codelineno-53-7"></a>    )
</span><span id="__span-53-8"><a id="__codelineno-53-8" name="__codelineno-53-8" href="#__codelineno-53-8"></a>]}
</span></code></pre></div>
<p><strong>Error handling in agents</strong></p>
<p>Error handling in prebuilt agents (<code>create_react_agent</code>) leverages <code>ToolNode</code>:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-54-1"><a id="__codelineno-54-1" name="__codelineno-54-1" href="#__codelineno-54-1"></a>from langgraph.prebuilt import create_react_agent
</span><span id="__span-54-2"><a id="__codelineno-54-2" name="__codelineno-54-2" href="#__codelineno-54-2"></a>
</span><span id="__span-54-3"><a id="__codelineno-54-3" name="__codelineno-54-3" href="#__codelineno-54-3"></a>agent = create_react_agent(
</span><span id="__span-54-4"><a id="__codelineno-54-4" name="__codelineno-54-4" href="#__codelineno-54-4"></a>    model=&quot;anthropic:claude-3-7-sonnet-latest&quot;,
</span><span id="__span-54-5"><a id="__codelineno-54-5" name="__codelineno-54-5" href="#__codelineno-54-5"></a>    tools=[multiply]
</span><span id="__span-54-6"><a id="__codelineno-54-6" name="__codelineno-54-6" href="#__codelineno-54-6"></a>)
</span><span id="__span-54-7"><a id="__codelineno-54-7" name="__codelineno-54-7" href="#__codelineno-54-7"></a>
</span><span id="__span-54-8"><a id="__codelineno-54-8" name="__codelineno-54-8" href="#__codelineno-54-8"></a># Default error handling
</span><span id="__span-54-9"><a id="__codelineno-54-9" name="__codelineno-54-9" href="#__codelineno-54-9"></a>agent.invoke({&quot;messages&quot;: [{&quot;role&quot;: &quot;user&quot;, &quot;content&quot;: &quot;what&#39;s 42 x 7?&quot;}]})
</span></code></pre></div>
<p>To disable or customize error handling in prebuilt agents, explicitly pass a configured ToolNode:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-55-1"><a id="__codelineno-55-1" name="__codelineno-55-1" href="#__codelineno-55-1"></a>custom_tool_node = ToolNode(
</span><span id="__span-55-2"><a id="__codelineno-55-2" name="__codelineno-55-2" href="#__codelineno-55-2"></a>    [multiply],
</span><span id="__span-55-3"><a id="__codelineno-55-3" name="__codelineno-55-3" href="#__codelineno-55-3"></a>    handle_tool_errors=&quot;Cannot use 42 as a first operand!&quot;
</span><span id="__span-55-4"><a id="__codelineno-55-4" name="__codelineno-55-4" href="#__codelineno-55-4"></a>)
</span><span id="__span-55-5"><a id="__codelineno-55-5" name="__codelineno-55-5" href="#__codelineno-55-5"></a>
</span><span id="__span-55-6"><a id="__codelineno-55-6" name="__codelineno-55-6" href="#__codelineno-55-6"></a>agent_custom = create_react_agent(
</span><span id="__span-55-7"><a id="__codelineno-55-7" name="__codelineno-55-7" href="#__codelineno-55-7"></a>    model=&quot;anthropic:claude-3-7-sonnet-latest&quot;,
</span><span id="__span-55-8"><a id="__codelineno-55-8" name="__codelineno-55-8" href="#__codelineno-55-8"></a>    tools=custom_tool_node
</span><span id="__span-55-9"><a id="__codelineno-55-9" name="__codelineno-55-9" href="#__codelineno-55-9"></a>)
</span><span id="__span-55-10"><a id="__codelineno-55-10" name="__codelineno-55-10" href="#__codelineno-55-10"></a>
</span><span id="__span-55-11"><a id="__codelineno-55-11" name="__codelineno-55-11" href="#__codelineno-55-11"></a>agent_custom.invoke({&quot;messages&quot;: [{&quot;role&quot;: &quot;user&quot;, &quot;content&quot;: &quot;what&#39;s 42 x 7?&quot;}]})
</span></code></pre></div>
<p><strong>Handle large numbers of tools</strong></p>
<p>As the number of available tools grows, you may want to limit the scope of the LLM's selection, to decrease token consumption and to help manage sources of error in LLM reasoning.</p>
<p>To address this, you can dynamically adjust the tools available to a model by retrieving relevant tools at runtime using semantic search.</p>
<h2 id="human-in-the-loop">Human-in-the-loop<a class="headerlink" href="#human-in-the-loop" title="Permanent link">#</a></h2>
<p>To review, edit, and approve tool calls in an agent or workflow, use LangGraph's human-in-the-loop features to enable human intervention at any point in a workflow. This is especially useful in large language model (LLM)-driven applications where model output may require validation, correction, or additional context.</p>
<p><img alt="alt text" src="../image/langgraph2.png" /></p>
<p><strong>Key capabilities</strong></p>
<ul>
<li><strong>Persistent execution state:</strong> Interrupts use LangGraph's persistence layer, which saves the graph state, to indefinitely pause graph execution until you resume. This is possible because LangGraph checkpoints the graph state after each step, which allows the system to persist execution context and later resume the workflow, continuing from where it left off. This supports asynchronous human review or input without time constraints.</li>
</ul>
<p><strong>There are two ways to pause a graph:</strong></p>
<ul>
<li>
<p><strong>Dynamic interrupts:</strong> Use interrupt to pause a graph from inside a specific node, based on the current state of the graph.</p>
</li>
<li>
<p><strong>Static interrupts:</strong> Use <code>interrupt_before</code> and <code>interrupt_after</code> to pause the graph at pre-defined points, either before or after a node executes.</p>
</li>
</ul>
<p><img alt="alt text" src="../image/langgraph3.png" /></p>
<ul>
<li><strong>Flexible integration points:</strong> Human-in-the-loop logic can be introduced at any point in the workflow. This allows targeted human involvement, such as approving API calls, correcting outputs, or guiding conversations.</li>
</ul>
<p><strong>Patterns</strong></p>
<p>There are four typical design patterns that you can implement using <code>interrupt</code> and <code>Command</code>:</p>
<ul>
<li>
<p><strong>Approve or reject:</strong> Pause the graph before a critical step, such as an API call, to review and approve the action. If the action is rejected, you can prevent the graph from executing the step, and potentially take an alternative action. This pattern often involves routing the graph based on the human's input.</p>
</li>
<li>
<p><strong>Edit graph state:</strong> Pause the graph to review and edit the graph state. This is useful for correcting mistakes or updating the state with additional information. This pattern often involves updating the state with the human's input.</p>
</li>
<li>
<p><strong>Review tool calls:</strong> Pause the graph to review and edit tool calls requested by the LLM before tool execution.</p>
</li>
<li>
<p><strong>Validate human input:</strong> Pause the graph to validate human input before proceeding with the next step.</p>
</li>
</ul>
<h2 id="enable-human-intervention">Enable human intervention<a class="headerlink" href="#enable-human-intervention" title="Permanent link">#</a></h2>
<p>To review, edit, and approve tool calls in an agent or workflow, use interrupts to pause a graph and wait for human input. Interrupts use LangGraph's <code>persistence</code> layer, which saves the graph state, to indefinitely pause graph execution until you resume.</p>
<p><strong>Pause using interrupt</strong></p>
<p><strong>Dynamic interrupts</strong> (also known as dynamic breakpoints) are triggered based on the current state of the graph. You can set dynamic interrupts by calling <strong>interrupt function</strong> in the appropriate place. The graph will pause, which allows for human intervention, and then resumes the graph with their input. It's useful for tasks like approvals, edits, or gathering additional context.</p>
<p>To use <code>interrupt</code> in your graph, you need to:</p>
<ol>
<li>
<p><strong>Specify a checkpointer</strong> to save the graph state after each step.</p>
</li>
<li>
<p><strong>Call</strong> <code>interrupt()</code> in the appropriate place. See the <strong>Common Patterns</strong> section for examples.</p>
</li>
<li>
<p><strong>Run the graph</strong> with a <strong>thread ID</strong> until the <code>interrupt</code> is hit.</p>
</li>
<li>
<p><strong>Resume execution</strong> using <code>invoke/stream</code></p>
</li>
</ol>
<div class="language-text highlight"><pre><span></span><code><span id="__span-56-1"><a id="__codelineno-56-1" name="__codelineno-56-1" href="#__codelineno-56-1"></a>from langgraph.types import interrupt, Command
</span><span id="__span-56-2"><a id="__codelineno-56-2" name="__codelineno-56-2" href="#__codelineno-56-2"></a>
</span><span id="__span-56-3"><a id="__codelineno-56-3" name="__codelineno-56-3" href="#__codelineno-56-3"></a>def human_node(state: State):
</span><span id="__span-56-4"><a id="__codelineno-56-4" name="__codelineno-56-4" href="#__codelineno-56-4"></a>    value = interrupt( 
</span><span id="__span-56-5"><a id="__codelineno-56-5" name="__codelineno-56-5" href="#__codelineno-56-5"></a>        {
</span><span id="__span-56-6"><a id="__codelineno-56-6" name="__codelineno-56-6" href="#__codelineno-56-6"></a>            &quot;text_to_revise&quot;: state[&quot;some_text&quot;] 
</span><span id="__span-56-7"><a id="__codelineno-56-7" name="__codelineno-56-7" href="#__codelineno-56-7"></a>        }
</span><span id="__span-56-8"><a id="__codelineno-56-8" name="__codelineno-56-8" href="#__codelineno-56-8"></a>    )
</span><span id="__span-56-9"><a id="__codelineno-56-9" name="__codelineno-56-9" href="#__codelineno-56-9"></a>    return {
</span><span id="__span-56-10"><a id="__codelineno-56-10" name="__codelineno-56-10" href="#__codelineno-56-10"></a>        &quot;some_text&quot;: value 
</span><span id="__span-56-11"><a id="__codelineno-56-11" name="__codelineno-56-11" href="#__codelineno-56-11"></a>    }
</span><span id="__span-56-12"><a id="__codelineno-56-12" name="__codelineno-56-12" href="#__codelineno-56-12"></a>
</span><span id="__span-56-13"><a id="__codelineno-56-13" name="__codelineno-56-13" href="#__codelineno-56-13"></a>
</span><span id="__span-56-14"><a id="__codelineno-56-14" name="__codelineno-56-14" href="#__codelineno-56-14"></a>graph = graph_builder.compile(checkpointer=checkpointer) 
</span><span id="__span-56-15"><a id="__codelineno-56-15" name="__codelineno-56-15" href="#__codelineno-56-15"></a>
</span><span id="__span-56-16"><a id="__codelineno-56-16" name="__codelineno-56-16" href="#__codelineno-56-16"></a># Run the graph until the interrupt is hit.
</span><span id="__span-56-17"><a id="__codelineno-56-17" name="__codelineno-56-17" href="#__codelineno-56-17"></a>config = {&quot;configurable&quot;: {&quot;thread_id&quot;: &quot;some_id&quot;}}
</span><span id="__span-56-18"><a id="__codelineno-56-18" name="__codelineno-56-18" href="#__codelineno-56-18"></a>result = graph.invoke({&quot;some_text&quot;: &quot;original text&quot;}, config=config) 
</span><span id="__span-56-19"><a id="__codelineno-56-19" name="__codelineno-56-19" href="#__codelineno-56-19"></a>print(result[&#39;__interrupt__&#39;]) 
</span><span id="__span-56-20"><a id="__codelineno-56-20" name="__codelineno-56-20" href="#__codelineno-56-20"></a># &gt; [
</span><span id="__span-56-21"><a id="__codelineno-56-21" name="__codelineno-56-21" href="#__codelineno-56-21"></a># &gt;    Interrupt(
</span><span id="__span-56-22"><a id="__codelineno-56-22" name="__codelineno-56-22" href="#__codelineno-56-22"></a># &gt;       value={&#39;text_to_revise&#39;: &#39;original text&#39;},
</span><span id="__span-56-23"><a id="__codelineno-56-23" name="__codelineno-56-23" href="#__codelineno-56-23"></a># &gt;       resumable=True,
</span><span id="__span-56-24"><a id="__codelineno-56-24" name="__codelineno-56-24" href="#__codelineno-56-24"></a># &gt;       ns=[&#39;human_node:6ce9e64f-edef-fe5d-f7dc-511fa9526960&#39;]
</span><span id="__span-56-25"><a id="__codelineno-56-25" name="__codelineno-56-25" href="#__codelineno-56-25"></a># &gt;    )
</span><span id="__span-56-26"><a id="__codelineno-56-26" name="__codelineno-56-26" href="#__codelineno-56-26"></a># &gt; ]
</span><span id="__span-56-27"><a id="__codelineno-56-27" name="__codelineno-56-27" href="#__codelineno-56-27"></a>
</span><span id="__span-56-28"><a id="__codelineno-56-28" name="__codelineno-56-28" href="#__codelineno-56-28"></a>print(graph.invoke(Command(resume=&quot;Edited text&quot;), config=config)) 
</span><span id="__span-56-29"><a id="__codelineno-56-29" name="__codelineno-56-29" href="#__codelineno-56-29"></a># &gt; {&#39;some_text&#39;: &#39;Edited text&#39;}
</span></code></pre></div>
<p><img alt="alt text" src="../image/langgraph4.png" /></p>
<p>When the interrupt function is used within a graph, execution pauses at that point and awaits user input.</p>
<p>To resume execution, use the Command primitive, which can be supplied via the invoke or stream methods. The graph resumes execution from the beginning of the node where interrupt(...) was initially called. This time, the interrupt function will return the value provided in Command(resume=value) rather than pausing again. All code from the beginning of the node to the interrupt will be re-executed.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-57-1"><a id="__codelineno-57-1" name="__codelineno-57-1" href="#__codelineno-57-1"></a># Resume graph execution by providing the user&#39;s input.
</span><span id="__span-57-2"><a id="__codelineno-57-2" name="__codelineno-57-2" href="#__codelineno-57-2"></a>graph.invoke(Command(resume={&quot;age&quot;: &quot;25&quot;}), thread_config)
</span></code></pre></div>
<p><strong>Resume multiple interrupts with one invocation</strong></p>
<p>When nodes with interrupt conditions are run in parallel, it's possible to have multiple interrupts in the task queue. For example, the following graph has two nodes run in parallel that require human input:</p>
<p><img alt="alt text" src="../image/langgraph5.png" /></p>
<p>Once your graph has been interrupted and is stalled, you can resume all the interrupts at once with Command.resume, passing a dictionary mapping of interrupt ids to resume values.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-58-1"><a id="__codelineno-58-1" name="__codelineno-58-1" href="#__codelineno-58-1"></a>from typing import TypedDict
</span><span id="__span-58-2"><a id="__codelineno-58-2" name="__codelineno-58-2" href="#__codelineno-58-2"></a>import uuid
</span><span id="__span-58-3"><a id="__codelineno-58-3" name="__codelineno-58-3" href="#__codelineno-58-3"></a>from langchain_core.runnables import RunnableConfig
</span><span id="__span-58-4"><a id="__codelineno-58-4" name="__codelineno-58-4" href="#__codelineno-58-4"></a>from langgraph.checkpoint.memory import InMemorySaver
</span><span id="__span-58-5"><a id="__codelineno-58-5" name="__codelineno-58-5" href="#__codelineno-58-5"></a>from langgraph.constants import START
</span><span id="__span-58-6"><a id="__codelineno-58-6" name="__codelineno-58-6" href="#__codelineno-58-6"></a>from langgraph.graph import StateGraph
</span><span id="__span-58-7"><a id="__codelineno-58-7" name="__codelineno-58-7" href="#__codelineno-58-7"></a>from langgraph.types import interrupt, Command
</span><span id="__span-58-8"><a id="__codelineno-58-8" name="__codelineno-58-8" href="#__codelineno-58-8"></a>
</span><span id="__span-58-9"><a id="__codelineno-58-9" name="__codelineno-58-9" href="#__codelineno-58-9"></a>
</span><span id="__span-58-10"><a id="__codelineno-58-10" name="__codelineno-58-10" href="#__codelineno-58-10"></a>class State(TypedDict):
</span><span id="__span-58-11"><a id="__codelineno-58-11" name="__codelineno-58-11" href="#__codelineno-58-11"></a>    text_1: str
</span><span id="__span-58-12"><a id="__codelineno-58-12" name="__codelineno-58-12" href="#__codelineno-58-12"></a>    text_2: str
</span><span id="__span-58-13"><a id="__codelineno-58-13" name="__codelineno-58-13" href="#__codelineno-58-13"></a>
</span><span id="__span-58-14"><a id="__codelineno-58-14" name="__codelineno-58-14" href="#__codelineno-58-14"></a>
</span><span id="__span-58-15"><a id="__codelineno-58-15" name="__codelineno-58-15" href="#__codelineno-58-15"></a>def human_node_1(state: State):
</span><span id="__span-58-16"><a id="__codelineno-58-16" name="__codelineno-58-16" href="#__codelineno-58-16"></a>    value = interrupt({&quot;text_to_revise&quot;: state[&quot;text_1&quot;]})
</span><span id="__span-58-17"><a id="__codelineno-58-17" name="__codelineno-58-17" href="#__codelineno-58-17"></a>    return {&quot;text_1&quot;: value}
</span><span id="__span-58-18"><a id="__codelineno-58-18" name="__codelineno-58-18" href="#__codelineno-58-18"></a>
</span><span id="__span-58-19"><a id="__codelineno-58-19" name="__codelineno-58-19" href="#__codelineno-58-19"></a>
</span><span id="__span-58-20"><a id="__codelineno-58-20" name="__codelineno-58-20" href="#__codelineno-58-20"></a>def human_node_2(state: State):
</span><span id="__span-58-21"><a id="__codelineno-58-21" name="__codelineno-58-21" href="#__codelineno-58-21"></a>    value = interrupt({&quot;text_to_revise&quot;: state[&quot;text_2&quot;]})
</span><span id="__span-58-22"><a id="__codelineno-58-22" name="__codelineno-58-22" href="#__codelineno-58-22"></a>    return {&quot;text_2&quot;: value}
</span><span id="__span-58-23"><a id="__codelineno-58-23" name="__codelineno-58-23" href="#__codelineno-58-23"></a>
</span><span id="__span-58-24"><a id="__codelineno-58-24" name="__codelineno-58-24" href="#__codelineno-58-24"></a>
</span><span id="__span-58-25"><a id="__codelineno-58-25" name="__codelineno-58-25" href="#__codelineno-58-25"></a>graph_builder = StateGraph(State)
</span><span id="__span-58-26"><a id="__codelineno-58-26" name="__codelineno-58-26" href="#__codelineno-58-26"></a>graph_builder.add_node(&quot;human_node_1&quot;, human_node_1)
</span><span id="__span-58-27"><a id="__codelineno-58-27" name="__codelineno-58-27" href="#__codelineno-58-27"></a>graph_builder.add_node(&quot;human_node_2&quot;, human_node_2)
</span><span id="__span-58-28"><a id="__codelineno-58-28" name="__codelineno-58-28" href="#__codelineno-58-28"></a>
</span><span id="__span-58-29"><a id="__codelineno-58-29" name="__codelineno-58-29" href="#__codelineno-58-29"></a># Add both nodes in parallel from START
</span><span id="__span-58-30"><a id="__codelineno-58-30" name="__codelineno-58-30" href="#__codelineno-58-30"></a>graph_builder.add_edge(START, &quot;human_node_1&quot;)
</span><span id="__span-58-31"><a id="__codelineno-58-31" name="__codelineno-58-31" href="#__codelineno-58-31"></a>graph_builder.add_edge(START, &quot;human_node_2&quot;)
</span><span id="__span-58-32"><a id="__codelineno-58-32" name="__codelineno-58-32" href="#__codelineno-58-32"></a>
</span><span id="__span-58-33"><a id="__codelineno-58-33" name="__codelineno-58-33" href="#__codelineno-58-33"></a>checkpointer = InMemorySaver()
</span><span id="__span-58-34"><a id="__codelineno-58-34" name="__codelineno-58-34" href="#__codelineno-58-34"></a>graph = graph_builder.compile(checkpointer=checkpointer)
</span><span id="__span-58-35"><a id="__codelineno-58-35" name="__codelineno-58-35" href="#__codelineno-58-35"></a>
</span><span id="__span-58-36"><a id="__codelineno-58-36" name="__codelineno-58-36" href="#__codelineno-58-36"></a>thread_id = str(uuid.uuid4())
</span><span id="__span-58-37"><a id="__codelineno-58-37" name="__codelineno-58-37" href="#__codelineno-58-37"></a>config: RunnableConfig = {&quot;configurable&quot;: {&quot;thread_id&quot;: thread_id}}
</span><span id="__span-58-38"><a id="__codelineno-58-38" name="__codelineno-58-38" href="#__codelineno-58-38"></a>result = graph.invoke(
</span><span id="__span-58-39"><a id="__codelineno-58-39" name="__codelineno-58-39" href="#__codelineno-58-39"></a>    {&quot;text_1&quot;: &quot;original text 1&quot;, &quot;text_2&quot;: &quot;original text 2&quot;}, config=config
</span><span id="__span-58-40"><a id="__codelineno-58-40" name="__codelineno-58-40" href="#__codelineno-58-40"></a>)
</span><span id="__span-58-41"><a id="__codelineno-58-41" name="__codelineno-58-41" href="#__codelineno-58-41"></a>
</span><span id="__span-58-42"><a id="__codelineno-58-42" name="__codelineno-58-42" href="#__codelineno-58-42"></a># Resume with mapping of interrupt IDs to values
</span><span id="__span-58-43"><a id="__codelineno-58-43" name="__codelineno-58-43" href="#__codelineno-58-43"></a>resume_map = {
</span><span id="__span-58-44"><a id="__codelineno-58-44" name="__codelineno-58-44" href="#__codelineno-58-44"></a>    i.id: f&quot;edited text for {i.value[&#39;text_to_revise&#39;]}&quot;
</span><span id="__span-58-45"><a id="__codelineno-58-45" name="__codelineno-58-45" href="#__codelineno-58-45"></a>    for i in graph.get_state(config).interrupts
</span><span id="__span-58-46"><a id="__codelineno-58-46" name="__codelineno-58-46" href="#__codelineno-58-46"></a>}
</span><span id="__span-58-47"><a id="__codelineno-58-47" name="__codelineno-58-47" href="#__codelineno-58-47"></a>print(graph.invoke(Command(resume=resume_map), config=config))
</span><span id="__span-58-48"><a id="__codelineno-58-48" name="__codelineno-58-48" href="#__codelineno-58-48"></a># &gt; {&#39;text_1&#39;: &#39;edited text for original text 1&#39;, &#39;text_2&#39;: &#39;edited text for original text 2&#39;}
</span></code></pre></div>
<p><strong>Common patterns</strong></p>
<p>Below we show different design patterns that can be implemented using interrupt and Command.</p>
<p><img alt="alt text" src="../image/langgraph6.png" /></p>
<p>Pause the graph before a critical step, such as an API call, to review and approve the action. If the action is rejected, you can prevent the graph from executing the step, and potentially take an alternative action.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-59-1"><a id="__codelineno-59-1" name="__codelineno-59-1" href="#__codelineno-59-1"></a>from typing import Literal
</span><span id="__span-59-2"><a id="__codelineno-59-2" name="__codelineno-59-2" href="#__codelineno-59-2"></a>from langgraph.types import interrupt, Command
</span><span id="__span-59-3"><a id="__codelineno-59-3" name="__codelineno-59-3" href="#__codelineno-59-3"></a>
</span><span id="__span-59-4"><a id="__codelineno-59-4" name="__codelineno-59-4" href="#__codelineno-59-4"></a>def human_approval(state: State) -&gt; Command[Literal[&quot;some_node&quot;, &quot;another_node&quot;]]:
</span><span id="__span-59-5"><a id="__codelineno-59-5" name="__codelineno-59-5" href="#__codelineno-59-5"></a>    is_approved = interrupt(
</span><span id="__span-59-6"><a id="__codelineno-59-6" name="__codelineno-59-6" href="#__codelineno-59-6"></a>        {
</span><span id="__span-59-7"><a id="__codelineno-59-7" name="__codelineno-59-7" href="#__codelineno-59-7"></a>            &quot;question&quot;: &quot;Is this correct?&quot;,
</span><span id="__span-59-8"><a id="__codelineno-59-8" name="__codelineno-59-8" href="#__codelineno-59-8"></a>            # Surface the output that should be
</span><span id="__span-59-9"><a id="__codelineno-59-9" name="__codelineno-59-9" href="#__codelineno-59-9"></a>            # reviewed and approved by the human.
</span><span id="__span-59-10"><a id="__codelineno-59-10" name="__codelineno-59-10" href="#__codelineno-59-10"></a>            &quot;llm_output&quot;: state[&quot;llm_output&quot;]
</span><span id="__span-59-11"><a id="__codelineno-59-11" name="__codelineno-59-11" href="#__codelineno-59-11"></a>        }
</span><span id="__span-59-12"><a id="__codelineno-59-12" name="__codelineno-59-12" href="#__codelineno-59-12"></a>    )
</span><span id="__span-59-13"><a id="__codelineno-59-13" name="__codelineno-59-13" href="#__codelineno-59-13"></a>
</span><span id="__span-59-14"><a id="__codelineno-59-14" name="__codelineno-59-14" href="#__codelineno-59-14"></a>    if is_approved:
</span><span id="__span-59-15"><a id="__codelineno-59-15" name="__codelineno-59-15" href="#__codelineno-59-15"></a>        return Command(goto=&quot;some_node&quot;)
</span><span id="__span-59-16"><a id="__codelineno-59-16" name="__codelineno-59-16" href="#__codelineno-59-16"></a>    else:
</span><span id="__span-59-17"><a id="__codelineno-59-17" name="__codelineno-59-17" href="#__codelineno-59-17"></a>        return Command(goto=&quot;another_node&quot;)
</span><span id="__span-59-18"><a id="__codelineno-59-18" name="__codelineno-59-18" href="#__codelineno-59-18"></a>
</span><span id="__span-59-19"><a id="__codelineno-59-19" name="__codelineno-59-19" href="#__codelineno-59-19"></a># Add the node to the graph in an appropriate location
</span><span id="__span-59-20"><a id="__codelineno-59-20" name="__codelineno-59-20" href="#__codelineno-59-20"></a># and connect it to the relevant nodes.
</span><span id="__span-59-21"><a id="__codelineno-59-21" name="__codelineno-59-21" href="#__codelineno-59-21"></a>graph_builder.add_node(&quot;human_approval&quot;, human_approval)
</span><span id="__span-59-22"><a id="__codelineno-59-22" name="__codelineno-59-22" href="#__codelineno-59-22"></a>graph = graph_builder.compile(checkpointer=checkpointer)
</span><span id="__span-59-23"><a id="__codelineno-59-23" name="__codelineno-59-23" href="#__codelineno-59-23"></a>
</span><span id="__span-59-24"><a id="__codelineno-59-24" name="__codelineno-59-24" href="#__codelineno-59-24"></a># After running the graph and hitting the interrupt, the graph will pause.
</span><span id="__span-59-25"><a id="__codelineno-59-25" name="__codelineno-59-25" href="#__codelineno-59-25"></a># Resume it with either an approval or rejection.
</span><span id="__span-59-26"><a id="__codelineno-59-26" name="__codelineno-59-26" href="#__codelineno-59-26"></a>thread_config = {&quot;configurable&quot;: {&quot;thread_id&quot;: &quot;some_id&quot;}}
</span><span id="__span-59-27"><a id="__codelineno-59-27" name="__codelineno-59-27" href="#__codelineno-59-27"></a>graph.invoke(Command(resume=True), config=thread_config)
</span></code></pre></div>
<p><img alt="alt text" src="./image/langgraph7.png" /></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-60-1"><a id="__codelineno-60-1" name="__codelineno-60-1" href="#__codelineno-60-1"></a>from langgraph.types import interrupt
</span><span id="__span-60-2"><a id="__codelineno-60-2" name="__codelineno-60-2" href="#__codelineno-60-2"></a>
</span><span id="__span-60-3"><a id="__codelineno-60-3" name="__codelineno-60-3" href="#__codelineno-60-3"></a>def human_editing(state: State):
</span><span id="__span-60-4"><a id="__codelineno-60-4" name="__codelineno-60-4" href="#__codelineno-60-4"></a>    ...
</span><span id="__span-60-5"><a id="__codelineno-60-5" name="__codelineno-60-5" href="#__codelineno-60-5"></a>    result = interrupt(
</span><span id="__span-60-6"><a id="__codelineno-60-6" name="__codelineno-60-6" href="#__codelineno-60-6"></a>        # Interrupt information to surface to the client.
</span><span id="__span-60-7"><a id="__codelineno-60-7" name="__codelineno-60-7" href="#__codelineno-60-7"></a>        # Can be any JSON serializable value.
</span><span id="__span-60-8"><a id="__codelineno-60-8" name="__codelineno-60-8" href="#__codelineno-60-8"></a>        {
</span><span id="__span-60-9"><a id="__codelineno-60-9" name="__codelineno-60-9" href="#__codelineno-60-9"></a>            &quot;task&quot;: &quot;Review the output from the LLM and make any necessary edits.&quot;,
</span><span id="__span-60-10"><a id="__codelineno-60-10" name="__codelineno-60-10" href="#__codelineno-60-10"></a>            &quot;llm_generated_summary&quot;: state[&quot;llm_generated_summary&quot;]
</span><span id="__span-60-11"><a id="__codelineno-60-11" name="__codelineno-60-11" href="#__codelineno-60-11"></a>        }
</span><span id="__span-60-12"><a id="__codelineno-60-12" name="__codelineno-60-12" href="#__codelineno-60-12"></a>    )
</span><span id="__span-60-13"><a id="__codelineno-60-13" name="__codelineno-60-13" href="#__codelineno-60-13"></a>
</span><span id="__span-60-14"><a id="__codelineno-60-14" name="__codelineno-60-14" href="#__codelineno-60-14"></a>    # Update the state with the edited text
</span><span id="__span-60-15"><a id="__codelineno-60-15" name="__codelineno-60-15" href="#__codelineno-60-15"></a>    return {
</span><span id="__span-60-16"><a id="__codelineno-60-16" name="__codelineno-60-16" href="#__codelineno-60-16"></a>        &quot;llm_generated_summary&quot;: result[&quot;edited_text&quot;]
</span><span id="__span-60-17"><a id="__codelineno-60-17" name="__codelineno-60-17" href="#__codelineno-60-17"></a>    }
</span><span id="__span-60-18"><a id="__codelineno-60-18" name="__codelineno-60-18" href="#__codelineno-60-18"></a>
</span><span id="__span-60-19"><a id="__codelineno-60-19" name="__codelineno-60-19" href="#__codelineno-60-19"></a># Add the node to the graph in an appropriate location
</span><span id="__span-60-20"><a id="__codelineno-60-20" name="__codelineno-60-20" href="#__codelineno-60-20"></a># and connect it to the relevant nodes.
</span><span id="__span-60-21"><a id="__codelineno-60-21" name="__codelineno-60-21" href="#__codelineno-60-21"></a>graph_builder.add_node(&quot;human_editing&quot;, human_editing)
</span><span id="__span-60-22"><a id="__codelineno-60-22" name="__codelineno-60-22" href="#__codelineno-60-22"></a>graph = graph_builder.compile(checkpointer=checkpointer)
</span><span id="__span-60-23"><a id="__codelineno-60-23" name="__codelineno-60-23" href="#__codelineno-60-23"></a>
</span><span id="__span-60-24"><a id="__codelineno-60-24" name="__codelineno-60-24" href="#__codelineno-60-24"></a>...
</span><span id="__span-60-25"><a id="__codelineno-60-25" name="__codelineno-60-25" href="#__codelineno-60-25"></a>
</span><span id="__span-60-26"><a id="__codelineno-60-26" name="__codelineno-60-26" href="#__codelineno-60-26"></a># After running the graph and hitting the interrupt, the graph will pause.
</span><span id="__span-60-27"><a id="__codelineno-60-27" name="__codelineno-60-27" href="#__codelineno-60-27"></a># Resume it with the edited text.
</span><span id="__span-60-28"><a id="__codelineno-60-28" name="__codelineno-60-28" href="#__codelineno-60-28"></a>thread_config = {&quot;configurable&quot;: {&quot;thread_id&quot;: &quot;some_id&quot;}}
</span><span id="__span-60-29"><a id="__codelineno-60-29" name="__codelineno-60-29" href="#__codelineno-60-29"></a>graph.invoke(
</span><span id="__span-60-30"><a id="__codelineno-60-30" name="__codelineno-60-30" href="#__codelineno-60-30"></a>    Command(resume={&quot;edited_text&quot;: &quot;The edited text&quot;}),
</span><span id="__span-60-31"><a id="__codelineno-60-31" name="__codelineno-60-31" href="#__codelineno-60-31"></a>    config=thread_config
</span><span id="__span-60-32"><a id="__codelineno-60-32" name="__codelineno-60-32" href="#__codelineno-60-32"></a>)
</span></code></pre></div>
<p><img alt="alt text" src="./image/langgraph8.png" /></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-61-1"><a id="__codelineno-61-1" name="__codelineno-61-1" href="#__codelineno-61-1"></a>from langgraph.checkpoint.memory import InMemorySaver
</span><span id="__span-61-2"><a id="__codelineno-61-2" name="__codelineno-61-2" href="#__codelineno-61-2"></a>from langgraph.types import interrupt
</span><span id="__span-61-3"><a id="__codelineno-61-3" name="__codelineno-61-3" href="#__codelineno-61-3"></a>from langgraph.prebuilt import create_react_agent
</span><span id="__span-61-4"><a id="__codelineno-61-4" name="__codelineno-61-4" href="#__codelineno-61-4"></a>
</span><span id="__span-61-5"><a id="__codelineno-61-5" name="__codelineno-61-5" href="#__codelineno-61-5"></a># An example of a sensitive tool that requires human review / approval
</span><span id="__span-61-6"><a id="__codelineno-61-6" name="__codelineno-61-6" href="#__codelineno-61-6"></a>def book_hotel(hotel_name: str):
</span><span id="__span-61-7"><a id="__codelineno-61-7" name="__codelineno-61-7" href="#__codelineno-61-7"></a>    &quot;&quot;&quot;Book a hotel&quot;&quot;&quot;
</span><span id="__span-61-8"><a id="__codelineno-61-8" name="__codelineno-61-8" href="#__codelineno-61-8"></a>    response = interrupt(  
</span><span id="__span-61-9"><a id="__codelineno-61-9" name="__codelineno-61-9" href="#__codelineno-61-9"></a>        f&quot;Trying to call `book_hotel` with args {{&#39;hotel_name&#39;: {hotel_name}}}. &quot;
</span><span id="__span-61-10"><a id="__codelineno-61-10" name="__codelineno-61-10" href="#__codelineno-61-10"></a>        &quot;Please approve or suggest edits.&quot;
</span><span id="__span-61-11"><a id="__codelineno-61-11" name="__codelineno-61-11" href="#__codelineno-61-11"></a>    )
</span><span id="__span-61-12"><a id="__codelineno-61-12" name="__codelineno-61-12" href="#__codelineno-61-12"></a>    if response[&quot;type&quot;] == &quot;accept&quot;:
</span><span id="__span-61-13"><a id="__codelineno-61-13" name="__codelineno-61-13" href="#__codelineno-61-13"></a>        pass
</span><span id="__span-61-14"><a id="__codelineno-61-14" name="__codelineno-61-14" href="#__codelineno-61-14"></a>    elif response[&quot;type&quot;] == &quot;edit&quot;:
</span><span id="__span-61-15"><a id="__codelineno-61-15" name="__codelineno-61-15" href="#__codelineno-61-15"></a>        hotel_name = response[&quot;args&quot;][&quot;hotel_name&quot;]
</span><span id="__span-61-16"><a id="__codelineno-61-16" name="__codelineno-61-16" href="#__codelineno-61-16"></a>    else:
</span><span id="__span-61-17"><a id="__codelineno-61-17" name="__codelineno-61-17" href="#__codelineno-61-17"></a>        raise ValueError(f&quot;Unknown response type: {response[&#39;type&#39;]}&quot;)
</span><span id="__span-61-18"><a id="__codelineno-61-18" name="__codelineno-61-18" href="#__codelineno-61-18"></a>    return f&quot;Successfully booked a stay at {hotel_name}.&quot;
</span><span id="__span-61-19"><a id="__codelineno-61-19" name="__codelineno-61-19" href="#__codelineno-61-19"></a>
</span><span id="__span-61-20"><a id="__codelineno-61-20" name="__codelineno-61-20" href="#__codelineno-61-20"></a>checkpointer = InMemorySaver() 
</span><span id="__span-61-21"><a id="__codelineno-61-21" name="__codelineno-61-21" href="#__codelineno-61-21"></a>
</span><span id="__span-61-22"><a id="__codelineno-61-22" name="__codelineno-61-22" href="#__codelineno-61-22"></a>agent = create_react_agent(
</span><span id="__span-61-23"><a id="__codelineno-61-23" name="__codelineno-61-23" href="#__codelineno-61-23"></a>    model=&quot;anthropic:claude-3-5-sonnet-latest&quot;,
</span><span id="__span-61-24"><a id="__codelineno-61-24" name="__codelineno-61-24" href="#__codelineno-61-24"></a>    tools=[book_hotel],
</span><span id="__span-61-25"><a id="__codelineno-61-25" name="__codelineno-61-25" href="#__codelineno-61-25"></a>    checkpointer=checkpointer, 
</span><span id="__span-61-26"><a id="__codelineno-61-26" name="__codelineno-61-26" href="#__codelineno-61-26"></a>)
</span></code></pre></div>
<p>Run the agent with the stream() method, passing the config object to specify the thread ID. This allows the agent to resume the same conversation on future invocations.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-62-1"><a id="__codelineno-62-1" name="__codelineno-62-1" href="#__codelineno-62-1"></a>config = {
</span><span id="__span-62-2"><a id="__codelineno-62-2" name="__codelineno-62-2" href="#__codelineno-62-2"></a>   &quot;configurable&quot;: {
</span><span id="__span-62-3"><a id="__codelineno-62-3" name="__codelineno-62-3" href="#__codelineno-62-3"></a>      &quot;thread_id&quot;: &quot;1&quot;
</span><span id="__span-62-4"><a id="__codelineno-62-4" name="__codelineno-62-4" href="#__codelineno-62-4"></a>   }
</span><span id="__span-62-5"><a id="__codelineno-62-5" name="__codelineno-62-5" href="#__codelineno-62-5"></a>}
</span><span id="__span-62-6"><a id="__codelineno-62-6" name="__codelineno-62-6" href="#__codelineno-62-6"></a>
</span><span id="__span-62-7"><a id="__codelineno-62-7" name="__codelineno-62-7" href="#__codelineno-62-7"></a>for chunk in agent.stream(
</span><span id="__span-62-8"><a id="__codelineno-62-8" name="__codelineno-62-8" href="#__codelineno-62-8"></a>    {&quot;messages&quot;: [{&quot;role&quot;: &quot;user&quot;, &quot;content&quot;: &quot;book a stay at McKittrick hotel&quot;}]},
</span><span id="__span-62-9"><a id="__codelineno-62-9" name="__codelineno-62-9" href="#__codelineno-62-9"></a>    config
</span><span id="__span-62-10"><a id="__codelineno-62-10" name="__codelineno-62-10" href="#__codelineno-62-10"></a>):
</span><span id="__span-62-11"><a id="__codelineno-62-11" name="__codelineno-62-11" href="#__codelineno-62-11"></a>    print(chunk)
</span><span id="__span-62-12"><a id="__codelineno-62-12" name="__codelineno-62-12" href="#__codelineno-62-12"></a>    print(&quot;\n&quot;)
</span></code></pre></div>
<p><code>You should see that the agent runs until it reaches the interrupt() call, at which point it pauses and waits for human input.</code></p>
<p>Resume the agent with a Command to continue based on human input.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-63-1"><a id="__codelineno-63-1" name="__codelineno-63-1" href="#__codelineno-63-1"></a>from langgraph.types import Command
</span><span id="__span-63-2"><a id="__codelineno-63-2" name="__codelineno-63-2" href="#__codelineno-63-2"></a>
</span><span id="__span-63-3"><a id="__codelineno-63-3" name="__codelineno-63-3" href="#__codelineno-63-3"></a>for chunk in agent.stream(
</span><span id="__span-63-4"><a id="__codelineno-63-4" name="__codelineno-63-4" href="#__codelineno-63-4"></a>    Command(resume={&quot;type&quot;: &quot;accept&quot;}),  
</span><span id="__span-63-5"><a id="__codelineno-63-5" name="__codelineno-63-5" href="#__codelineno-63-5"></a>    # Command(resume={&quot;type&quot;: &quot;edit&quot;, &quot;args&quot;: {&quot;hotel_name&quot;: &quot;McKittrick Hotel&quot;}}),
</span><span id="__span-63-6"><a id="__codelineno-63-6" name="__codelineno-63-6" href="#__codelineno-63-6"></a>    config
</span><span id="__span-63-7"><a id="__codelineno-63-7" name="__codelineno-63-7" href="#__codelineno-63-7"></a>):
</span><span id="__span-63-8"><a id="__codelineno-63-8" name="__codelineno-63-8" href="#__codelineno-63-8"></a>    print(chunk)
</span><span id="__span-63-9"><a id="__codelineno-63-9" name="__codelineno-63-9" href="#__codelineno-63-9"></a>    print(&quot;\n&quot;)
</span></code></pre></div>
<p><strong>Add interrupts to any tool</strong></p>
<p>You can create a wrapper to add interrupts to any tool. The example below provides a reference implementation compatible with Agent Inbox UI and Agent Chat UI.</p>
<p><strong>Wrapper that adds human-in-the-loop to any tool</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-64-1"><a id="__codelineno-64-1" name="__codelineno-64-1" href="#__codelineno-64-1"></a>from typing import Callable
</span><span id="__span-64-2"><a id="__codelineno-64-2" name="__codelineno-64-2" href="#__codelineno-64-2"></a>from langchain_core.tools import BaseTool, tool as create_tool
</span><span id="__span-64-3"><a id="__codelineno-64-3" name="__codelineno-64-3" href="#__codelineno-64-3"></a>from langchain_core.runnables import RunnableConfig
</span><span id="__span-64-4"><a id="__codelineno-64-4" name="__codelineno-64-4" href="#__codelineno-64-4"></a>from langgraph.types import interrupt
</span><span id="__span-64-5"><a id="__codelineno-64-5" name="__codelineno-64-5" href="#__codelineno-64-5"></a>from langgraph.prebuilt.interrupt import HumanInterruptConfig, HumanInterrupt
</span><span id="__span-64-6"><a id="__codelineno-64-6" name="__codelineno-64-6" href="#__codelineno-64-6"></a>
</span><span id="__span-64-7"><a id="__codelineno-64-7" name="__codelineno-64-7" href="#__codelineno-64-7"></a>def add_human_in_the_loop(
</span><span id="__span-64-8"><a id="__codelineno-64-8" name="__codelineno-64-8" href="#__codelineno-64-8"></a>    tool: Callable | BaseTool,
</span><span id="__span-64-9"><a id="__codelineno-64-9" name="__codelineno-64-9" href="#__codelineno-64-9"></a>    *,
</span><span id="__span-64-10"><a id="__codelineno-64-10" name="__codelineno-64-10" href="#__codelineno-64-10"></a>    interrupt_config: HumanInterruptConfig = None,
</span><span id="__span-64-11"><a id="__codelineno-64-11" name="__codelineno-64-11" href="#__codelineno-64-11"></a>) -&gt; BaseTool:
</span><span id="__span-64-12"><a id="__codelineno-64-12" name="__codelineno-64-12" href="#__codelineno-64-12"></a>    &quot;&quot;&quot;Wrap a tool to support human-in-the-loop review.&quot;&quot;&quot;
</span><span id="__span-64-13"><a id="__codelineno-64-13" name="__codelineno-64-13" href="#__codelineno-64-13"></a>    if not isinstance(tool, BaseTool):
</span><span id="__span-64-14"><a id="__codelineno-64-14" name="__codelineno-64-14" href="#__codelineno-64-14"></a>        tool = create_tool(tool)
</span><span id="__span-64-15"><a id="__codelineno-64-15" name="__codelineno-64-15" href="#__codelineno-64-15"></a>
</span><span id="__span-64-16"><a id="__codelineno-64-16" name="__codelineno-64-16" href="#__codelineno-64-16"></a>    if interrupt_config is None:
</span><span id="__span-64-17"><a id="__codelineno-64-17" name="__codelineno-64-17" href="#__codelineno-64-17"></a>        interrupt_config = {
</span><span id="__span-64-18"><a id="__codelineno-64-18" name="__codelineno-64-18" href="#__codelineno-64-18"></a>            &quot;allow_accept&quot;: True,
</span><span id="__span-64-19"><a id="__codelineno-64-19" name="__codelineno-64-19" href="#__codelineno-64-19"></a>            &quot;allow_edit&quot;: True,
</span><span id="__span-64-20"><a id="__codelineno-64-20" name="__codelineno-64-20" href="#__codelineno-64-20"></a>            &quot;allow_respond&quot;: True,
</span><span id="__span-64-21"><a id="__codelineno-64-21" name="__codelineno-64-21" href="#__codelineno-64-21"></a>        }
</span><span id="__span-64-22"><a id="__codelineno-64-22" name="__codelineno-64-22" href="#__codelineno-64-22"></a>
</span><span id="__span-64-23"><a id="__codelineno-64-23" name="__codelineno-64-23" href="#__codelineno-64-23"></a>    @create_tool(  
</span><span id="__span-64-24"><a id="__codelineno-64-24" name="__codelineno-64-24" href="#__codelineno-64-24"></a>        tool.name,
</span><span id="__span-64-25"><a id="__codelineno-64-25" name="__codelineno-64-25" href="#__codelineno-64-25"></a>        description=tool.description,
</span><span id="__span-64-26"><a id="__codelineno-64-26" name="__codelineno-64-26" href="#__codelineno-64-26"></a>        args_schema=tool.args_schema
</span><span id="__span-64-27"><a id="__codelineno-64-27" name="__codelineno-64-27" href="#__codelineno-64-27"></a>    )
</span><span id="__span-64-28"><a id="__codelineno-64-28" name="__codelineno-64-28" href="#__codelineno-64-28"></a>    def call_tool_with_interrupt(config: RunnableConfig, **tool_input):
</span><span id="__span-64-29"><a id="__codelineno-64-29" name="__codelineno-64-29" href="#__codelineno-64-29"></a>        request: HumanInterrupt = {
</span><span id="__span-64-30"><a id="__codelineno-64-30" name="__codelineno-64-30" href="#__codelineno-64-30"></a>            &quot;action_request&quot;: {
</span><span id="__span-64-31"><a id="__codelineno-64-31" name="__codelineno-64-31" href="#__codelineno-64-31"></a>                &quot;action&quot;: tool.name,
</span><span id="__span-64-32"><a id="__codelineno-64-32" name="__codelineno-64-32" href="#__codelineno-64-32"></a>                &quot;args&quot;: tool_input
</span><span id="__span-64-33"><a id="__codelineno-64-33" name="__codelineno-64-33" href="#__codelineno-64-33"></a>            },
</span><span id="__span-64-34"><a id="__codelineno-64-34" name="__codelineno-64-34" href="#__codelineno-64-34"></a>            &quot;config&quot;: interrupt_config,
</span><span id="__span-64-35"><a id="__codelineno-64-35" name="__codelineno-64-35" href="#__codelineno-64-35"></a>            &quot;description&quot;: &quot;Please review the tool call&quot;
</span><span id="__span-64-36"><a id="__codelineno-64-36" name="__codelineno-64-36" href="#__codelineno-64-36"></a>        }
</span><span id="__span-64-37"><a id="__codelineno-64-37" name="__codelineno-64-37" href="#__codelineno-64-37"></a>        response = interrupt([request])[0]  
</span><span id="__span-64-38"><a id="__codelineno-64-38" name="__codelineno-64-38" href="#__codelineno-64-38"></a>        # approve the tool call
</span><span id="__span-64-39"><a id="__codelineno-64-39" name="__codelineno-64-39" href="#__codelineno-64-39"></a>        if response[&quot;type&quot;] == &quot;accept&quot;:
</span><span id="__span-64-40"><a id="__codelineno-64-40" name="__codelineno-64-40" href="#__codelineno-64-40"></a>            tool_response = tool.invoke(tool_input, config)
</span><span id="__span-64-41"><a id="__codelineno-64-41" name="__codelineno-64-41" href="#__codelineno-64-41"></a>        # update tool call args
</span><span id="__span-64-42"><a id="__codelineno-64-42" name="__codelineno-64-42" href="#__codelineno-64-42"></a>        elif response[&quot;type&quot;] == &quot;edit&quot;:
</span><span id="__span-64-43"><a id="__codelineno-64-43" name="__codelineno-64-43" href="#__codelineno-64-43"></a>            tool_input = response[&quot;args&quot;][&quot;args&quot;]
</span><span id="__span-64-44"><a id="__codelineno-64-44" name="__codelineno-64-44" href="#__codelineno-64-44"></a>            tool_response = tool.invoke(tool_input, config)
</span><span id="__span-64-45"><a id="__codelineno-64-45" name="__codelineno-64-45" href="#__codelineno-64-45"></a>        # respond to the LLM with user feedback
</span><span id="__span-64-46"><a id="__codelineno-64-46" name="__codelineno-64-46" href="#__codelineno-64-46"></a>        elif response[&quot;type&quot;] == &quot;response&quot;:
</span><span id="__span-64-47"><a id="__codelineno-64-47" name="__codelineno-64-47" href="#__codelineno-64-47"></a>            user_feedback = response[&quot;args&quot;]
</span><span id="__span-64-48"><a id="__codelineno-64-48" name="__codelineno-64-48" href="#__codelineno-64-48"></a>            tool_response = user_feedback
</span><span id="__span-64-49"><a id="__codelineno-64-49" name="__codelineno-64-49" href="#__codelineno-64-49"></a>        else:
</span><span id="__span-64-50"><a id="__codelineno-64-50" name="__codelineno-64-50" href="#__codelineno-64-50"></a>            raise ValueError(f&quot;Unsupported interrupt response type: {response[&#39;type&#39;]}&quot;)
</span><span id="__span-64-51"><a id="__codelineno-64-51" name="__codelineno-64-51" href="#__codelineno-64-51"></a>
</span><span id="__span-64-52"><a id="__codelineno-64-52" name="__codelineno-64-52" href="#__codelineno-64-52"></a>        return tool_response
</span><span id="__span-64-53"><a id="__codelineno-64-53" name="__codelineno-64-53" href="#__codelineno-64-53"></a>
</span><span id="__span-64-54"><a id="__codelineno-64-54" name="__codelineno-64-54" href="#__codelineno-64-54"></a>    return call_tool_with_interrupt
</span></code></pre></div>
<p>You can use the wrapper to add interrupt() to any tool without having to add it inside the tool:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-65-1"><a id="__codelineno-65-1" name="__codelineno-65-1" href="#__codelineno-65-1"></a>from langgraph.checkpoint.memory import InMemorySaver
</span><span id="__span-65-2"><a id="__codelineno-65-2" name="__codelineno-65-2" href="#__codelineno-65-2"></a>from langgraph.prebuilt import create_react_agent
</span><span id="__span-65-3"><a id="__codelineno-65-3" name="__codelineno-65-3" href="#__codelineno-65-3"></a>
</span><span id="__span-65-4"><a id="__codelineno-65-4" name="__codelineno-65-4" href="#__codelineno-65-4"></a>checkpointer = InMemorySaver()
</span><span id="__span-65-5"><a id="__codelineno-65-5" name="__codelineno-65-5" href="#__codelineno-65-5"></a>
</span><span id="__span-65-6"><a id="__codelineno-65-6" name="__codelineno-65-6" href="#__codelineno-65-6"></a>def book_hotel(hotel_name: str):
</span><span id="__span-65-7"><a id="__codelineno-65-7" name="__codelineno-65-7" href="#__codelineno-65-7"></a>   &quot;&quot;&quot;Book a hotel&quot;&quot;&quot;
</span><span id="__span-65-8"><a id="__codelineno-65-8" name="__codelineno-65-8" href="#__codelineno-65-8"></a>   return f&quot;Successfully booked a stay at {hotel_name}.&quot;
</span><span id="__span-65-9"><a id="__codelineno-65-9" name="__codelineno-65-9" href="#__codelineno-65-9"></a>
</span><span id="__span-65-10"><a id="__codelineno-65-10" name="__codelineno-65-10" href="#__codelineno-65-10"></a>
</span><span id="__span-65-11"><a id="__codelineno-65-11" name="__codelineno-65-11" href="#__codelineno-65-11"></a>agent = create_react_agent(
</span><span id="__span-65-12"><a id="__codelineno-65-12" name="__codelineno-65-12" href="#__codelineno-65-12"></a>    model=&quot;anthropic:claude-3-5-sonnet-latest&quot;,
</span><span id="__span-65-13"><a id="__codelineno-65-13" name="__codelineno-65-13" href="#__codelineno-65-13"></a>    tools=[
</span><span id="__span-65-14"><a id="__codelineno-65-14" name="__codelineno-65-14" href="#__codelineno-65-14"></a>        add_human_in_the_loop(book_hotel), 
</span><span id="__span-65-15"><a id="__codelineno-65-15" name="__codelineno-65-15" href="#__codelineno-65-15"></a>    ],
</span><span id="__span-65-16"><a id="__codelineno-65-16" name="__codelineno-65-16" href="#__codelineno-65-16"></a>    checkpointer=checkpointer,
</span><span id="__span-65-17"><a id="__codelineno-65-17" name="__codelineno-65-17" href="#__codelineno-65-17"></a>)
</span><span id="__span-65-18"><a id="__codelineno-65-18" name="__codelineno-65-18" href="#__codelineno-65-18"></a>
</span><span id="__span-65-19"><a id="__codelineno-65-19" name="__codelineno-65-19" href="#__codelineno-65-19"></a>config = {&quot;configurable&quot;: {&quot;thread_id&quot;: &quot;1&quot;}}
</span><span id="__span-65-20"><a id="__codelineno-65-20" name="__codelineno-65-20" href="#__codelineno-65-20"></a>
</span><span id="__span-65-21"><a id="__codelineno-65-21" name="__codelineno-65-21" href="#__codelineno-65-21"></a># Run the agent
</span><span id="__span-65-22"><a id="__codelineno-65-22" name="__codelineno-65-22" href="#__codelineno-65-22"></a>for chunk in agent.stream(
</span><span id="__span-65-23"><a id="__codelineno-65-23" name="__codelineno-65-23" href="#__codelineno-65-23"></a>    {&quot;messages&quot;: [{&quot;role&quot;: &quot;user&quot;, &quot;content&quot;: &quot;book a stay at McKittrick hotel&quot;}]},
</span><span id="__span-65-24"><a id="__codelineno-65-24" name="__codelineno-65-24" href="#__codelineno-65-24"></a>    config
</span><span id="__span-65-25"><a id="__codelineno-65-25" name="__codelineno-65-25" href="#__codelineno-65-25"></a>):
</span><span id="__span-65-26"><a id="__codelineno-65-26" name="__codelineno-65-26" href="#__codelineno-65-26"></a>    print(chunk)
</span><span id="__span-65-27"><a id="__codelineno-65-27" name="__codelineno-65-27" href="#__codelineno-65-27"></a>    print(&quot;\n&quot;)
</span></code></pre></div>
<p><strong>Validate human input</strong></p>
<p>If you need to validate the input provided by the human within the graph itself (rather than on the client side), you can achieve this by using multiple interrupt calls within a single node.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-66-1"><a id="__codelineno-66-1" name="__codelineno-66-1" href="#__codelineno-66-1"></a>from langgraph.types import interrupt
</span><span id="__span-66-2"><a id="__codelineno-66-2" name="__codelineno-66-2" href="#__codelineno-66-2"></a>
</span><span id="__span-66-3"><a id="__codelineno-66-3" name="__codelineno-66-3" href="#__codelineno-66-3"></a>def human_node(state: State):
</span><span id="__span-66-4"><a id="__codelineno-66-4" name="__codelineno-66-4" href="#__codelineno-66-4"></a>    &quot;&quot;&quot;Human node with validation.&quot;&quot;&quot;
</span><span id="__span-66-5"><a id="__codelineno-66-5" name="__codelineno-66-5" href="#__codelineno-66-5"></a>    question = &quot;What is your age?&quot;
</span><span id="__span-66-6"><a id="__codelineno-66-6" name="__codelineno-66-6" href="#__codelineno-66-6"></a>
</span><span id="__span-66-7"><a id="__codelineno-66-7" name="__codelineno-66-7" href="#__codelineno-66-7"></a>    while True:
</span><span id="__span-66-8"><a id="__codelineno-66-8" name="__codelineno-66-8" href="#__codelineno-66-8"></a>        answer = interrupt(question)
</span><span id="__span-66-9"><a id="__codelineno-66-9" name="__codelineno-66-9" href="#__codelineno-66-9"></a>
</span><span id="__span-66-10"><a id="__codelineno-66-10" name="__codelineno-66-10" href="#__codelineno-66-10"></a>        # Validate answer, if the answer isn&#39;t valid ask for input again.
</span><span id="__span-66-11"><a id="__codelineno-66-11" name="__codelineno-66-11" href="#__codelineno-66-11"></a>        if not isinstance(answer, int) or answer &lt; 0:
</span><span id="__span-66-12"><a id="__codelineno-66-12" name="__codelineno-66-12" href="#__codelineno-66-12"></a>            question = f&quot;&#39;{answer} is not a valid age. What is your age?&quot;
</span><span id="__span-66-13"><a id="__codelineno-66-13" name="__codelineno-66-13" href="#__codelineno-66-13"></a>            answer = None
</span><span id="__span-66-14"><a id="__codelineno-66-14" name="__codelineno-66-14" href="#__codelineno-66-14"></a>            continue
</span><span id="__span-66-15"><a id="__codelineno-66-15" name="__codelineno-66-15" href="#__codelineno-66-15"></a>        else:
</span><span id="__span-66-16"><a id="__codelineno-66-16" name="__codelineno-66-16" href="#__codelineno-66-16"></a>            # If the answer is valid, we can proceed.
</span><span id="__span-66-17"><a id="__codelineno-66-17" name="__codelineno-66-17" href="#__codelineno-66-17"></a>            break
</span><span id="__span-66-18"><a id="__codelineno-66-18" name="__codelineno-66-18" href="#__codelineno-66-18"></a>
</span><span id="__span-66-19"><a id="__codelineno-66-19" name="__codelineno-66-19" href="#__codelineno-66-19"></a>    print(f&quot;The human in the loop is {answer} years old.&quot;)
</span><span id="__span-66-20"><a id="__codelineno-66-20" name="__codelineno-66-20" href="#__codelineno-66-20"></a>    return {
</span><span id="__span-66-21"><a id="__codelineno-66-21" name="__codelineno-66-21" href="#__codelineno-66-21"></a>        &quot;age&quot;: answer
</span><span id="__span-66-22"><a id="__codelineno-66-22" name="__codelineno-66-22" href="#__codelineno-66-22"></a>    }
</span></code></pre></div>
<p><strong>Debug with interrupts</strong></p>
<p>To debug and test a graph, use static interrupts (also known as static breakpoints) to step through the graph execution one node at a time or to pause the graph execution at specific nodes. Static interrupts are triggered at defined points either before or after a node executes. You can set static interrupts by specifying interrupt_before and interrupt_after at compile time or run time.</p>
<p><code>Static interrupts are not recommended for human-in-the-loop workflows. Use dynamic interrupts instead.</code></p>
<p><strong>compile time</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-67-1"><a id="__codelineno-67-1" name="__codelineno-67-1" href="#__codelineno-67-1"></a>graph = graph_builder.compile( 
</span><span id="__span-67-2"><a id="__codelineno-67-2" name="__codelineno-67-2" href="#__codelineno-67-2"></a>    interrupt_before=[&quot;node_a&quot;], 
</span><span id="__span-67-3"><a id="__codelineno-67-3" name="__codelineno-67-3" href="#__codelineno-67-3"></a>    interrupt_after=[&quot;node_b&quot;, &quot;node_c&quot;], 
</span><span id="__span-67-4"><a id="__codelineno-67-4" name="__codelineno-67-4" href="#__codelineno-67-4"></a>    checkpointer=checkpointer, 
</span><span id="__span-67-5"><a id="__codelineno-67-5" name="__codelineno-67-5" href="#__codelineno-67-5"></a>)
</span><span id="__span-67-6"><a id="__codelineno-67-6" name="__codelineno-67-6" href="#__codelineno-67-6"></a>
</span><span id="__span-67-7"><a id="__codelineno-67-7" name="__codelineno-67-7" href="#__codelineno-67-7"></a>config = {
</span><span id="__span-67-8"><a id="__codelineno-67-8" name="__codelineno-67-8" href="#__codelineno-67-8"></a>    &quot;configurable&quot;: {
</span><span id="__span-67-9"><a id="__codelineno-67-9" name="__codelineno-67-9" href="#__codelineno-67-9"></a>        &quot;thread_id&quot;: &quot;some_thread&quot;
</span><span id="__span-67-10"><a id="__codelineno-67-10" name="__codelineno-67-10" href="#__codelineno-67-10"></a>    }
</span><span id="__span-67-11"><a id="__codelineno-67-11" name="__codelineno-67-11" href="#__codelineno-67-11"></a>}
</span><span id="__span-67-12"><a id="__codelineno-67-12" name="__codelineno-67-12" href="#__codelineno-67-12"></a>
</span><span id="__span-67-13"><a id="__codelineno-67-13" name="__codelineno-67-13" href="#__codelineno-67-13"></a># Run the graph until the breakpoint
</span><span id="__span-67-14"><a id="__codelineno-67-14" name="__codelineno-67-14" href="#__codelineno-67-14"></a>graph.invoke(inputs, config=thread_config) 
</span><span id="__span-67-15"><a id="__codelineno-67-15" name="__codelineno-67-15" href="#__codelineno-67-15"></a>
</span><span id="__span-67-16"><a id="__codelineno-67-16" name="__codelineno-67-16" href="#__codelineno-67-16"></a># Resume the graph
</span><span id="__span-67-17"><a id="__codelineno-67-17" name="__codelineno-67-17" href="#__codelineno-67-17"></a>graph.invoke(None, config=thread_config)
</span></code></pre></div>
<p><strong>Run time</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-68-1"><a id="__codelineno-68-1" name="__codelineno-68-1" href="#__codelineno-68-1"></a>graph.invoke( 
</span><span id="__span-68-2"><a id="__codelineno-68-2" name="__codelineno-68-2" href="#__codelineno-68-2"></a>    inputs,
</span><span id="__span-68-3"><a id="__codelineno-68-3" name="__codelineno-68-3" href="#__codelineno-68-3"></a>    interrupt_before=[&quot;node_a&quot;], 
</span><span id="__span-68-4"><a id="__codelineno-68-4" name="__codelineno-68-4" href="#__codelineno-68-4"></a>    interrupt_after=[&quot;node_b&quot;, &quot;node_c&quot;] 
</span><span id="__span-68-5"><a id="__codelineno-68-5" name="__codelineno-68-5" href="#__codelineno-68-5"></a>    config={
</span><span id="__span-68-6"><a id="__codelineno-68-6" name="__codelineno-68-6" href="#__codelineno-68-6"></a>        &quot;configurable&quot;: {&quot;thread_id&quot;: &quot;some_thread&quot;}
</span><span id="__span-68-7"><a id="__codelineno-68-7" name="__codelineno-68-7" href="#__codelineno-68-7"></a>    },
</span><span id="__span-68-8"><a id="__codelineno-68-8" name="__codelineno-68-8" href="#__codelineno-68-8"></a>)
</span><span id="__span-68-9"><a id="__codelineno-68-9" name="__codelineno-68-9" href="#__codelineno-68-9"></a>
</span><span id="__span-68-10"><a id="__codelineno-68-10" name="__codelineno-68-10" href="#__codelineno-68-10"></a>config = {
</span><span id="__span-68-11"><a id="__codelineno-68-11" name="__codelineno-68-11" href="#__codelineno-68-11"></a>    &quot;configurable&quot;: {
</span><span id="__span-68-12"><a id="__codelineno-68-12" name="__codelineno-68-12" href="#__codelineno-68-12"></a>        &quot;thread_id&quot;: &quot;some_thread&quot;
</span><span id="__span-68-13"><a id="__codelineno-68-13" name="__codelineno-68-13" href="#__codelineno-68-13"></a>    }
</span><span id="__span-68-14"><a id="__codelineno-68-14" name="__codelineno-68-14" href="#__codelineno-68-14"></a>}
</span><span id="__span-68-15"><a id="__codelineno-68-15" name="__codelineno-68-15" href="#__codelineno-68-15"></a>
</span><span id="__span-68-16"><a id="__codelineno-68-16" name="__codelineno-68-16" href="#__codelineno-68-16"></a># Run the graph until the breakpoint
</span><span id="__span-68-17"><a id="__codelineno-68-17" name="__codelineno-68-17" href="#__codelineno-68-17"></a>graph.invoke(inputs, config=config) 
</span><span id="__span-68-18"><a id="__codelineno-68-18" name="__codelineno-68-18" href="#__codelineno-68-18"></a>
</span><span id="__span-68-19"><a id="__codelineno-68-19" name="__codelineno-68-19" href="#__codelineno-68-19"></a># Resume the graph
</span><span id="__span-68-20"><a id="__codelineno-68-20" name="__codelineno-68-20" href="#__codelineno-68-20"></a>graph.invoke(None, config=config)
</span></code></pre></div>
<p><code>You cannot set static breakpoints at runtime for sub-graphs. If you have a sub-graph, you must set the breakpoints at compilation time.</code></p>
<p><strong>Use static interrupts in LangGraph Studio</strong></p>
<p>You can use LangGraph Studio to debug your graph. You can set static breakpoints in the UI and then run the graph. You can also use the UI to inspect the graph state at any point in the execution.</p>
<p><img alt="alt text" src="./image/langgraph9.png" /></p>
<p><code>LangGraph Studio is free with locally deployed applications using langgraph dev.</code></p>
<p><strong>Considerations</strong></p>
<p>When using human-in-the-loop, there are some considerations to keep in mind.</p>
<p><strong>Using with code with side-effects</strong></p>
<p>Place code with side effects, such as API calls, after the interrupt or in a separate node to avoid duplication, as these are re-triggered every time the node is resumed.</p>
<p><strong>Side effects after interrupt</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-69-1"><a id="__codelineno-69-1" name="__codelineno-69-1" href="#__codelineno-69-1"></a>from langgraph.types import interrupt
</span><span id="__span-69-2"><a id="__codelineno-69-2" name="__codelineno-69-2" href="#__codelineno-69-2"></a>
</span><span id="__span-69-3"><a id="__codelineno-69-3" name="__codelineno-69-3" href="#__codelineno-69-3"></a>def human_node(state: State):
</span><span id="__span-69-4"><a id="__codelineno-69-4" name="__codelineno-69-4" href="#__codelineno-69-4"></a>    &quot;&quot;&quot;Human node with validation.&quot;&quot;&quot;
</span><span id="__span-69-5"><a id="__codelineno-69-5" name="__codelineno-69-5" href="#__codelineno-69-5"></a>
</span><span id="__span-69-6"><a id="__codelineno-69-6" name="__codelineno-69-6" href="#__codelineno-69-6"></a>    answer = interrupt(question)
</span><span id="__span-69-7"><a id="__codelineno-69-7" name="__codelineno-69-7" href="#__codelineno-69-7"></a>
</span><span id="__span-69-8"><a id="__codelineno-69-8" name="__codelineno-69-8" href="#__codelineno-69-8"></a>    api_call(answer) # OK as it&#39;s after the interrupt
</span></code></pre></div>
<p><strong>Side effects in a separate node</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-70-1"><a id="__codelineno-70-1" name="__codelineno-70-1" href="#__codelineno-70-1"></a>from langgraph.types import interrupt
</span><span id="__span-70-2"><a id="__codelineno-70-2" name="__codelineno-70-2" href="#__codelineno-70-2"></a>
</span><span id="__span-70-3"><a id="__codelineno-70-3" name="__codelineno-70-3" href="#__codelineno-70-3"></a>def human_node(state: State):
</span><span id="__span-70-4"><a id="__codelineno-70-4" name="__codelineno-70-4" href="#__codelineno-70-4"></a>    &quot;&quot;&quot;Human node with validation.&quot;&quot;&quot;
</span><span id="__span-70-5"><a id="__codelineno-70-5" name="__codelineno-70-5" href="#__codelineno-70-5"></a>
</span><span id="__span-70-6"><a id="__codelineno-70-6" name="__codelineno-70-6" href="#__codelineno-70-6"></a>    answer = interrupt(question)
</span><span id="__span-70-7"><a id="__codelineno-70-7" name="__codelineno-70-7" href="#__codelineno-70-7"></a>
</span><span id="__span-70-8"><a id="__codelineno-70-8" name="__codelineno-70-8" href="#__codelineno-70-8"></a>    return {
</span><span id="__span-70-9"><a id="__codelineno-70-9" name="__codelineno-70-9" href="#__codelineno-70-9"></a>        &quot;answer&quot;: answer
</span><span id="__span-70-10"><a id="__codelineno-70-10" name="__codelineno-70-10" href="#__codelineno-70-10"></a>    }
</span><span id="__span-70-11"><a id="__codelineno-70-11" name="__codelineno-70-11" href="#__codelineno-70-11"></a>
</span><span id="__span-70-12"><a id="__codelineno-70-12" name="__codelineno-70-12" href="#__codelineno-70-12"></a>def api_call_node(state: State):
</span><span id="__span-70-13"><a id="__codelineno-70-13" name="__codelineno-70-13" href="#__codelineno-70-13"></a>    api_call(...) # OK as it&#39;s in a separate node
</span></code></pre></div>
<p><strong>Using with subgraphs called as functions</strong></p>
<p>When invoking a subgraph as a function, the parent graph will resume execution from the <strong>beginning of the node</strong> where the subgraph was invoked where the interrupt was triggered. Similarly, the <strong>subgraph</strong> will resume from the <strong>beginning of the node</strong> where the interrupt() function was called.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-71-1"><a id="__codelineno-71-1" name="__codelineno-71-1" href="#__codelineno-71-1"></a>def node_in_parent_graph(state: State):
</span><span id="__span-71-2"><a id="__codelineno-71-2" name="__codelineno-71-2" href="#__codelineno-71-2"></a>    some_code()  # &lt;-- This will re-execute when the subgraph is resumed.
</span><span id="__span-71-3"><a id="__codelineno-71-3" name="__codelineno-71-3" href="#__codelineno-71-3"></a>    # Invoke a subgraph as a function.
</span><span id="__span-71-4"><a id="__codelineno-71-4" name="__codelineno-71-4" href="#__codelineno-71-4"></a>    # The subgraph contains an `interrupt` call.
</span><span id="__span-71-5"><a id="__codelineno-71-5" name="__codelineno-71-5" href="#__codelineno-71-5"></a>    subgraph_result = subgraph.invoke(some_input)
</span><span id="__span-71-6"><a id="__codelineno-71-6" name="__codelineno-71-6" href="#__codelineno-71-6"></a>    ...
</span></code></pre></div>
<p><strong>Using multiple interrupts in a single node</strong></p>
<p>Using multiple interrupts within a single node can be helpful for patterns like validating human input. However, using multiple interrupts in the same node can lead to unexpected behavior if not handled carefully.</p>
<p>When a node contains multiple interrupt calls, LangGraph keeps a list of resume values specific to the task executing the node. Whenever execution resumes, it starts at the beginning of the node. For each interrupt encountered, LangGraph checks if a matching value exists in the task's resume list. Matching is strictly index-based, so the order of interrupt calls within the node is critical.</p>
<p>To avoid issues, refrain from dynamically changing the node's structure between executions. This includes adding, removing, or reordering interrupt calls, as such changes can result in mismatched indices. These problems often arise from unconventional patterns, such as mutating state via Command(resume=..., update=SOME_STATE_MUTATION) or relying on global variables to modify the node's structure dynamically.</p>
<h2 id="time-travel">Time Travel<a class="headerlink" href="#time-travel" title="Permanent link">#</a></h2>
<p>When working with non-deterministic systems that make model-based decisions (e.g., agents powered by LLMs), it can be useful to examine their decision-making process in detail:</p>
<ol>
<li>
<p>🤔 <strong>Understand reasoning:</strong> Analyze the steps that led to a successful result.</p>
</li>
<li>
<p>🐞 <strong>Debug mistakes:</strong> Identify where and why errors occurred.</p>
</li>
<li>
<p>🔍 <strong>Explore alternatives:</strong> Test different paths to uncover better solutions.</p>
</li>
</ol>
<p>LangGraph provides <strong>time travel functionality</strong> to support these use cases. Specifically, you can resume execution from a prior checkpoint — either replaying the same state or modifying it to explore alternatives. In all cases, resuming past execution produces a new fork in the history.</p>
<p><strong>Use time-travel</strong></p>
<p>To use time-travel in LangGraph:</p>
<ol>
<li>
<p><strong>Run the graph</strong> with initial inputs using <strong>invoke</strong> or <strong>stream</strong> methods.</p>
</li>
<li>
<p><strong>Identify a checkpoint in an existing thread:</strong> Use the <code>get_state_history()</code> method to retrieve the execution history for a specific thread_id and locate the desired checkpoint_id.
Alternatively, set an interrupt before the node(s) where you want execution to pause. You can then find the most recent checkpoint recorded up to that interrupt.</p>
</li>
<li>
<p>**Update the graph state (optional): Use the update_state method to modify the graph's state at the checkpoint and resume execution from alternative state.</p>
</li>
<li>
<p><strong>Resume execution from the checkpoint:</strong> Use the invoke or stream methods with an input of None and a configuration containing the appropriate thread_id and checkpoint_id.</p>
</li>
</ol>
<p><strong>In a workflow</strong></p>
<p>This example builds a simple LangGraph workflow that generates a joke topic and writes a joke using an LLM. It demonstrates how to run the graph, retrieve past execution</p>
<p>checkpoints, optionally modify the state, and resume execution from a chosen checkpoint to explore alternate outcomes.</p>
<p><strong>Setup</strong></p>
<p>First we need to install the packages required</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-72-1"><a id="__codelineno-72-1" name="__codelineno-72-1" href="#__codelineno-72-1"></a>%%capture --no-stderr
</span><span id="__span-72-2"><a id="__codelineno-72-2" name="__codelineno-72-2" href="#__codelineno-72-2"></a>%pip install --quiet -U langgraph langchain_anthropic
</span></code></pre></div>
<p>Next, we need to set API keys for Anthropic (the LLM we will use)</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-73-1"><a id="__codelineno-73-1" name="__codelineno-73-1" href="#__codelineno-73-1"></a>import uuid
</span><span id="__span-73-2"><a id="__codelineno-73-2" name="__codelineno-73-2" href="#__codelineno-73-2"></a>
</span><span id="__span-73-3"><a id="__codelineno-73-3" name="__codelineno-73-3" href="#__codelineno-73-3"></a>from typing_extensions import TypedDict, NotRequired
</span><span id="__span-73-4"><a id="__codelineno-73-4" name="__codelineno-73-4" href="#__codelineno-73-4"></a>from langgraph.graph import StateGraph, START, END
</span><span id="__span-73-5"><a id="__codelineno-73-5" name="__codelineno-73-5" href="#__codelineno-73-5"></a>from langchain.chat_models import init_chat_model
</span><span id="__span-73-6"><a id="__codelineno-73-6" name="__codelineno-73-6" href="#__codelineno-73-6"></a>from langgraph.checkpoint.memory import InMemorySaver
</span><span id="__span-73-7"><a id="__codelineno-73-7" name="__codelineno-73-7" href="#__codelineno-73-7"></a>
</span><span id="__span-73-8"><a id="__codelineno-73-8" name="__codelineno-73-8" href="#__codelineno-73-8"></a>
</span><span id="__span-73-9"><a id="__codelineno-73-9" name="__codelineno-73-9" href="#__codelineno-73-9"></a>class State(TypedDict):
</span><span id="__span-73-10"><a id="__codelineno-73-10" name="__codelineno-73-10" href="#__codelineno-73-10"></a>    topic: NotRequired[str]
</span><span id="__span-73-11"><a id="__codelineno-73-11" name="__codelineno-73-11" href="#__codelineno-73-11"></a>    joke: NotRequired[str]
</span><span id="__span-73-12"><a id="__codelineno-73-12" name="__codelineno-73-12" href="#__codelineno-73-12"></a>
</span><span id="__span-73-13"><a id="__codelineno-73-13" name="__codelineno-73-13" href="#__codelineno-73-13"></a>
</span><span id="__span-73-14"><a id="__codelineno-73-14" name="__codelineno-73-14" href="#__codelineno-73-14"></a>llm = init_chat_model(
</span><span id="__span-73-15"><a id="__codelineno-73-15" name="__codelineno-73-15" href="#__codelineno-73-15"></a>    &quot;anthropic:claude-3-7-sonnet-latest&quot;,
</span><span id="__span-73-16"><a id="__codelineno-73-16" name="__codelineno-73-16" href="#__codelineno-73-16"></a>    temperature=0,
</span><span id="__span-73-17"><a id="__codelineno-73-17" name="__codelineno-73-17" href="#__codelineno-73-17"></a>)
</span><span id="__span-73-18"><a id="__codelineno-73-18" name="__codelineno-73-18" href="#__codelineno-73-18"></a>
</span><span id="__span-73-19"><a id="__codelineno-73-19" name="__codelineno-73-19" href="#__codelineno-73-19"></a>
</span><span id="__span-73-20"><a id="__codelineno-73-20" name="__codelineno-73-20" href="#__codelineno-73-20"></a>def generate_topic(state: State):
</span><span id="__span-73-21"><a id="__codelineno-73-21" name="__codelineno-73-21" href="#__codelineno-73-21"></a>    &quot;&quot;&quot;LLM call to generate a topic for the joke&quot;&quot;&quot;
</span><span id="__span-73-22"><a id="__codelineno-73-22" name="__codelineno-73-22" href="#__codelineno-73-22"></a>    msg = llm.invoke(&quot;Give me a funny topic for a joke&quot;)
</span><span id="__span-73-23"><a id="__codelineno-73-23" name="__codelineno-73-23" href="#__codelineno-73-23"></a>    return {&quot;topic&quot;: msg.content}
</span><span id="__span-73-24"><a id="__codelineno-73-24" name="__codelineno-73-24" href="#__codelineno-73-24"></a>
</span><span id="__span-73-25"><a id="__codelineno-73-25" name="__codelineno-73-25" href="#__codelineno-73-25"></a>
</span><span id="__span-73-26"><a id="__codelineno-73-26" name="__codelineno-73-26" href="#__codelineno-73-26"></a>def write_joke(state: State):
</span><span id="__span-73-27"><a id="__codelineno-73-27" name="__codelineno-73-27" href="#__codelineno-73-27"></a>    &quot;&quot;&quot;LLM call to write a joke based on the topic&quot;&quot;&quot;
</span><span id="__span-73-28"><a id="__codelineno-73-28" name="__codelineno-73-28" href="#__codelineno-73-28"></a>    msg = llm.invoke(f&quot;Write a short joke about {state[&#39;topic&#39;]}&quot;)
</span><span id="__span-73-29"><a id="__codelineno-73-29" name="__codelineno-73-29" href="#__codelineno-73-29"></a>    return {&quot;joke&quot;: msg.content}
</span><span id="__span-73-30"><a id="__codelineno-73-30" name="__codelineno-73-30" href="#__codelineno-73-30"></a>
</span><span id="__span-73-31"><a id="__codelineno-73-31" name="__codelineno-73-31" href="#__codelineno-73-31"></a>
</span><span id="__span-73-32"><a id="__codelineno-73-32" name="__codelineno-73-32" href="#__codelineno-73-32"></a># Build workflow
</span><span id="__span-73-33"><a id="__codelineno-73-33" name="__codelineno-73-33" href="#__codelineno-73-33"></a>workflow = StateGraph(State)
</span><span id="__span-73-34"><a id="__codelineno-73-34" name="__codelineno-73-34" href="#__codelineno-73-34"></a>
</span><span id="__span-73-35"><a id="__codelineno-73-35" name="__codelineno-73-35" href="#__codelineno-73-35"></a># Add nodes
</span><span id="__span-73-36"><a id="__codelineno-73-36" name="__codelineno-73-36" href="#__codelineno-73-36"></a>workflow.add_node(&quot;generate_topic&quot;, generate_topic)
</span><span id="__span-73-37"><a id="__codelineno-73-37" name="__codelineno-73-37" href="#__codelineno-73-37"></a>workflow.add_node(&quot;write_joke&quot;, write_joke)
</span><span id="__span-73-38"><a id="__codelineno-73-38" name="__codelineno-73-38" href="#__codelineno-73-38"></a>
</span><span id="__span-73-39"><a id="__codelineno-73-39" name="__codelineno-73-39" href="#__codelineno-73-39"></a># Add edges to connect nodes
</span><span id="__span-73-40"><a id="__codelineno-73-40" name="__codelineno-73-40" href="#__codelineno-73-40"></a>workflow.add_edge(START, &quot;generate_topic&quot;)
</span><span id="__span-73-41"><a id="__codelineno-73-41" name="__codelineno-73-41" href="#__codelineno-73-41"></a>workflow.add_edge(&quot;generate_topic&quot;, &quot;write_joke&quot;)
</span><span id="__span-73-42"><a id="__codelineno-73-42" name="__codelineno-73-42" href="#__codelineno-73-42"></a>workflow.add_edge(&quot;write_joke&quot;, END)
</span><span id="__span-73-43"><a id="__codelineno-73-43" name="__codelineno-73-43" href="#__codelineno-73-43"></a>
</span><span id="__span-73-44"><a id="__codelineno-73-44" name="__codelineno-73-44" href="#__codelineno-73-44"></a># Compile
</span><span id="__span-73-45"><a id="__codelineno-73-45" name="__codelineno-73-45" href="#__codelineno-73-45"></a>checkpointer = InMemorySaver()
</span><span id="__span-73-46"><a id="__codelineno-73-46" name="__codelineno-73-46" href="#__codelineno-73-46"></a>graph = workflow.compile(checkpointer=checkpointer)
</span><span id="__span-73-47"><a id="__codelineno-73-47" name="__codelineno-73-47" href="#__codelineno-73-47"></a>graph
</span></code></pre></div>
<div class="language-text highlight"><pre><span></span><code><span id="__span-74-1"><a id="__codelineno-74-1" name="__codelineno-74-1" href="#__codelineno-74-1"></a>import uuid
</span><span id="__span-74-2"><a id="__codelineno-74-2" name="__codelineno-74-2" href="#__codelineno-74-2"></a>
</span><span id="__span-74-3"><a id="__codelineno-74-3" name="__codelineno-74-3" href="#__codelineno-74-3"></a>from typing_extensions import TypedDict, NotRequired
</span><span id="__span-74-4"><a id="__codelineno-74-4" name="__codelineno-74-4" href="#__codelineno-74-4"></a>from langgraph.graph import StateGraph, START, END
</span><span id="__span-74-5"><a id="__codelineno-74-5" name="__codelineno-74-5" href="#__codelineno-74-5"></a>from langchain.chat_models import init_chat_model
</span><span id="__span-74-6"><a id="__codelineno-74-6" name="__codelineno-74-6" href="#__codelineno-74-6"></a>from langgraph.checkpoint.memory import InMemorySaver
</span><span id="__span-74-7"><a id="__codelineno-74-7" name="__codelineno-74-7" href="#__codelineno-74-7"></a>
</span><span id="__span-74-8"><a id="__codelineno-74-8" name="__codelineno-74-8" href="#__codelineno-74-8"></a>
</span><span id="__span-74-9"><a id="__codelineno-74-9" name="__codelineno-74-9" href="#__codelineno-74-9"></a>class State(TypedDict):
</span><span id="__span-74-10"><a id="__codelineno-74-10" name="__codelineno-74-10" href="#__codelineno-74-10"></a>    topic: NotRequired[str]
</span><span id="__span-74-11"><a id="__codelineno-74-11" name="__codelineno-74-11" href="#__codelineno-74-11"></a>    joke: NotRequired[str]
</span><span id="__span-74-12"><a id="__codelineno-74-12" name="__codelineno-74-12" href="#__codelineno-74-12"></a>
</span><span id="__span-74-13"><a id="__codelineno-74-13" name="__codelineno-74-13" href="#__codelineno-74-13"></a>
</span><span id="__span-74-14"><a id="__codelineno-74-14" name="__codelineno-74-14" href="#__codelineno-74-14"></a>llm = init_chat_model(
</span><span id="__span-74-15"><a id="__codelineno-74-15" name="__codelineno-74-15" href="#__codelineno-74-15"></a>    &quot;anthropic:claude-3-7-sonnet-latest&quot;,
</span><span id="__span-74-16"><a id="__codelineno-74-16" name="__codelineno-74-16" href="#__codelineno-74-16"></a>    temperature=0,
</span><span id="__span-74-17"><a id="__codelineno-74-17" name="__codelineno-74-17" href="#__codelineno-74-17"></a>)
</span><span id="__span-74-18"><a id="__codelineno-74-18" name="__codelineno-74-18" href="#__codelineno-74-18"></a>
</span><span id="__span-74-19"><a id="__codelineno-74-19" name="__codelineno-74-19" href="#__codelineno-74-19"></a>
</span><span id="__span-74-20"><a id="__codelineno-74-20" name="__codelineno-74-20" href="#__codelineno-74-20"></a>def generate_topic(state: State):
</span><span id="__span-74-21"><a id="__codelineno-74-21" name="__codelineno-74-21" href="#__codelineno-74-21"></a>    &quot;&quot;&quot;LLM call to generate a topic for the joke&quot;&quot;&quot;
</span><span id="__span-74-22"><a id="__codelineno-74-22" name="__codelineno-74-22" href="#__codelineno-74-22"></a>    msg = llm.invoke(&quot;Give me a funny topic for a joke&quot;)
</span><span id="__span-74-23"><a id="__codelineno-74-23" name="__codelineno-74-23" href="#__codelineno-74-23"></a>    return {&quot;topic&quot;: msg.content}
</span><span id="__span-74-24"><a id="__codelineno-74-24" name="__codelineno-74-24" href="#__codelineno-74-24"></a>
</span><span id="__span-74-25"><a id="__codelineno-74-25" name="__codelineno-74-25" href="#__codelineno-74-25"></a>
</span><span id="__span-74-26"><a id="__codelineno-74-26" name="__codelineno-74-26" href="#__codelineno-74-26"></a>def write_joke(state: State):
</span><span id="__span-74-27"><a id="__codelineno-74-27" name="__codelineno-74-27" href="#__codelineno-74-27"></a>    &quot;&quot;&quot;LLM call to write a joke based on the topic&quot;&quot;&quot;
</span><span id="__span-74-28"><a id="__codelineno-74-28" name="__codelineno-74-28" href="#__codelineno-74-28"></a>    msg = llm.invoke(f&quot;Write a short joke about {state[&#39;topic&#39;]}&quot;)
</span><span id="__span-74-29"><a id="__codelineno-74-29" name="__codelineno-74-29" href="#__codelineno-74-29"></a>    return {&quot;joke&quot;: msg.content}
</span><span id="__span-74-30"><a id="__codelineno-74-30" name="__codelineno-74-30" href="#__codelineno-74-30"></a>
</span><span id="__span-74-31"><a id="__codelineno-74-31" name="__codelineno-74-31" href="#__codelineno-74-31"></a>
</span><span id="__span-74-32"><a id="__codelineno-74-32" name="__codelineno-74-32" href="#__codelineno-74-32"></a># Build workflow
</span><span id="__span-74-33"><a id="__codelineno-74-33" name="__codelineno-74-33" href="#__codelineno-74-33"></a>workflow = StateGraph(State)
</span><span id="__span-74-34"><a id="__codelineno-74-34" name="__codelineno-74-34" href="#__codelineno-74-34"></a>
</span><span id="__span-74-35"><a id="__codelineno-74-35" name="__codelineno-74-35" href="#__codelineno-74-35"></a># Add nodes
</span><span id="__span-74-36"><a id="__codelineno-74-36" name="__codelineno-74-36" href="#__codelineno-74-36"></a>workflow.add_node(&quot;generate_topic&quot;, generate_topic)
</span><span id="__span-74-37"><a id="__codelineno-74-37" name="__codelineno-74-37" href="#__codelineno-74-37"></a>workflow.add_node(&quot;write_joke&quot;, write_joke)
</span><span id="__span-74-38"><a id="__codelineno-74-38" name="__codelineno-74-38" href="#__codelineno-74-38"></a>
</span><span id="__span-74-39"><a id="__codelineno-74-39" name="__codelineno-74-39" href="#__codelineno-74-39"></a># Add edges to connect nodes
</span><span id="__span-74-40"><a id="__codelineno-74-40" name="__codelineno-74-40" href="#__codelineno-74-40"></a>workflow.add_edge(START, &quot;generate_topic&quot;)
</span><span id="__span-74-41"><a id="__codelineno-74-41" name="__codelineno-74-41" href="#__codelineno-74-41"></a>workflow.add_edge(&quot;generate_topic&quot;, &quot;write_joke&quot;)
</span><span id="__span-74-42"><a id="__codelineno-74-42" name="__codelineno-74-42" href="#__codelineno-74-42"></a>workflow.add_edge(&quot;write_joke&quot;, END)
</span><span id="__span-74-43"><a id="__codelineno-74-43" name="__codelineno-74-43" href="#__codelineno-74-43"></a>
</span><span id="__span-74-44"><a id="__codelineno-74-44" name="__codelineno-74-44" href="#__codelineno-74-44"></a># Compile
</span><span id="__span-74-45"><a id="__codelineno-74-45" name="__codelineno-74-45" href="#__codelineno-74-45"></a>checkpointer = InMemorySaver()
</span><span id="__span-74-46"><a id="__codelineno-74-46" name="__codelineno-74-46" href="#__codelineno-74-46"></a>graph = workflow.compile(checkpointer=checkpointer)
</span><span id="__span-74-47"><a id="__codelineno-74-47" name="__codelineno-74-47" href="#__codelineno-74-47"></a>graph
</span></code></pre></div>
<p><strong>Output:</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-75-1"><a id="__codelineno-75-1" name="__codelineno-75-1" href="#__codelineno-75-1"></a>How about &quot;The Secret Life of Socks in the Dryer&quot;? You know, exploring the mysterious phenomenon of how socks go into the laundry as pairs but come out as singles. Where do they go? Are they starting new lives elsewhere? Is there a sock paradise we don&#39;t know about? There&#39;s a lot of comedic potential in the everyday mystery that unites us all!
</span><span id="__span-75-2"><a id="__codelineno-75-2" name="__codelineno-75-2" href="#__codelineno-75-2"></a>
</span><span id="__span-75-3"><a id="__codelineno-75-3" name="__codelineno-75-3" href="#__codelineno-75-3"></a># The Secret Life of Socks in the Dryer
</span><span id="__span-75-4"><a id="__codelineno-75-4" name="__codelineno-75-4" href="#__codelineno-75-4"></a>
</span><span id="__span-75-5"><a id="__codelineno-75-5" name="__codelineno-75-5" href="#__codelineno-75-5"></a>I finally discovered where all my missing socks go after the dryer. Turns out they&#39;re not missing at all—they&#39;ve just eloped with someone else&#39;s socks from the laundromat to start new lives together.
</span><span id="__span-75-6"><a id="__codelineno-75-6" name="__codelineno-75-6" href="#__codelineno-75-6"></a>
</span><span id="__span-75-7"><a id="__codelineno-75-7" name="__codelineno-75-7" href="#__codelineno-75-7"></a>My blue argyle is now living in Bermuda with a red polka dot, posting vacation photos on Sockstagram and sending me lint as alimony.
</span></code></pre></div>
<p>** Identify a checkpoint**</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-76-1"><a id="__codelineno-76-1" name="__codelineno-76-1" href="#__codelineno-76-1"></a># The states are returned in reverse chronological order.
</span><span id="__span-76-2"><a id="__codelineno-76-2" name="__codelineno-76-2" href="#__codelineno-76-2"></a>states = list(graph.get_state_history(config))
</span><span id="__span-76-3"><a id="__codelineno-76-3" name="__codelineno-76-3" href="#__codelineno-76-3"></a>
</span><span id="__span-76-4"><a id="__codelineno-76-4" name="__codelineno-76-4" href="#__codelineno-76-4"></a>for state in states:
</span><span id="__span-76-5"><a id="__codelineno-76-5" name="__codelineno-76-5" href="#__codelineno-76-5"></a>    print(state.next)
</span><span id="__span-76-6"><a id="__codelineno-76-6" name="__codelineno-76-6" href="#__codelineno-76-6"></a>    print(state.config[&quot;configurable&quot;][&quot;checkpoint_id&quot;])
</span><span id="__span-76-7"><a id="__codelineno-76-7" name="__codelineno-76-7" href="#__codelineno-76-7"></a>    print()
</span></code></pre></div>
<p><strong>Output:</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-77-1"><a id="__codelineno-77-1" name="__codelineno-77-1" href="#__codelineno-77-1"></a>()
</span><span id="__span-77-2"><a id="__codelineno-77-2" name="__codelineno-77-2" href="#__codelineno-77-2"></a>1f02ac4a-ec9f-6524-8002-8f7b0bbeed0e
</span><span id="__span-77-3"><a id="__codelineno-77-3" name="__codelineno-77-3" href="#__codelineno-77-3"></a>
</span><span id="__span-77-4"><a id="__codelineno-77-4" name="__codelineno-77-4" href="#__codelineno-77-4"></a>(&#39;write_joke&#39;,)
</span><span id="__span-77-5"><a id="__codelineno-77-5" name="__codelineno-77-5" href="#__codelineno-77-5"></a>1f02ac4a-ce2a-6494-8001-cb2e2d651227
</span><span id="__span-77-6"><a id="__codelineno-77-6" name="__codelineno-77-6" href="#__codelineno-77-6"></a>
</span><span id="__span-77-7"><a id="__codelineno-77-7" name="__codelineno-77-7" href="#__codelineno-77-7"></a>(&#39;generate_topic&#39;,)
</span><span id="__span-77-8"><a id="__codelineno-77-8" name="__codelineno-77-8" href="#__codelineno-77-8"></a>1f02ac4a-a4e0-630d-8000-b73c254ba748
</span><span id="__span-77-9"><a id="__codelineno-77-9" name="__codelineno-77-9" href="#__codelineno-77-9"></a>
</span><span id="__span-77-10"><a id="__codelineno-77-10" name="__codelineno-77-10" href="#__codelineno-77-10"></a>(&#39;__start__&#39;,)
</span><span id="__span-77-11"><a id="__codelineno-77-11" name="__codelineno-77-11" href="#__codelineno-77-11"></a>1f02ac4a-a4dd-665e-bfff-e6c8c44315d9
</span></code></pre></div>
<div class="language-text highlight"><pre><span></span><code><span id="__span-78-1"><a id="__codelineno-78-1" name="__codelineno-78-1" href="#__codelineno-78-1"></a># This is the state before last (states are listed in chronological order)
</span><span id="__span-78-2"><a id="__codelineno-78-2" name="__codelineno-78-2" href="#__codelineno-78-2"></a>selected_state = states[1]
</span><span id="__span-78-3"><a id="__codelineno-78-3" name="__codelineno-78-3" href="#__codelineno-78-3"></a>print(selected_state.next)
</span><span id="__span-78-4"><a id="__codelineno-78-4" name="__codelineno-78-4" href="#__codelineno-78-4"></a>print(selected_state.values)
</span></code></pre></div>
<p><strong>Output:</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-79-1"><a id="__codelineno-79-1" name="__codelineno-79-1" href="#__codelineno-79-1"></a>(&#39;write_joke&#39;,)
</span><span id="__span-79-2"><a id="__codelineno-79-2" name="__codelineno-79-2" href="#__codelineno-79-2"></a>{&#39;topic&#39;: &#39;How about &quot;The Secret Life of Socks in the Dryer&quot;? You know, exploring the mysterious phenomenon of how socks go into the laundry as pairs but come out as singles. Where do they go? Are they starting new lives elsewhere? Is there a sock paradise we don\\&#39;t know about? There\\&#39;s a lot of comedic potential in the everyday mystery that unites us all!&#39;}
</span></code></pre></div>
<p><strong>Update the state (optional)</strong></p>
<p>update_state will create a new checkpoint. The new checkpoint will be associated with the same thread, but a new checkpoint ID.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-80-1"><a id="__codelineno-80-1" name="__codelineno-80-1" href="#__codelineno-80-1"></a>new_config = graph.update_state(selected_state.config, values={&quot;topic&quot;: &quot;chickens&quot;})
</span><span id="__span-80-2"><a id="__codelineno-80-2" name="__codelineno-80-2" href="#__codelineno-80-2"></a>print(new_config)
</span></code></pre></div>
<p><strong>Output:</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-81-1"><a id="__codelineno-81-1" name="__codelineno-81-1" href="#__codelineno-81-1"></a>{&#39;configurable&#39;: {&#39;thread_id&#39;: &#39;c62e2e03-c27b-4cb6-8cea-ea9bfedae006&#39;, &#39;checkpoint_ns&#39;: &#39;&#39;, &#39;checkpoint_id&#39;: &#39;1f02ac4a-ecee-600b-8002-a1d21df32e4c&#39;}}
</span></code></pre></div>
<p><strong>Resume execution from the checkpoint</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-82-1"><a id="__codelineno-82-1" name="__codelineno-82-1" href="#__codelineno-82-1"></a>graph.invoke(None, new_config)
</span></code></pre></div>
<p><strong>Output:</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-83-1"><a id="__codelineno-83-1" name="__codelineno-83-1" href="#__codelineno-83-1"></a>{&#39;topic&#39;: &#39;chickens&#39;,
</span><span id="__span-83-2"><a id="__codelineno-83-2" name="__codelineno-83-2" href="#__codelineno-83-2"></a> &#39;joke&#39;: &#39;Why did the chicken join a band?\n\nBecause it had excellent drumsticks!&#39;}
</span></code></pre></div>
<h2 id="subgraphs">Subgraphs<a class="headerlink" href="#subgraphs" title="Permanent link">#</a></h2>
<p>A subgraph is a graph that is used as a node in another graph — this is the concept of encapsulation applied to LangGraph. Subgraphs allow you to build complex systems with multiple components that are themselves graphs.</p>
<p><img alt="alt text" src="./image/langgraph10.png" /></p>
<p>Some reasons for using subgraphs are:</p>
<ul>
<li>
<p>building multi-agent systems</p>
</li>
<li>
<p>when you want to reuse a set of nodes in multiple graphs</p>
</li>
<li>
<p>when you want different teams to work on different parts of the graph independently, you can define each part as a subgraph, and as long as the subgraph interface (the input and output schemas) is respected, the parent graph can be built without knowing any details of the subgraph</p>
</li>
</ul>
<p>The main question when adding subgraphs is how the parent graph and subgraph communicate, i.e. how they pass the state between each other during the graph execution. There are two scenarios:</p>
<ul>
<li>parent and subgraph have shared state keys in their state schemas. In this case, you can include the subgraph as a node in the parent graph</li>
</ul>
<div class="language-text highlight"><pre><span></span><code><span id="__span-84-1"><a id="__codelineno-84-1" name="__codelineno-84-1" href="#__codelineno-84-1"></a>from langgraph.graph import StateGraph, MessagesState, START
</span><span id="__span-84-2"><a id="__codelineno-84-2" name="__codelineno-84-2" href="#__codelineno-84-2"></a>
</span><span id="__span-84-3"><a id="__codelineno-84-3" name="__codelineno-84-3" href="#__codelineno-84-3"></a># Subgraph
</span><span id="__span-84-4"><a id="__codelineno-84-4" name="__codelineno-84-4" href="#__codelineno-84-4"></a>
</span><span id="__span-84-5"><a id="__codelineno-84-5" name="__codelineno-84-5" href="#__codelineno-84-5"></a>def call_model(state: MessagesState):
</span><span id="__span-84-6"><a id="__codelineno-84-6" name="__codelineno-84-6" href="#__codelineno-84-6"></a>    response = model.invoke(state[&quot;messages&quot;])
</span><span id="__span-84-7"><a id="__codelineno-84-7" name="__codelineno-84-7" href="#__codelineno-84-7"></a>    return {&quot;messages&quot;: response}
</span><span id="__span-84-8"><a id="__codelineno-84-8" name="__codelineno-84-8" href="#__codelineno-84-8"></a>
</span><span id="__span-84-9"><a id="__codelineno-84-9" name="__codelineno-84-9" href="#__codelineno-84-9"></a>subgraph_builder = StateGraph(State)
</span><span id="__span-84-10"><a id="__codelineno-84-10" name="__codelineno-84-10" href="#__codelineno-84-10"></a>subgraph_builder.add_node(call_model)
</span><span id="__span-84-11"><a id="__codelineno-84-11" name="__codelineno-84-11" href="#__codelineno-84-11"></a>...
</span><span id="__span-84-12"><a id="__codelineno-84-12" name="__codelineno-84-12" href="#__codelineno-84-12"></a>subgraph = subgraph_builder.compile()
</span><span id="__span-84-13"><a id="__codelineno-84-13" name="__codelineno-84-13" href="#__codelineno-84-13"></a>
</span><span id="__span-84-14"><a id="__codelineno-84-14" name="__codelineno-84-14" href="#__codelineno-84-14"></a># Parent graph
</span><span id="__span-84-15"><a id="__codelineno-84-15" name="__codelineno-84-15" href="#__codelineno-84-15"></a>
</span><span id="__span-84-16"><a id="__codelineno-84-16" name="__codelineno-84-16" href="#__codelineno-84-16"></a>builder = StateGraph(State)
</span><span id="__span-84-17"><a id="__codelineno-84-17" name="__codelineno-84-17" href="#__codelineno-84-17"></a>builder.add_node(&quot;subgraph_node&quot;, subgraph)
</span><span id="__span-84-18"><a id="__codelineno-84-18" name="__codelineno-84-18" href="#__codelineno-84-18"></a>builder.add_edge(START, &quot;subgraph_node&quot;)
</span><span id="__span-84-19"><a id="__codelineno-84-19" name="__codelineno-84-19" href="#__codelineno-84-19"></a>graph = builder.compile()
</span><span id="__span-84-20"><a id="__codelineno-84-20" name="__codelineno-84-20" href="#__codelineno-84-20"></a>...
</span><span id="__span-84-21"><a id="__codelineno-84-21" name="__codelineno-84-21" href="#__codelineno-84-21"></a>graph.invoke({&quot;messages&quot;: [{&quot;role&quot;: &quot;user&quot;, &quot;content&quot;: &quot;hi!&quot;}]})
</span></code></pre></div>
<ul>
<li>parent graph and subgraph have <strong>different schemas</strong> (no shared state keys in their state schemas). In this case, you have to call the subgraph from inside a node in the parent graph: this is useful when the parent graph and the subgraph have different state schemas and you need to transform state before or after calling the subgraph</li>
</ul>
<div class="language-text highlight"><pre><span></span><code><span id="__span-85-1"><a id="__codelineno-85-1" name="__codelineno-85-1" href="#__codelineno-85-1"></a>from typing_extensions import TypedDict, Annotated
</span><span id="__span-85-2"><a id="__codelineno-85-2" name="__codelineno-85-2" href="#__codelineno-85-2"></a>from langchain_core.messages import AnyMessage
</span><span id="__span-85-3"><a id="__codelineno-85-3" name="__codelineno-85-3" href="#__codelineno-85-3"></a>from langgraph.graph import StateGraph, MessagesState, START
</span><span id="__span-85-4"><a id="__codelineno-85-4" name="__codelineno-85-4" href="#__codelineno-85-4"></a>from langgraph.graph.message import add_messages
</span><span id="__span-85-5"><a id="__codelineno-85-5" name="__codelineno-85-5" href="#__codelineno-85-5"></a>
</span><span id="__span-85-6"><a id="__codelineno-85-6" name="__codelineno-85-6" href="#__codelineno-85-6"></a>class SubgraphMessagesState(TypedDict):
</span><span id="__span-85-7"><a id="__codelineno-85-7" name="__codelineno-85-7" href="#__codelineno-85-7"></a>    subgraph_messages: Annotated[list[AnyMessage], add_messages]
</span><span id="__span-85-8"><a id="__codelineno-85-8" name="__codelineno-85-8" href="#__codelineno-85-8"></a>
</span><span id="__span-85-9"><a id="__codelineno-85-9" name="__codelineno-85-9" href="#__codelineno-85-9"></a># Subgraph
</span><span id="__span-85-10"><a id="__codelineno-85-10" name="__codelineno-85-10" href="#__codelineno-85-10"></a>
</span><span id="__span-85-11"><a id="__codelineno-85-11" name="__codelineno-85-11" href="#__codelineno-85-11"></a>def call_model(state: SubgraphMessagesState):
</span><span id="__span-85-12"><a id="__codelineno-85-12" name="__codelineno-85-12" href="#__codelineno-85-12"></a>    response = model.invoke(state[&quot;subgraph_messages&quot;])
</span><span id="__span-85-13"><a id="__codelineno-85-13" name="__codelineno-85-13" href="#__codelineno-85-13"></a>    return {&quot;subgraph_messages&quot;: response}
</span><span id="__span-85-14"><a id="__codelineno-85-14" name="__codelineno-85-14" href="#__codelineno-85-14"></a>
</span><span id="__span-85-15"><a id="__codelineno-85-15" name="__codelineno-85-15" href="#__codelineno-85-15"></a>subgraph_builder = StateGraph(SubgraphMessagesState)
</span><span id="__span-85-16"><a id="__codelineno-85-16" name="__codelineno-85-16" href="#__codelineno-85-16"></a>subgraph_builder.add_node(&quot;call_model_from_subgraph&quot;, call_model)
</span><span id="__span-85-17"><a id="__codelineno-85-17" name="__codelineno-85-17" href="#__codelineno-85-17"></a>subgraph_builder.add_edge(START, &quot;call_model_from_subgraph&quot;)
</span><span id="__span-85-18"><a id="__codelineno-85-18" name="__codelineno-85-18" href="#__codelineno-85-18"></a>...
</span><span id="__span-85-19"><a id="__codelineno-85-19" name="__codelineno-85-19" href="#__codelineno-85-19"></a>subgraph = subgraph_builder.compile()
</span><span id="__span-85-20"><a id="__codelineno-85-20" name="__codelineno-85-20" href="#__codelineno-85-20"></a>
</span><span id="__span-85-21"><a id="__codelineno-85-21" name="__codelineno-85-21" href="#__codelineno-85-21"></a># Parent graph
</span><span id="__span-85-22"><a id="__codelineno-85-22" name="__codelineno-85-22" href="#__codelineno-85-22"></a>
</span><span id="__span-85-23"><a id="__codelineno-85-23" name="__codelineno-85-23" href="#__codelineno-85-23"></a>def call_subgraph(state: MessagesState):
</span><span id="__span-85-24"><a id="__codelineno-85-24" name="__codelineno-85-24" href="#__codelineno-85-24"></a>    response = subgraph.invoke({&quot;subgraph_messages&quot;: state[&quot;messages&quot;]})
</span><span id="__span-85-25"><a id="__codelineno-85-25" name="__codelineno-85-25" href="#__codelineno-85-25"></a>    return {&quot;messages&quot;: response[&quot;subgraph_messages&quot;]}
</span><span id="__span-85-26"><a id="__codelineno-85-26" name="__codelineno-85-26" href="#__codelineno-85-26"></a>
</span><span id="__span-85-27"><a id="__codelineno-85-27" name="__codelineno-85-27" href="#__codelineno-85-27"></a>builder = StateGraph(State)
</span><span id="__span-85-28"><a id="__codelineno-85-28" name="__codelineno-85-28" href="#__codelineno-85-28"></a>builder.add_node(&quot;subgraph_node&quot;, call_subgraph)
</span><span id="__span-85-29"><a id="__codelineno-85-29" name="__codelineno-85-29" href="#__codelineno-85-29"></a>builder.add_edge(START, &quot;subgraph_node&quot;)
</span><span id="__span-85-30"><a id="__codelineno-85-30" name="__codelineno-85-30" href="#__codelineno-85-30"></a>graph = builder.compile()
</span><span id="__span-85-31"><a id="__codelineno-85-31" name="__codelineno-85-31" href="#__codelineno-85-31"></a>...
</span><span id="__span-85-32"><a id="__codelineno-85-32" name="__codelineno-85-32" href="#__codelineno-85-32"></a>graph.invoke({&quot;messages&quot;: [{&quot;role&quot;: &quot;user&quot;, &quot;content&quot;: &quot;hi!&quot;}]})
</span></code></pre></div>
<h2 id="use-subgraphs">Use subgraphs<a class="headerlink" href="#use-subgraphs" title="Permanent link">#</a></h2>
<p>This guide explains the mechanics of using subgraphs. A common application of subgraphs is to build multi-agent systems.</p>
<p>When adding subgraphs, you need to define how the parent graph and the subgraph communicate:</p>
<ul>
<li>
<p><strong>Shared state schemas</strong> — parent and subgraph have <strong>shared state keys</strong> in their state schemas</p>
</li>
<li>
<p><strong>Different state schemas</strong> — <strong>no shared state keys</strong> in parent and subgraph schemas</p>
</li>
</ul>
<p><strong>Setup</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-86-1"><a id="__codelineno-86-1" name="__codelineno-86-1" href="#__codelineno-86-1"></a>pip install -U langgraph
</span></code></pre></div>
<p><strong>Shared state schemas</strong></p>
<p>A common case is for the parent graph and subgraph to communicate over a shared state key (channel) in the schema. For example, in multi-agent systems, the agents often communicate over a shared messages key.</p>
<p>If your subgraph shares state keys with the parent graph, you can follow these steps to add it to your graph:</p>
<ol>
<li>
<p>Define the subgraph workflow (<code>subgraph_builder</code> in the example below) and compile it</p>
</li>
<li>
<p>Pass compiled subgraph to the <code>.add_node</code> method when defining the parent graph workflow</p>
</li>
</ol>
<div class="language-text highlight"><pre><span></span><code><span id="__span-87-1"><a id="__codelineno-87-1" name="__codelineno-87-1" href="#__codelineno-87-1"></a>from typing_extensions import TypedDict
</span><span id="__span-87-2"><a id="__codelineno-87-2" name="__codelineno-87-2" href="#__codelineno-87-2"></a>from langgraph.graph.state import StateGraph, START
</span><span id="__span-87-3"><a id="__codelineno-87-3" name="__codelineno-87-3" href="#__codelineno-87-3"></a>
</span><span id="__span-87-4"><a id="__codelineno-87-4" name="__codelineno-87-4" href="#__codelineno-87-4"></a>class State(TypedDict):
</span><span id="__span-87-5"><a id="__codelineno-87-5" name="__codelineno-87-5" href="#__codelineno-87-5"></a>    foo: str
</span><span id="__span-87-6"><a id="__codelineno-87-6" name="__codelineno-87-6" href="#__codelineno-87-6"></a>
</span><span id="__span-87-7"><a id="__codelineno-87-7" name="__codelineno-87-7" href="#__codelineno-87-7"></a># Subgraph
</span><span id="__span-87-8"><a id="__codelineno-87-8" name="__codelineno-87-8" href="#__codelineno-87-8"></a>
</span><span id="__span-87-9"><a id="__codelineno-87-9" name="__codelineno-87-9" href="#__codelineno-87-9"></a>def subgraph_node_1(state: State):
</span><span id="__span-87-10"><a id="__codelineno-87-10" name="__codelineno-87-10" href="#__codelineno-87-10"></a>    return {&quot;foo&quot;: &quot;hi! &quot; + state[&quot;foo&quot;]}
</span><span id="__span-87-11"><a id="__codelineno-87-11" name="__codelineno-87-11" href="#__codelineno-87-11"></a>
</span><span id="__span-87-12"><a id="__codelineno-87-12" name="__codelineno-87-12" href="#__codelineno-87-12"></a>subgraph_builder = StateGraph(State)
</span><span id="__span-87-13"><a id="__codelineno-87-13" name="__codelineno-87-13" href="#__codelineno-87-13"></a>subgraph_builder.add_node(subgraph_node_1)
</span><span id="__span-87-14"><a id="__codelineno-87-14" name="__codelineno-87-14" href="#__codelineno-87-14"></a>subgraph_builder.add_edge(START, &quot;subgraph_node_1&quot;)
</span><span id="__span-87-15"><a id="__codelineno-87-15" name="__codelineno-87-15" href="#__codelineno-87-15"></a>subgraph = subgraph_builder.compile()
</span><span id="__span-87-16"><a id="__codelineno-87-16" name="__codelineno-87-16" href="#__codelineno-87-16"></a>
</span><span id="__span-87-17"><a id="__codelineno-87-17" name="__codelineno-87-17" href="#__codelineno-87-17"></a># Parent graph
</span><span id="__span-87-18"><a id="__codelineno-87-18" name="__codelineno-87-18" href="#__codelineno-87-18"></a>
</span><span id="__span-87-19"><a id="__codelineno-87-19" name="__codelineno-87-19" href="#__codelineno-87-19"></a>builder = StateGraph(State)
</span><span id="__span-87-20"><a id="__codelineno-87-20" name="__codelineno-87-20" href="#__codelineno-87-20"></a>builder.add_node(&quot;node_1&quot;, subgraph)
</span><span id="__span-87-21"><a id="__codelineno-87-21" name="__codelineno-87-21" href="#__codelineno-87-21"></a>builder.add_edge(START, &quot;node_1&quot;)
</span><span id="__span-87-22"><a id="__codelineno-87-22" name="__codelineno-87-22" href="#__codelineno-87-22"></a>graph = builder.compile()
</span></code></pre></div>
<p><strong>Full example: shared state schemas</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-88-1"><a id="__codelineno-88-1" name="__codelineno-88-1" href="#__codelineno-88-1"></a>from typing_extensions import TypedDict
</span><span id="__span-88-2"><a id="__codelineno-88-2" name="__codelineno-88-2" href="#__codelineno-88-2"></a>from langgraph.graph.state import StateGraph, START
</span><span id="__span-88-3"><a id="__codelineno-88-3" name="__codelineno-88-3" href="#__codelineno-88-3"></a>
</span><span id="__span-88-4"><a id="__codelineno-88-4" name="__codelineno-88-4" href="#__codelineno-88-4"></a># Define subgraph
</span><span id="__span-88-5"><a id="__codelineno-88-5" name="__codelineno-88-5" href="#__codelineno-88-5"></a>class SubgraphState(TypedDict):
</span><span id="__span-88-6"><a id="__codelineno-88-6" name="__codelineno-88-6" href="#__codelineno-88-6"></a>    foo: str  
</span><span id="__span-88-7"><a id="__codelineno-88-7" name="__codelineno-88-7" href="#__codelineno-88-7"></a>    bar: str  
</span><span id="__span-88-8"><a id="__codelineno-88-8" name="__codelineno-88-8" href="#__codelineno-88-8"></a>
</span><span id="__span-88-9"><a id="__codelineno-88-9" name="__codelineno-88-9" href="#__codelineno-88-9"></a>def subgraph_node_1(state: SubgraphState):
</span><span id="__span-88-10"><a id="__codelineno-88-10" name="__codelineno-88-10" href="#__codelineno-88-10"></a>    return {&quot;bar&quot;: &quot;bar&quot;}
</span><span id="__span-88-11"><a id="__codelineno-88-11" name="__codelineno-88-11" href="#__codelineno-88-11"></a>
</span><span id="__span-88-12"><a id="__codelineno-88-12" name="__codelineno-88-12" href="#__codelineno-88-12"></a>def subgraph_node_2(state: SubgraphState):
</span><span id="__span-88-13"><a id="__codelineno-88-13" name="__codelineno-88-13" href="#__codelineno-88-13"></a>    # note that this node is using a state key (&#39;bar&#39;) that is only available in the subgraph
</span><span id="__span-88-14"><a id="__codelineno-88-14" name="__codelineno-88-14" href="#__codelineno-88-14"></a>    # and is sending update on the shared state key (&#39;foo&#39;)
</span><span id="__span-88-15"><a id="__codelineno-88-15" name="__codelineno-88-15" href="#__codelineno-88-15"></a>    return {&quot;foo&quot;: state[&quot;foo&quot;] + state[&quot;bar&quot;]}
</span><span id="__span-88-16"><a id="__codelineno-88-16" name="__codelineno-88-16" href="#__codelineno-88-16"></a>
</span><span id="__span-88-17"><a id="__codelineno-88-17" name="__codelineno-88-17" href="#__codelineno-88-17"></a>subgraph_builder = StateGraph(SubgraphState)
</span><span id="__span-88-18"><a id="__codelineno-88-18" name="__codelineno-88-18" href="#__codelineno-88-18"></a>subgraph_builder.add_node(subgraph_node_1)
</span><span id="__span-88-19"><a id="__codelineno-88-19" name="__codelineno-88-19" href="#__codelineno-88-19"></a>subgraph_builder.add_node(subgraph_node_2)
</span><span id="__span-88-20"><a id="__codelineno-88-20" name="__codelineno-88-20" href="#__codelineno-88-20"></a>subgraph_builder.add_edge(START, &quot;subgraph_node_1&quot;)
</span><span id="__span-88-21"><a id="__codelineno-88-21" name="__codelineno-88-21" href="#__codelineno-88-21"></a>subgraph_builder.add_edge(&quot;subgraph_node_1&quot;, &quot;subgraph_node_2&quot;)
</span><span id="__span-88-22"><a id="__codelineno-88-22" name="__codelineno-88-22" href="#__codelineno-88-22"></a>subgraph = subgraph_builder.compile()
</span><span id="__span-88-23"><a id="__codelineno-88-23" name="__codelineno-88-23" href="#__codelineno-88-23"></a>
</span><span id="__span-88-24"><a id="__codelineno-88-24" name="__codelineno-88-24" href="#__codelineno-88-24"></a># Define parent graph
</span><span id="__span-88-25"><a id="__codelineno-88-25" name="__codelineno-88-25" href="#__codelineno-88-25"></a>class ParentState(TypedDict):
</span><span id="__span-88-26"><a id="__codelineno-88-26" name="__codelineno-88-26" href="#__codelineno-88-26"></a>    foo: str
</span><span id="__span-88-27"><a id="__codelineno-88-27" name="__codelineno-88-27" href="#__codelineno-88-27"></a>
</span><span id="__span-88-28"><a id="__codelineno-88-28" name="__codelineno-88-28" href="#__codelineno-88-28"></a>def node_1(state: ParentState):
</span><span id="__span-88-29"><a id="__codelineno-88-29" name="__codelineno-88-29" href="#__codelineno-88-29"></a>    return {&quot;foo&quot;: &quot;hi! &quot; + state[&quot;foo&quot;]}
</span><span id="__span-88-30"><a id="__codelineno-88-30" name="__codelineno-88-30" href="#__codelineno-88-30"></a>
</span><span id="__span-88-31"><a id="__codelineno-88-31" name="__codelineno-88-31" href="#__codelineno-88-31"></a>builder = StateGraph(ParentState)
</span><span id="__span-88-32"><a id="__codelineno-88-32" name="__codelineno-88-32" href="#__codelineno-88-32"></a>builder.add_node(&quot;node_1&quot;, node_1)
</span><span id="__span-88-33"><a id="__codelineno-88-33" name="__codelineno-88-33" href="#__codelineno-88-33"></a>builder.add_node(&quot;node_2&quot;, subgraph)
</span><span id="__span-88-34"><a id="__codelineno-88-34" name="__codelineno-88-34" href="#__codelineno-88-34"></a>builder.add_edge(START, &quot;node_1&quot;)
</span><span id="__span-88-35"><a id="__codelineno-88-35" name="__codelineno-88-35" href="#__codelineno-88-35"></a>builder.add_edge(&quot;node_1&quot;, &quot;node_2&quot;)
</span><span id="__span-88-36"><a id="__codelineno-88-36" name="__codelineno-88-36" href="#__codelineno-88-36"></a>graph = builder.compile()
</span><span id="__span-88-37"><a id="__codelineno-88-37" name="__codelineno-88-37" href="#__codelineno-88-37"></a>
</span><span id="__span-88-38"><a id="__codelineno-88-38" name="__codelineno-88-38" href="#__codelineno-88-38"></a>for chunk in graph.stream({&quot;foo&quot;: &quot;foo&quot;}):
</span><span id="__span-88-39"><a id="__codelineno-88-39" name="__codelineno-88-39" href="#__codelineno-88-39"></a>    print(chunk)
</span></code></pre></div>
<p><strong>Different state schemas</strong></p>
<p>For more complex systems you might want to define subgraphs that have a <strong>completely different schema</strong> from the parent graph (no shared keys). For example, you might want to keep a private message history for each of the agents in a multi-agent system.</p>
<p>If that's the case for your application, you need to define a node <strong>function that invokes the subgraph</strong>. This function needs to transform the input (parent) state to the subgraph state before invoking the subgraph, and transform the results back to the parent state before returning the state update from the node.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-89-1"><a id="__codelineno-89-1" name="__codelineno-89-1" href="#__codelineno-89-1"></a>from typing_extensions import TypedDict
</span><span id="__span-89-2"><a id="__codelineno-89-2" name="__codelineno-89-2" href="#__codelineno-89-2"></a>from langgraph.graph.state import StateGraph, START
</span><span id="__span-89-3"><a id="__codelineno-89-3" name="__codelineno-89-3" href="#__codelineno-89-3"></a>
</span><span id="__span-89-4"><a id="__codelineno-89-4" name="__codelineno-89-4" href="#__codelineno-89-4"></a>class SubgraphState(TypedDict):
</span><span id="__span-89-5"><a id="__codelineno-89-5" name="__codelineno-89-5" href="#__codelineno-89-5"></a>    bar: str
</span><span id="__span-89-6"><a id="__codelineno-89-6" name="__codelineno-89-6" href="#__codelineno-89-6"></a>
</span><span id="__span-89-7"><a id="__codelineno-89-7" name="__codelineno-89-7" href="#__codelineno-89-7"></a># Subgraph
</span><span id="__span-89-8"><a id="__codelineno-89-8" name="__codelineno-89-8" href="#__codelineno-89-8"></a>
</span><span id="__span-89-9"><a id="__codelineno-89-9" name="__codelineno-89-9" href="#__codelineno-89-9"></a>def subgraph_node_1(state: SubgraphState):
</span><span id="__span-89-10"><a id="__codelineno-89-10" name="__codelineno-89-10" href="#__codelineno-89-10"></a>    return {&quot;bar&quot;: &quot;hi! &quot; + state[&quot;bar&quot;]}
</span><span id="__span-89-11"><a id="__codelineno-89-11" name="__codelineno-89-11" href="#__codelineno-89-11"></a>
</span><span id="__span-89-12"><a id="__codelineno-89-12" name="__codelineno-89-12" href="#__codelineno-89-12"></a>subgraph_builder = StateGraph(SubgraphState)
</span><span id="__span-89-13"><a id="__codelineno-89-13" name="__codelineno-89-13" href="#__codelineno-89-13"></a>subgraph_builder.add_node(subgraph_node_1)
</span><span id="__span-89-14"><a id="__codelineno-89-14" name="__codelineno-89-14" href="#__codelineno-89-14"></a>subgraph_builder.add_edge(START, &quot;subgraph_node_1&quot;)
</span><span id="__span-89-15"><a id="__codelineno-89-15" name="__codelineno-89-15" href="#__codelineno-89-15"></a>subgraph = subgraph_builder.compile()
</span><span id="__span-89-16"><a id="__codelineno-89-16" name="__codelineno-89-16" href="#__codelineno-89-16"></a>
</span><span id="__span-89-17"><a id="__codelineno-89-17" name="__codelineno-89-17" href="#__codelineno-89-17"></a># Parent graph
</span><span id="__span-89-18"><a id="__codelineno-89-18" name="__codelineno-89-18" href="#__codelineno-89-18"></a>
</span><span id="__span-89-19"><a id="__codelineno-89-19" name="__codelineno-89-19" href="#__codelineno-89-19"></a>class State(TypedDict):
</span><span id="__span-89-20"><a id="__codelineno-89-20" name="__codelineno-89-20" href="#__codelineno-89-20"></a>    foo: str
</span><span id="__span-89-21"><a id="__codelineno-89-21" name="__codelineno-89-21" href="#__codelineno-89-21"></a>
</span><span id="__span-89-22"><a id="__codelineno-89-22" name="__codelineno-89-22" href="#__codelineno-89-22"></a>def call_subgraph(state: State):
</span><span id="__span-89-23"><a id="__codelineno-89-23" name="__codelineno-89-23" href="#__codelineno-89-23"></a>    subgraph_output = subgraph.invoke({&quot;bar&quot;: state[&quot;foo&quot;]})  
</span><span id="__span-89-24"><a id="__codelineno-89-24" name="__codelineno-89-24" href="#__codelineno-89-24"></a>    return {&quot;foo&quot;: subgraph_output[&quot;bar&quot;]}  
</span><span id="__span-89-25"><a id="__codelineno-89-25" name="__codelineno-89-25" href="#__codelineno-89-25"></a>
</span><span id="__span-89-26"><a id="__codelineno-89-26" name="__codelineno-89-26" href="#__codelineno-89-26"></a>builder = StateGraph(State)
</span><span id="__span-89-27"><a id="__codelineno-89-27" name="__codelineno-89-27" href="#__codelineno-89-27"></a>builder.add_node(&quot;node_1&quot;, call_subgraph)
</span><span id="__span-89-28"><a id="__codelineno-89-28" name="__codelineno-89-28" href="#__codelineno-89-28"></a>builder.add_edge(START, &quot;node_1&quot;)
</span><span id="__span-89-29"><a id="__codelineno-89-29" name="__codelineno-89-29" href="#__codelineno-89-29"></a>graph = builder.compile()
</span></code></pre></div>
<p><strong>Full example: different state schemas</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-90-1"><a id="__codelineno-90-1" name="__codelineno-90-1" href="#__codelineno-90-1"></a>from typing_extensions import TypedDict
</span><span id="__span-90-2"><a id="__codelineno-90-2" name="__codelineno-90-2" href="#__codelineno-90-2"></a>from langgraph.graph.state import StateGraph, START
</span><span id="__span-90-3"><a id="__codelineno-90-3" name="__codelineno-90-3" href="#__codelineno-90-3"></a>
</span><span id="__span-90-4"><a id="__codelineno-90-4" name="__codelineno-90-4" href="#__codelineno-90-4"></a># Define subgraph
</span><span id="__span-90-5"><a id="__codelineno-90-5" name="__codelineno-90-5" href="#__codelineno-90-5"></a>class SubgraphState(TypedDict):
</span><span id="__span-90-6"><a id="__codelineno-90-6" name="__codelineno-90-6" href="#__codelineno-90-6"></a>    # note that none of these keys are shared with the parent graph state
</span><span id="__span-90-7"><a id="__codelineno-90-7" name="__codelineno-90-7" href="#__codelineno-90-7"></a>    bar: str
</span><span id="__span-90-8"><a id="__codelineno-90-8" name="__codelineno-90-8" href="#__codelineno-90-8"></a>    baz: str
</span><span id="__span-90-9"><a id="__codelineno-90-9" name="__codelineno-90-9" href="#__codelineno-90-9"></a>
</span><span id="__span-90-10"><a id="__codelineno-90-10" name="__codelineno-90-10" href="#__codelineno-90-10"></a>def subgraph_node_1(state: SubgraphState):
</span><span id="__span-90-11"><a id="__codelineno-90-11" name="__codelineno-90-11" href="#__codelineno-90-11"></a>    return {&quot;baz&quot;: &quot;baz&quot;}
</span><span id="__span-90-12"><a id="__codelineno-90-12" name="__codelineno-90-12" href="#__codelineno-90-12"></a>
</span><span id="__span-90-13"><a id="__codelineno-90-13" name="__codelineno-90-13" href="#__codelineno-90-13"></a>def subgraph_node_2(state: SubgraphState):
</span><span id="__span-90-14"><a id="__codelineno-90-14" name="__codelineno-90-14" href="#__codelineno-90-14"></a>    return {&quot;bar&quot;: state[&quot;bar&quot;] + state[&quot;baz&quot;]}
</span><span id="__span-90-15"><a id="__codelineno-90-15" name="__codelineno-90-15" href="#__codelineno-90-15"></a>
</span><span id="__span-90-16"><a id="__codelineno-90-16" name="__codelineno-90-16" href="#__codelineno-90-16"></a>subgraph_builder = StateGraph(SubgraphState)
</span><span id="__span-90-17"><a id="__codelineno-90-17" name="__codelineno-90-17" href="#__codelineno-90-17"></a>subgraph_builder.add_node(subgraph_node_1)
</span><span id="__span-90-18"><a id="__codelineno-90-18" name="__codelineno-90-18" href="#__codelineno-90-18"></a>subgraph_builder.add_node(subgraph_node_2)
</span><span id="__span-90-19"><a id="__codelineno-90-19" name="__codelineno-90-19" href="#__codelineno-90-19"></a>subgraph_builder.add_edge(START, &quot;subgraph_node_1&quot;)
</span><span id="__span-90-20"><a id="__codelineno-90-20" name="__codelineno-90-20" href="#__codelineno-90-20"></a>subgraph_builder.add_edge(&quot;subgraph_node_1&quot;, &quot;subgraph_node_2&quot;)
</span><span id="__span-90-21"><a id="__codelineno-90-21" name="__codelineno-90-21" href="#__codelineno-90-21"></a>subgraph = subgraph_builder.compile()
</span><span id="__span-90-22"><a id="__codelineno-90-22" name="__codelineno-90-22" href="#__codelineno-90-22"></a>
</span><span id="__span-90-23"><a id="__codelineno-90-23" name="__codelineno-90-23" href="#__codelineno-90-23"></a># Define parent graph
</span><span id="__span-90-24"><a id="__codelineno-90-24" name="__codelineno-90-24" href="#__codelineno-90-24"></a>class ParentState(TypedDict):
</span><span id="__span-90-25"><a id="__codelineno-90-25" name="__codelineno-90-25" href="#__codelineno-90-25"></a>    foo: str
</span><span id="__span-90-26"><a id="__codelineno-90-26" name="__codelineno-90-26" href="#__codelineno-90-26"></a>
</span><span id="__span-90-27"><a id="__codelineno-90-27" name="__codelineno-90-27" href="#__codelineno-90-27"></a>def node_1(state: ParentState):
</span><span id="__span-90-28"><a id="__codelineno-90-28" name="__codelineno-90-28" href="#__codelineno-90-28"></a>    return {&quot;foo&quot;: &quot;hi! &quot; + state[&quot;foo&quot;]}
</span><span id="__span-90-29"><a id="__codelineno-90-29" name="__codelineno-90-29" href="#__codelineno-90-29"></a>
</span><span id="__span-90-30"><a id="__codelineno-90-30" name="__codelineno-90-30" href="#__codelineno-90-30"></a>def node_2(state: ParentState):
</span><span id="__span-90-31"><a id="__codelineno-90-31" name="__codelineno-90-31" href="#__codelineno-90-31"></a>    response = subgraph.invoke({&quot;bar&quot;: state[&quot;foo&quot;]})  
</span><span id="__span-90-32"><a id="__codelineno-90-32" name="__codelineno-90-32" href="#__codelineno-90-32"></a>    return {&quot;foo&quot;: response[&quot;bar&quot;]}  
</span><span id="__span-90-33"><a id="__codelineno-90-33" name="__codelineno-90-33" href="#__codelineno-90-33"></a>
</span><span id="__span-90-34"><a id="__codelineno-90-34" name="__codelineno-90-34" href="#__codelineno-90-34"></a>
</span><span id="__span-90-35"><a id="__codelineno-90-35" name="__codelineno-90-35" href="#__codelineno-90-35"></a>builder = StateGraph(ParentState)
</span><span id="__span-90-36"><a id="__codelineno-90-36" name="__codelineno-90-36" href="#__codelineno-90-36"></a>builder.add_node(&quot;node_1&quot;, node_1)
</span><span id="__span-90-37"><a id="__codelineno-90-37" name="__codelineno-90-37" href="#__codelineno-90-37"></a>builder.add_node(&quot;node_2&quot;, node_2)
</span><span id="__span-90-38"><a id="__codelineno-90-38" name="__codelineno-90-38" href="#__codelineno-90-38"></a>builder.add_edge(START, &quot;node_1&quot;)
</span><span id="__span-90-39"><a id="__codelineno-90-39" name="__codelineno-90-39" href="#__codelineno-90-39"></a>builder.add_edge(&quot;node_1&quot;, &quot;node_2&quot;)
</span><span id="__span-90-40"><a id="__codelineno-90-40" name="__codelineno-90-40" href="#__codelineno-90-40"></a>graph = builder.compile()
</span><span id="__span-90-41"><a id="__codelineno-90-41" name="__codelineno-90-41" href="#__codelineno-90-41"></a>
</span><span id="__span-90-42"><a id="__codelineno-90-42" name="__codelineno-90-42" href="#__codelineno-90-42"></a>for chunk in graph.stream({&quot;foo&quot;: &quot;foo&quot;}, subgraphs=True):
</span><span id="__span-90-43"><a id="__codelineno-90-43" name="__codelineno-90-43" href="#__codelineno-90-43"></a>    print(chunk)
</span></code></pre></div>
<p><strong>Full example: different state schemas (two levels of subgraphs)</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-91-1"><a id="__codelineno-91-1" name="__codelineno-91-1" href="#__codelineno-91-1"></a># Grandchild graph
</span><span id="__span-91-2"><a id="__codelineno-91-2" name="__codelineno-91-2" href="#__codelineno-91-2"></a>from typing_extensions import TypedDict
</span><span id="__span-91-3"><a id="__codelineno-91-3" name="__codelineno-91-3" href="#__codelineno-91-3"></a>from langgraph.graph.state import StateGraph, START, END
</span><span id="__span-91-4"><a id="__codelineno-91-4" name="__codelineno-91-4" href="#__codelineno-91-4"></a>
</span><span id="__span-91-5"><a id="__codelineno-91-5" name="__codelineno-91-5" href="#__codelineno-91-5"></a>class GrandChildState(TypedDict):
</span><span id="__span-91-6"><a id="__codelineno-91-6" name="__codelineno-91-6" href="#__codelineno-91-6"></a>    my_grandchild_key: str
</span><span id="__span-91-7"><a id="__codelineno-91-7" name="__codelineno-91-7" href="#__codelineno-91-7"></a>
</span><span id="__span-91-8"><a id="__codelineno-91-8" name="__codelineno-91-8" href="#__codelineno-91-8"></a>def grandchild_1(state: GrandChildState) -&gt; GrandChildState:
</span><span id="__span-91-9"><a id="__codelineno-91-9" name="__codelineno-91-9" href="#__codelineno-91-9"></a>    # NOTE: child or parent keys will not be accessible here
</span><span id="__span-91-10"><a id="__codelineno-91-10" name="__codelineno-91-10" href="#__codelineno-91-10"></a>    return {&quot;my_grandchild_key&quot;: state[&quot;my_grandchild_key&quot;] + &quot;, how are you&quot;}
</span><span id="__span-91-11"><a id="__codelineno-91-11" name="__codelineno-91-11" href="#__codelineno-91-11"></a>
</span><span id="__span-91-12"><a id="__codelineno-91-12" name="__codelineno-91-12" href="#__codelineno-91-12"></a>
</span><span id="__span-91-13"><a id="__codelineno-91-13" name="__codelineno-91-13" href="#__codelineno-91-13"></a>grandchild = StateGraph(GrandChildState)
</span><span id="__span-91-14"><a id="__codelineno-91-14" name="__codelineno-91-14" href="#__codelineno-91-14"></a>grandchild.add_node(&quot;grandchild_1&quot;, grandchild_1)
</span><span id="__span-91-15"><a id="__codelineno-91-15" name="__codelineno-91-15" href="#__codelineno-91-15"></a>
</span><span id="__span-91-16"><a id="__codelineno-91-16" name="__codelineno-91-16" href="#__codelineno-91-16"></a>grandchild.add_edge(START, &quot;grandchild_1&quot;)
</span><span id="__span-91-17"><a id="__codelineno-91-17" name="__codelineno-91-17" href="#__codelineno-91-17"></a>grandchild.add_edge(&quot;grandchild_1&quot;, END)
</span><span id="__span-91-18"><a id="__codelineno-91-18" name="__codelineno-91-18" href="#__codelineno-91-18"></a>
</span><span id="__span-91-19"><a id="__codelineno-91-19" name="__codelineno-91-19" href="#__codelineno-91-19"></a>grandchild_graph = grandchild.compile()
</span><span id="__span-91-20"><a id="__codelineno-91-20" name="__codelineno-91-20" href="#__codelineno-91-20"></a>
</span><span id="__span-91-21"><a id="__codelineno-91-21" name="__codelineno-91-21" href="#__codelineno-91-21"></a># Child graph
</span><span id="__span-91-22"><a id="__codelineno-91-22" name="__codelineno-91-22" href="#__codelineno-91-22"></a>class ChildState(TypedDict):
</span><span id="__span-91-23"><a id="__codelineno-91-23" name="__codelineno-91-23" href="#__codelineno-91-23"></a>    my_child_key: str
</span><span id="__span-91-24"><a id="__codelineno-91-24" name="__codelineno-91-24" href="#__codelineno-91-24"></a>
</span><span id="__span-91-25"><a id="__codelineno-91-25" name="__codelineno-91-25" href="#__codelineno-91-25"></a>def call_grandchild_graph(state: ChildState) -&gt; ChildState:
</span><span id="__span-91-26"><a id="__codelineno-91-26" name="__codelineno-91-26" href="#__codelineno-91-26"></a>    # NOTE: parent or grandchild keys won&#39;t be accessible here
</span><span id="__span-91-27"><a id="__codelineno-91-27" name="__codelineno-91-27" href="#__codelineno-91-27"></a>    grandchild_graph_input = {&quot;my_grandchild_key&quot;: state[&quot;my_child_key&quot;]}  
</span><span id="__span-91-28"><a id="__codelineno-91-28" name="__codelineno-91-28" href="#__codelineno-91-28"></a>    grandchild_graph_output = grandchild_graph.invoke(grandchild_graph_input)
</span><span id="__span-91-29"><a id="__codelineno-91-29" name="__codelineno-91-29" href="#__codelineno-91-29"></a>    return {&quot;my_child_key&quot;: grandchild_graph_output[&quot;my_grandchild_key&quot;] + &quot; today?&quot;}  
</span><span id="__span-91-30"><a id="__codelineno-91-30" name="__codelineno-91-30" href="#__codelineno-91-30"></a>
</span><span id="__span-91-31"><a id="__codelineno-91-31" name="__codelineno-91-31" href="#__codelineno-91-31"></a>child = StateGraph(ChildState)
</span><span id="__span-91-32"><a id="__codelineno-91-32" name="__codelineno-91-32" href="#__codelineno-91-32"></a>child.add_node(&quot;child_1&quot;, call_grandchild_graph)  
</span><span id="__span-91-33"><a id="__codelineno-91-33" name="__codelineno-91-33" href="#__codelineno-91-33"></a>child.add_edge(START, &quot;child_1&quot;)
</span><span id="__span-91-34"><a id="__codelineno-91-34" name="__codelineno-91-34" href="#__codelineno-91-34"></a>child.add_edge(&quot;child_1&quot;, END)
</span><span id="__span-91-35"><a id="__codelineno-91-35" name="__codelineno-91-35" href="#__codelineno-91-35"></a>child_graph = child.compile()
</span><span id="__span-91-36"><a id="__codelineno-91-36" name="__codelineno-91-36" href="#__codelineno-91-36"></a>
</span><span id="__span-91-37"><a id="__codelineno-91-37" name="__codelineno-91-37" href="#__codelineno-91-37"></a># Parent graph
</span><span id="__span-91-38"><a id="__codelineno-91-38" name="__codelineno-91-38" href="#__codelineno-91-38"></a>class ParentState(TypedDict):
</span><span id="__span-91-39"><a id="__codelineno-91-39" name="__codelineno-91-39" href="#__codelineno-91-39"></a>    my_key: str
</span><span id="__span-91-40"><a id="__codelineno-91-40" name="__codelineno-91-40" href="#__codelineno-91-40"></a>
</span><span id="__span-91-41"><a id="__codelineno-91-41" name="__codelineno-91-41" href="#__codelineno-91-41"></a>def parent_1(state: ParentState) -&gt; ParentState:
</span><span id="__span-91-42"><a id="__codelineno-91-42" name="__codelineno-91-42" href="#__codelineno-91-42"></a>    # NOTE: child or grandchild keys won&#39;t be accessible here
</span><span id="__span-91-43"><a id="__codelineno-91-43" name="__codelineno-91-43" href="#__codelineno-91-43"></a>    return {&quot;my_key&quot;: &quot;hi &quot; + state[&quot;my_key&quot;]}
</span><span id="__span-91-44"><a id="__codelineno-91-44" name="__codelineno-91-44" href="#__codelineno-91-44"></a>
</span><span id="__span-91-45"><a id="__codelineno-91-45" name="__codelineno-91-45" href="#__codelineno-91-45"></a>def parent_2(state: ParentState) -&gt; ParentState:
</span><span id="__span-91-46"><a id="__codelineno-91-46" name="__codelineno-91-46" href="#__codelineno-91-46"></a>    return {&quot;my_key&quot;: state[&quot;my_key&quot;] + &quot; bye!&quot;}
</span><span id="__span-91-47"><a id="__codelineno-91-47" name="__codelineno-91-47" href="#__codelineno-91-47"></a>
</span><span id="__span-91-48"><a id="__codelineno-91-48" name="__codelineno-91-48" href="#__codelineno-91-48"></a>def call_child_graph(state: ParentState) -&gt; ParentState:
</span><span id="__span-91-49"><a id="__codelineno-91-49" name="__codelineno-91-49" href="#__codelineno-91-49"></a>    child_graph_input = {&quot;my_child_key&quot;: state[&quot;my_key&quot;]}  
</span><span id="__span-91-50"><a id="__codelineno-91-50" name="__codelineno-91-50" href="#__codelineno-91-50"></a>    child_graph_output = child_graph.invoke(child_graph_input)
</span><span id="__span-91-51"><a id="__codelineno-91-51" name="__codelineno-91-51" href="#__codelineno-91-51"></a>    return {&quot;my_key&quot;: child_graph_output[&quot;my_child_key&quot;]}  
</span><span id="__span-91-52"><a id="__codelineno-91-52" name="__codelineno-91-52" href="#__codelineno-91-52"></a>
</span><span id="__span-91-53"><a id="__codelineno-91-53" name="__codelineno-91-53" href="#__codelineno-91-53"></a>parent = StateGraph(ParentState)
</span><span id="__span-91-54"><a id="__codelineno-91-54" name="__codelineno-91-54" href="#__codelineno-91-54"></a>parent.add_node(&quot;parent_1&quot;, parent_1)
</span><span id="__span-91-55"><a id="__codelineno-91-55" name="__codelineno-91-55" href="#__codelineno-91-55"></a>parent.add_node(&quot;child&quot;, call_child_graph)  
</span><span id="__span-91-56"><a id="__codelineno-91-56" name="__codelineno-91-56" href="#__codelineno-91-56"></a>parent.add_node(&quot;parent_2&quot;, parent_2)
</span><span id="__span-91-57"><a id="__codelineno-91-57" name="__codelineno-91-57" href="#__codelineno-91-57"></a>
</span><span id="__span-91-58"><a id="__codelineno-91-58" name="__codelineno-91-58" href="#__codelineno-91-58"></a>parent.add_edge(START, &quot;parent_1&quot;)
</span><span id="__span-91-59"><a id="__codelineno-91-59" name="__codelineno-91-59" href="#__codelineno-91-59"></a>parent.add_edge(&quot;parent_1&quot;, &quot;child&quot;)
</span><span id="__span-91-60"><a id="__codelineno-91-60" name="__codelineno-91-60" href="#__codelineno-91-60"></a>parent.add_edge(&quot;child&quot;, &quot;parent_2&quot;)
</span><span id="__span-91-61"><a id="__codelineno-91-61" name="__codelineno-91-61" href="#__codelineno-91-61"></a>parent.add_edge(&quot;parent_2&quot;, END)
</span><span id="__span-91-62"><a id="__codelineno-91-62" name="__codelineno-91-62" href="#__codelineno-91-62"></a>
</span><span id="__span-91-63"><a id="__codelineno-91-63" name="__codelineno-91-63" href="#__codelineno-91-63"></a>parent_graph = parent.compile()
</span><span id="__span-91-64"><a id="__codelineno-91-64" name="__codelineno-91-64" href="#__codelineno-91-64"></a>
</span><span id="__span-91-65"><a id="__codelineno-91-65" name="__codelineno-91-65" href="#__codelineno-91-65"></a>for chunk in parent_graph.stream({&quot;my_key&quot;: &quot;Bob&quot;}, subgraphs=True):
</span><span id="__span-91-66"><a id="__codelineno-91-66" name="__codelineno-91-66" href="#__codelineno-91-66"></a>    print(chunk)
</span></code></pre></div>
<p><strong>Add persistence</strong></p>
<p>You only need to <strong>provide the checkpointer when compiling the parent graph</strong>. LangGraph will automatically propagate the checkpointer to the child subgraphs.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-92-1"><a id="__codelineno-92-1" name="__codelineno-92-1" href="#__codelineno-92-1"></a>from langgraph.graph import START, StateGraph
</span><span id="__span-92-2"><a id="__codelineno-92-2" name="__codelineno-92-2" href="#__codelineno-92-2"></a>from langgraph.checkpoint.memory import MemorySaver
</span><span id="__span-92-3"><a id="__codelineno-92-3" name="__codelineno-92-3" href="#__codelineno-92-3"></a>from typing_extensions import TypedDict
</span><span id="__span-92-4"><a id="__codelineno-92-4" name="__codelineno-92-4" href="#__codelineno-92-4"></a>
</span><span id="__span-92-5"><a id="__codelineno-92-5" name="__codelineno-92-5" href="#__codelineno-92-5"></a>class State(TypedDict):
</span><span id="__span-92-6"><a id="__codelineno-92-6" name="__codelineno-92-6" href="#__codelineno-92-6"></a>    foo: str
</span><span id="__span-92-7"><a id="__codelineno-92-7" name="__codelineno-92-7" href="#__codelineno-92-7"></a>
</span><span id="__span-92-8"><a id="__codelineno-92-8" name="__codelineno-92-8" href="#__codelineno-92-8"></a># Subgraph
</span><span id="__span-92-9"><a id="__codelineno-92-9" name="__codelineno-92-9" href="#__codelineno-92-9"></a>
</span><span id="__span-92-10"><a id="__codelineno-92-10" name="__codelineno-92-10" href="#__codelineno-92-10"></a>def subgraph_node_1(state: State):
</span><span id="__span-92-11"><a id="__codelineno-92-11" name="__codelineno-92-11" href="#__codelineno-92-11"></a>    return {&quot;foo&quot;: state[&quot;foo&quot;] + &quot;bar&quot;}
</span><span id="__span-92-12"><a id="__codelineno-92-12" name="__codelineno-92-12" href="#__codelineno-92-12"></a>
</span><span id="__span-92-13"><a id="__codelineno-92-13" name="__codelineno-92-13" href="#__codelineno-92-13"></a>subgraph_builder = StateGraph(State)
</span><span id="__span-92-14"><a id="__codelineno-92-14" name="__codelineno-92-14" href="#__codelineno-92-14"></a>subgraph_builder.add_node(subgraph_node_1)
</span><span id="__span-92-15"><a id="__codelineno-92-15" name="__codelineno-92-15" href="#__codelineno-92-15"></a>subgraph_builder.add_edge(START, &quot;subgraph_node_1&quot;)
</span><span id="__span-92-16"><a id="__codelineno-92-16" name="__codelineno-92-16" href="#__codelineno-92-16"></a>subgraph = subgraph_builder.compile()
</span><span id="__span-92-17"><a id="__codelineno-92-17" name="__codelineno-92-17" href="#__codelineno-92-17"></a>
</span><span id="__span-92-18"><a id="__codelineno-92-18" name="__codelineno-92-18" href="#__codelineno-92-18"></a># Parent graph
</span><span id="__span-92-19"><a id="__codelineno-92-19" name="__codelineno-92-19" href="#__codelineno-92-19"></a>
</span><span id="__span-92-20"><a id="__codelineno-92-20" name="__codelineno-92-20" href="#__codelineno-92-20"></a>builder = StateGraph(State)
</span><span id="__span-92-21"><a id="__codelineno-92-21" name="__codelineno-92-21" href="#__codelineno-92-21"></a>builder.add_node(&quot;node_1&quot;, subgraph)
</span><span id="__span-92-22"><a id="__codelineno-92-22" name="__codelineno-92-22" href="#__codelineno-92-22"></a>builder.add_edge(START, &quot;node_1&quot;)
</span><span id="__span-92-23"><a id="__codelineno-92-23" name="__codelineno-92-23" href="#__codelineno-92-23"></a>
</span><span id="__span-92-24"><a id="__codelineno-92-24" name="__codelineno-92-24" href="#__codelineno-92-24"></a>checkpointer = MemorySaver()
</span><span id="__span-92-25"><a id="__codelineno-92-25" name="__codelineno-92-25" href="#__codelineno-92-25"></a>graph = builder.compile(checkpointer=checkpointer)
</span></code></pre></div>
<p>If you want the subgraph to have its own memory, you can compile it with the appropriate checkpointer option. This is useful in multi-agent systems, if you want agents to keep track of their internal message histories:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-93-1"><a id="__codelineno-93-1" name="__codelineno-93-1" href="#__codelineno-93-1"></a>subgraph_builder = StateGraph(...)
</span><span id="__span-93-2"><a id="__codelineno-93-2" name="__codelineno-93-2" href="#__codelineno-93-2"></a>subgraph = subgraph_builder.compile(checkpointer=True)
</span></code></pre></div>
<p><strong>View subgraph state</strong></p>
<p>When you enable persistence, you can inspect the graph state (checkpoint) via the appropriate method. To view the subgraph state, you can use the subgraphs option.</p>
<p>You can inspect the graph state via <code>graph.get_state(config)</code>. To view the subgraph state, you can use <code>graph.get_state(config, subgraphs=True)</code>.</p>
<p><code>Subgraph state can only be viewed when the subgraph is interrupted. Once you resume the graph, you won't be able to access the subgraph state.</code></p>
<p><strong>View interrupted subgraph state</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-94-1"><a id="__codelineno-94-1" name="__codelineno-94-1" href="#__codelineno-94-1"></a>from langgraph.graph import START, StateGraph
</span><span id="__span-94-2"><a id="__codelineno-94-2" name="__codelineno-94-2" href="#__codelineno-94-2"></a>from langgraph.checkpoint.memory import MemorySaver
</span><span id="__span-94-3"><a id="__codelineno-94-3" name="__codelineno-94-3" href="#__codelineno-94-3"></a>from langgraph.types import interrupt, Command
</span><span id="__span-94-4"><a id="__codelineno-94-4" name="__codelineno-94-4" href="#__codelineno-94-4"></a>from typing_extensions import TypedDict
</span><span id="__span-94-5"><a id="__codelineno-94-5" name="__codelineno-94-5" href="#__codelineno-94-5"></a>
</span><span id="__span-94-6"><a id="__codelineno-94-6" name="__codelineno-94-6" href="#__codelineno-94-6"></a>class State(TypedDict):
</span><span id="__span-94-7"><a id="__codelineno-94-7" name="__codelineno-94-7" href="#__codelineno-94-7"></a>    foo: str
</span><span id="__span-94-8"><a id="__codelineno-94-8" name="__codelineno-94-8" href="#__codelineno-94-8"></a>
</span><span id="__span-94-9"><a id="__codelineno-94-9" name="__codelineno-94-9" href="#__codelineno-94-9"></a># Subgraph
</span><span id="__span-94-10"><a id="__codelineno-94-10" name="__codelineno-94-10" href="#__codelineno-94-10"></a>
</span><span id="__span-94-11"><a id="__codelineno-94-11" name="__codelineno-94-11" href="#__codelineno-94-11"></a>def subgraph_node_1(state: State):
</span><span id="__span-94-12"><a id="__codelineno-94-12" name="__codelineno-94-12" href="#__codelineno-94-12"></a>    value = interrupt(&quot;Provide value:&quot;)
</span><span id="__span-94-13"><a id="__codelineno-94-13" name="__codelineno-94-13" href="#__codelineno-94-13"></a>    return {&quot;foo&quot;: state[&quot;foo&quot;] + value}
</span><span id="__span-94-14"><a id="__codelineno-94-14" name="__codelineno-94-14" href="#__codelineno-94-14"></a>
</span><span id="__span-94-15"><a id="__codelineno-94-15" name="__codelineno-94-15" href="#__codelineno-94-15"></a>subgraph_builder = StateGraph(State)
</span><span id="__span-94-16"><a id="__codelineno-94-16" name="__codelineno-94-16" href="#__codelineno-94-16"></a>subgraph_builder.add_node(subgraph_node_1)
</span><span id="__span-94-17"><a id="__codelineno-94-17" name="__codelineno-94-17" href="#__codelineno-94-17"></a>subgraph_builder.add_edge(START, &quot;subgraph_node_1&quot;)
</span><span id="__span-94-18"><a id="__codelineno-94-18" name="__codelineno-94-18" href="#__codelineno-94-18"></a>
</span><span id="__span-94-19"><a id="__codelineno-94-19" name="__codelineno-94-19" href="#__codelineno-94-19"></a>subgraph = subgraph_builder.compile()
</span><span id="__span-94-20"><a id="__codelineno-94-20" name="__codelineno-94-20" href="#__codelineno-94-20"></a>
</span><span id="__span-94-21"><a id="__codelineno-94-21" name="__codelineno-94-21" href="#__codelineno-94-21"></a># Parent graph
</span><span id="__span-94-22"><a id="__codelineno-94-22" name="__codelineno-94-22" href="#__codelineno-94-22"></a>
</span><span id="__span-94-23"><a id="__codelineno-94-23" name="__codelineno-94-23" href="#__codelineno-94-23"></a>builder = StateGraph(State)
</span><span id="__span-94-24"><a id="__codelineno-94-24" name="__codelineno-94-24" href="#__codelineno-94-24"></a>builder.add_node(&quot;node_1&quot;, subgraph)
</span><span id="__span-94-25"><a id="__codelineno-94-25" name="__codelineno-94-25" href="#__codelineno-94-25"></a>builder.add_edge(START, &quot;node_1&quot;)
</span><span id="__span-94-26"><a id="__codelineno-94-26" name="__codelineno-94-26" href="#__codelineno-94-26"></a>
</span><span id="__span-94-27"><a id="__codelineno-94-27" name="__codelineno-94-27" href="#__codelineno-94-27"></a>checkpointer = MemorySaver()
</span><span id="__span-94-28"><a id="__codelineno-94-28" name="__codelineno-94-28" href="#__codelineno-94-28"></a>graph = builder.compile(checkpointer=checkpointer)
</span><span id="__span-94-29"><a id="__codelineno-94-29" name="__codelineno-94-29" href="#__codelineno-94-29"></a>
</span><span id="__span-94-30"><a id="__codelineno-94-30" name="__codelineno-94-30" href="#__codelineno-94-30"></a>config = {&quot;configurable&quot;: {&quot;thread_id&quot;: &quot;1&quot;}}
</span><span id="__span-94-31"><a id="__codelineno-94-31" name="__codelineno-94-31" href="#__codelineno-94-31"></a>
</span><span id="__span-94-32"><a id="__codelineno-94-32" name="__codelineno-94-32" href="#__codelineno-94-32"></a>graph.invoke({&quot;foo&quot;: &quot;&quot;}, config)
</span><span id="__span-94-33"><a id="__codelineno-94-33" name="__codelineno-94-33" href="#__codelineno-94-33"></a>parent_state = graph.get_state(config)
</span><span id="__span-94-34"><a id="__codelineno-94-34" name="__codelineno-94-34" href="#__codelineno-94-34"></a>subgraph_state = graph.get_state(config, subgraphs=True).tasks[0].state  
</span><span id="__span-94-35"><a id="__codelineno-94-35" name="__codelineno-94-35" href="#__codelineno-94-35"></a>
</span><span id="__span-94-36"><a id="__codelineno-94-36" name="__codelineno-94-36" href="#__codelineno-94-36"></a># resume the subgraph
</span><span id="__span-94-37"><a id="__codelineno-94-37" name="__codelineno-94-37" href="#__codelineno-94-37"></a>graph.invoke(Command(resume=&quot;bar&quot;), config)
</span></code></pre></div>
<p><strong>Stream subgraph outputs</strong></p>
<p>To include outputs from subgraphs in the streamed outputs, you can set the subgraphs option in the stream method of the parent graph. This will stream outputs from both the parent graph and any subgraphs.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-95-1"><a id="__codelineno-95-1" name="__codelineno-95-1" href="#__codelineno-95-1"></a>for chunk in graph.stream(
</span><span id="__span-95-2"><a id="__codelineno-95-2" name="__codelineno-95-2" href="#__codelineno-95-2"></a>    {&quot;foo&quot;: &quot;foo&quot;},
</span><span id="__span-95-3"><a id="__codelineno-95-3" name="__codelineno-95-3" href="#__codelineno-95-3"></a>    subgraphs=True, 
</span><span id="__span-95-4"><a id="__codelineno-95-4" name="__codelineno-95-4" href="#__codelineno-95-4"></a>    stream_mode=&quot;updates&quot;,
</span><span id="__span-95-5"><a id="__codelineno-95-5" name="__codelineno-95-5" href="#__codelineno-95-5"></a>):
</span><span id="__span-95-6"><a id="__codelineno-95-6" name="__codelineno-95-6" href="#__codelineno-95-6"></a>    print(chunk)
</span></code></pre></div>
<p><strong>Stream from subgraphs</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-96-1"><a id="__codelineno-96-1" name="__codelineno-96-1" href="#__codelineno-96-1"></a>from typing_extensions import TypedDict
</span><span id="__span-96-2"><a id="__codelineno-96-2" name="__codelineno-96-2" href="#__codelineno-96-2"></a>from langgraph.graph.state import StateGraph, START
</span><span id="__span-96-3"><a id="__codelineno-96-3" name="__codelineno-96-3" href="#__codelineno-96-3"></a>
</span><span id="__span-96-4"><a id="__codelineno-96-4" name="__codelineno-96-4" href="#__codelineno-96-4"></a># Define subgraph
</span><span id="__span-96-5"><a id="__codelineno-96-5" name="__codelineno-96-5" href="#__codelineno-96-5"></a>class SubgraphState(TypedDict):
</span><span id="__span-96-6"><a id="__codelineno-96-6" name="__codelineno-96-6" href="#__codelineno-96-6"></a>    foo: str
</span><span id="__span-96-7"><a id="__codelineno-96-7" name="__codelineno-96-7" href="#__codelineno-96-7"></a>    bar: str
</span><span id="__span-96-8"><a id="__codelineno-96-8" name="__codelineno-96-8" href="#__codelineno-96-8"></a>
</span><span id="__span-96-9"><a id="__codelineno-96-9" name="__codelineno-96-9" href="#__codelineno-96-9"></a>def subgraph_node_1(state: SubgraphState):
</span><span id="__span-96-10"><a id="__codelineno-96-10" name="__codelineno-96-10" href="#__codelineno-96-10"></a>    return {&quot;bar&quot;: &quot;bar&quot;}
</span><span id="__span-96-11"><a id="__codelineno-96-11" name="__codelineno-96-11" href="#__codelineno-96-11"></a>
</span><span id="__span-96-12"><a id="__codelineno-96-12" name="__codelineno-96-12" href="#__codelineno-96-12"></a>def subgraph_node_2(state: SubgraphState):
</span><span id="__span-96-13"><a id="__codelineno-96-13" name="__codelineno-96-13" href="#__codelineno-96-13"></a>    # note that this node is using a state key (&#39;bar&#39;) that is only available in the subgraph
</span><span id="__span-96-14"><a id="__codelineno-96-14" name="__codelineno-96-14" href="#__codelineno-96-14"></a>    # and is sending update on the shared state key (&#39;foo&#39;)
</span><span id="__span-96-15"><a id="__codelineno-96-15" name="__codelineno-96-15" href="#__codelineno-96-15"></a>    return {&quot;foo&quot;: state[&quot;foo&quot;] + state[&quot;bar&quot;]}
</span><span id="__span-96-16"><a id="__codelineno-96-16" name="__codelineno-96-16" href="#__codelineno-96-16"></a>
</span><span id="__span-96-17"><a id="__codelineno-96-17" name="__codelineno-96-17" href="#__codelineno-96-17"></a>subgraph_builder = StateGraph(SubgraphState)
</span><span id="__span-96-18"><a id="__codelineno-96-18" name="__codelineno-96-18" href="#__codelineno-96-18"></a>subgraph_builder.add_node(subgraph_node_1)
</span><span id="__span-96-19"><a id="__codelineno-96-19" name="__codelineno-96-19" href="#__codelineno-96-19"></a>subgraph_builder.add_node(subgraph_node_2)
</span><span id="__span-96-20"><a id="__codelineno-96-20" name="__codelineno-96-20" href="#__codelineno-96-20"></a>subgraph_builder.add_edge(START, &quot;subgraph_node_1&quot;)
</span><span id="__span-96-21"><a id="__codelineno-96-21" name="__codelineno-96-21" href="#__codelineno-96-21"></a>subgraph_builder.add_edge(&quot;subgraph_node_1&quot;, &quot;subgraph_node_2&quot;)
</span><span id="__span-96-22"><a id="__codelineno-96-22" name="__codelineno-96-22" href="#__codelineno-96-22"></a>subgraph = subgraph_builder.compile()
</span><span id="__span-96-23"><a id="__codelineno-96-23" name="__codelineno-96-23" href="#__codelineno-96-23"></a>
</span><span id="__span-96-24"><a id="__codelineno-96-24" name="__codelineno-96-24" href="#__codelineno-96-24"></a># Define parent graph
</span><span id="__span-96-25"><a id="__codelineno-96-25" name="__codelineno-96-25" href="#__codelineno-96-25"></a>class ParentState(TypedDict):
</span><span id="__span-96-26"><a id="__codelineno-96-26" name="__codelineno-96-26" href="#__codelineno-96-26"></a>    foo: str
</span><span id="__span-96-27"><a id="__codelineno-96-27" name="__codelineno-96-27" href="#__codelineno-96-27"></a>
</span><span id="__span-96-28"><a id="__codelineno-96-28" name="__codelineno-96-28" href="#__codelineno-96-28"></a>def node_1(state: ParentState):
</span><span id="__span-96-29"><a id="__codelineno-96-29" name="__codelineno-96-29" href="#__codelineno-96-29"></a>    return {&quot;foo&quot;: &quot;hi! &quot; + state[&quot;foo&quot;]}
</span><span id="__span-96-30"><a id="__codelineno-96-30" name="__codelineno-96-30" href="#__codelineno-96-30"></a>
</span><span id="__span-96-31"><a id="__codelineno-96-31" name="__codelineno-96-31" href="#__codelineno-96-31"></a>builder = StateGraph(ParentState)
</span><span id="__span-96-32"><a id="__codelineno-96-32" name="__codelineno-96-32" href="#__codelineno-96-32"></a>builder.add_node(&quot;node_1&quot;, node_1)
</span><span id="__span-96-33"><a id="__codelineno-96-33" name="__codelineno-96-33" href="#__codelineno-96-33"></a>builder.add_node(&quot;node_2&quot;, subgraph)
</span><span id="__span-96-34"><a id="__codelineno-96-34" name="__codelineno-96-34" href="#__codelineno-96-34"></a>builder.add_edge(START, &quot;node_1&quot;)
</span><span id="__span-96-35"><a id="__codelineno-96-35" name="__codelineno-96-35" href="#__codelineno-96-35"></a>builder.add_edge(&quot;node_1&quot;, &quot;node_2&quot;)
</span><span id="__span-96-36"><a id="__codelineno-96-36" name="__codelineno-96-36" href="#__codelineno-96-36"></a>graph = builder.compile()
</span><span id="__span-96-37"><a id="__codelineno-96-37" name="__codelineno-96-37" href="#__codelineno-96-37"></a>
</span><span id="__span-96-38"><a id="__codelineno-96-38" name="__codelineno-96-38" href="#__codelineno-96-38"></a>for chunk in graph.stream(
</span><span id="__span-96-39"><a id="__codelineno-96-39" name="__codelineno-96-39" href="#__codelineno-96-39"></a>    {&quot;foo&quot;: &quot;foo&quot;},
</span><span id="__span-96-40"><a id="__codelineno-96-40" name="__codelineno-96-40" href="#__codelineno-96-40"></a>    stream_mode=&quot;updates&quot;,
</span><span id="__span-96-41"><a id="__codelineno-96-41" name="__codelineno-96-41" href="#__codelineno-96-41"></a>    subgraphs=True, 
</span><span id="__span-96-42"><a id="__codelineno-96-42" name="__codelineno-96-42" href="#__codelineno-96-42"></a>):
</span><span id="__span-96-43"><a id="__codelineno-96-43" name="__codelineno-96-43" href="#__codelineno-96-43"></a>    print(chunk)
</span></code></pre></div>
<h2 id="multi-agent-systems">Multi-agent systems<a class="headerlink" href="#multi-agent-systems" title="Permanent link">#</a></h2>
<p>An agent is a system that uses an LLM to decide the control flow of an application. As you develop these systems, they might grow more complex over time, making them harder to manage and scale. For example, you might run into the following problems:</p>
<ul>
<li>
<p>agent has too many tools at its disposal and makes poor decisions about which tool to call next</p>
</li>
<li>
<p>context grows too complex for a single agent to keep track of</p>
</li>
<li>
<p>there is a need for multiple specialization areas in the system (e.g. planner, researcher, math expert, etc.)</p>
</li>
</ul>
<p>To tackle these, you might consider breaking your application into multiple smaller, independent agents and composing them into a <strong>multi-agent system</strong>.These independent agents can be as simple as a prompt and an LLM call, or as complex as a ReAct agent (and more!).</p>
<p>The primary benefits of using multi-agent systems are:</p>
<ul>
<li>
<p><strong>Modularity:</strong> Separate agents make it easier to develop, test, and maintain agentic systems.</p>
</li>
<li>
<p><strong>Specialization:</strong> You can create expert agents focused on specific domains, which helps with the overall system performance.</p>
</li>
<li>
<p><strong>Control:</strong> You can explicitly control how agents communicate (as opposed to relying on function calling).</p>
</li>
</ul>
<h2 id="multi-agent-architectures">Multi-agent architectures<a class="headerlink" href="#multi-agent-architectures" title="Permanent link">#</a></h2>
<p><img alt="alt text" src="./image/langgraph11.png" /></p>
<p>There are several ways to connect agents in a multi-agent system:</p>
<ul>
<li>
<p><strong>Network:</strong> each agent can communicate with every other agent. Any agent can decide which other agent to call next.</p>
</li>
<li>
<p><strong>Supervisor:</strong> each agent communicates with a single supervisor agent. Supervisor agent makes decisions on which agent should be called next.</p>
</li>
<li>
<p><strong>Supervisor (tool-calling):</strong> this is a special case of supervisor architecture. Individual agents can be represented as tools. In this case, a supervisor agent uses a tool-calling LLM to decide which of the agent tools to call, as well as the arguments to pass to those agents.</p>
</li>
<li>
<p><strong>Hierarchical:</strong> you can define a multi-agent system with a supervisor of supervisors. This is a generalization of the supervisor architecture and allows for more complex control flows.</p>
</li>
<li>
<p><strong>Custom multi-agent workflow:</strong> each agent communicates with only a subset of agents. Parts of the flow are deterministic, and only some agents can decide which other agents to call next.</p>
</li>
</ul>
<p><strong>Handoffs</strong></p>
<p>In multi-agent architectures, agents can be represented as graph nodes. Each agent node executes its step(s) and decides whether to finish execution or route to another agent, including potentially routing to itself (e.g., running in a loop). A common pattern in multi-agent interactions is <strong>handoffs</strong>, where one agent hands off control to another. Handoffs allow you to specify:</p>
<ul>
<li>
<p><strong>destination:</strong> target agent to navigate to (e.g., name of the node to go to)</p>
</li>
<li>
<p><strong>payload:</strong> information to pass to that agent (e.g., state update)</p>
</li>
</ul>
<p>To implement handoffs in LangGraph, agent nodes can return Command object that allows you to combine both control flow and state updates:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-97-1"><a id="__codelineno-97-1" name="__codelineno-97-1" href="#__codelineno-97-1"></a>def agent(state) -&gt; Command[Literal[&quot;agent&quot;, &quot;another_agent&quot;]]:
</span><span id="__span-97-2"><a id="__codelineno-97-2" name="__codelineno-97-2" href="#__codelineno-97-2"></a>    # the condition for routing/halting can be anything, e.g. LLM tool call / structured output, etc.
</span><span id="__span-97-3"><a id="__codelineno-97-3" name="__codelineno-97-3" href="#__codelineno-97-3"></a>    goto = get_next_agent(...)  # &#39;agent&#39; / &#39;another_agent&#39;
</span><span id="__span-97-4"><a id="__codelineno-97-4" name="__codelineno-97-4" href="#__codelineno-97-4"></a>    return Command(
</span><span id="__span-97-5"><a id="__codelineno-97-5" name="__codelineno-97-5" href="#__codelineno-97-5"></a>        # Specify which agent to call next
</span><span id="__span-97-6"><a id="__codelineno-97-6" name="__codelineno-97-6" href="#__codelineno-97-6"></a>        goto=goto,
</span><span id="__span-97-7"><a id="__codelineno-97-7" name="__codelineno-97-7" href="#__codelineno-97-7"></a>        # Update the graph state
</span><span id="__span-97-8"><a id="__codelineno-97-8" name="__codelineno-97-8" href="#__codelineno-97-8"></a>        update={&quot;my_state_key&quot;: &quot;my_state_value&quot;}
</span><span id="__span-97-9"><a id="__codelineno-97-9" name="__codelineno-97-9" href="#__codelineno-97-9"></a>    )
</span></code></pre></div>
<p>In a more complex scenario where each agent node is itself a graph (i.e., a subgraph), a node in one of the agent subgraphs might want to navigate to a different agent. For example, if you have two agents, alice and bob (subgraph nodes in a parent graph), and alice needs to navigate to bob, you can set <code>graph=Command.PARENT</code> in the Command object:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-98-1"><a id="__codelineno-98-1" name="__codelineno-98-1" href="#__codelineno-98-1"></a>def some_node_inside_alice(state):
</span><span id="__span-98-2"><a id="__codelineno-98-2" name="__codelineno-98-2" href="#__codelineno-98-2"></a>    return Command(
</span><span id="__span-98-3"><a id="__codelineno-98-3" name="__codelineno-98-3" href="#__codelineno-98-3"></a>        goto=&quot;bob&quot;,
</span><span id="__span-98-4"><a id="__codelineno-98-4" name="__codelineno-98-4" href="#__codelineno-98-4"></a>        update={&quot;my_state_key&quot;: &quot;my_state_value&quot;},
</span><span id="__span-98-5"><a id="__codelineno-98-5" name="__codelineno-98-5" href="#__codelineno-98-5"></a>        # specify which graph to navigate to (defaults to the current graph)
</span><span id="__span-98-6"><a id="__codelineno-98-6" name="__codelineno-98-6" href="#__codelineno-98-6"></a>        graph=Command.PARENT,
</span><span id="__span-98-7"><a id="__codelineno-98-7" name="__codelineno-98-7" href="#__codelineno-98-7"></a>    )
</span></code></pre></div>
<p>If you need to support visualization for subgraphs communicating using Command(graph=Command.PARENT) you would need to wrap them in a node function with Command annotation: Instead of this:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-99-1"><a id="__codelineno-99-1" name="__codelineno-99-1" href="#__codelineno-99-1"></a>builder.add_node(alice)
</span></code></pre></div>
<p>you would need to do this:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-100-1"><a id="__codelineno-100-1" name="__codelineno-100-1" href="#__codelineno-100-1"></a>def call_alice(state) -&gt; Command[Literal[&quot;bob&quot;]]:
</span><span id="__span-100-2"><a id="__codelineno-100-2" name="__codelineno-100-2" href="#__codelineno-100-2"></a>    return alice.invoke(state)
</span><span id="__span-100-3"><a id="__codelineno-100-3" name="__codelineno-100-3" href="#__codelineno-100-3"></a>
</span><span id="__span-100-4"><a id="__codelineno-100-4" name="__codelineno-100-4" href="#__codelineno-100-4"></a>builder.add_node(&quot;alice&quot;, call_alice)
</span></code></pre></div>
<p><strong>Handoffs as tools</strong></p>
<p>One of the most common agent types is a tool-calling agent. For those types of agents, a common pattern is wrapping a handoff in a tool call:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-101-1"><a id="__codelineno-101-1" name="__codelineno-101-1" href="#__codelineno-101-1"></a>from langchain_core.tools import tool
</span><span id="__span-101-2"><a id="__codelineno-101-2" name="__codelineno-101-2" href="#__codelineno-101-2"></a>
</span><span id="__span-101-3"><a id="__codelineno-101-3" name="__codelineno-101-3" href="#__codelineno-101-3"></a>@tool
</span><span id="__span-101-4"><a id="__codelineno-101-4" name="__codelineno-101-4" href="#__codelineno-101-4"></a>def transfer_to_bob():
</span><span id="__span-101-5"><a id="__codelineno-101-5" name="__codelineno-101-5" href="#__codelineno-101-5"></a>    &quot;&quot;&quot;Transfer to bob.&quot;&quot;&quot;
</span><span id="__span-101-6"><a id="__codelineno-101-6" name="__codelineno-101-6" href="#__codelineno-101-6"></a>    return Command(
</span><span id="__span-101-7"><a id="__codelineno-101-7" name="__codelineno-101-7" href="#__codelineno-101-7"></a>        # name of the agent (node) to go to
</span><span id="__span-101-8"><a id="__codelineno-101-8" name="__codelineno-101-8" href="#__codelineno-101-8"></a>        goto=&quot;bob&quot;,
</span><span id="__span-101-9"><a id="__codelineno-101-9" name="__codelineno-101-9" href="#__codelineno-101-9"></a>        # data to send to the agent
</span><span id="__span-101-10"><a id="__codelineno-101-10" name="__codelineno-101-10" href="#__codelineno-101-10"></a>        update={&quot;my_state_key&quot;: &quot;my_state_value&quot;},
</span><span id="__span-101-11"><a id="__codelineno-101-11" name="__codelineno-101-11" href="#__codelineno-101-11"></a>        # indicate to LangGraph that we need to navigate to
</span><span id="__span-101-12"><a id="__codelineno-101-12" name="__codelineno-101-12" href="#__codelineno-101-12"></a>        # agent node in a parent graph
</span><span id="__span-101-13"><a id="__codelineno-101-13" name="__codelineno-101-13" href="#__codelineno-101-13"></a>        graph=Command.PARENT,
</span><span id="__span-101-14"><a id="__codelineno-101-14" name="__codelineno-101-14" href="#__codelineno-101-14"></a>    )
</span></code></pre></div>
<p>This is a special case of updating the graph state from tools where, in addition to the state update, the control flow is included as well.</p>
<p>If you want to use tools that return Command, you can use the prebuilt create_react_agent / ToolNode components, or else implement your own logic:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-102-1"><a id="__codelineno-102-1" name="__codelineno-102-1" href="#__codelineno-102-1"></a>def call_tools(state):
</span><span id="__span-102-2"><a id="__codelineno-102-2" name="__codelineno-102-2" href="#__codelineno-102-2"></a>    ...
</span><span id="__span-102-3"><a id="__codelineno-102-3" name="__codelineno-102-3" href="#__codelineno-102-3"></a>    commands = [tools_by_name[tool_call[&quot;name&quot;]].invoke(tool_call) for tool_call in tool_calls]
</span><span id="__span-102-4"><a id="__codelineno-102-4" name="__codelineno-102-4" href="#__codelineno-102-4"></a>    return commands
</span></code></pre></div>
<p><strong>Network</strong></p>
<p>In this architecture, agents are defined as graph nodes. Each agent can communicate with every other agent (many-to-many connections) and can decide which agent to call next. This architecture is good for problems that do not have a clear hierarchy of agents or a specific sequence in which agents should be called.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-103-1"><a id="__codelineno-103-1" name="__codelineno-103-1" href="#__codelineno-103-1"></a>from typing import Literal
</span><span id="__span-103-2"><a id="__codelineno-103-2" name="__codelineno-103-2" href="#__codelineno-103-2"></a>from langchain_openai import ChatOpenAI
</span><span id="__span-103-3"><a id="__codelineno-103-3" name="__codelineno-103-3" href="#__codelineno-103-3"></a>from langgraph.types import Command
</span><span id="__span-103-4"><a id="__codelineno-103-4" name="__codelineno-103-4" href="#__codelineno-103-4"></a>from langgraph.graph import StateGraph, MessagesState, START, END
</span><span id="__span-103-5"><a id="__codelineno-103-5" name="__codelineno-103-5" href="#__codelineno-103-5"></a>
</span><span id="__span-103-6"><a id="__codelineno-103-6" name="__codelineno-103-6" href="#__codelineno-103-6"></a>model = ChatOpenAI()
</span><span id="__span-103-7"><a id="__codelineno-103-7" name="__codelineno-103-7" href="#__codelineno-103-7"></a>
</span><span id="__span-103-8"><a id="__codelineno-103-8" name="__codelineno-103-8" href="#__codelineno-103-8"></a>def agent_1(state: MessagesState) -&gt; Command[Literal[&quot;agent_2&quot;, &quot;agent_3&quot;, END]]:
</span><span id="__span-103-9"><a id="__codelineno-103-9" name="__codelineno-103-9" href="#__codelineno-103-9"></a>    # you can pass relevant parts of the state to the LLM (e.g., state[&quot;messages&quot;])
</span><span id="__span-103-10"><a id="__codelineno-103-10" name="__codelineno-103-10" href="#__codelineno-103-10"></a>    # to determine which agent to call next. a common pattern is to call the model
</span><span id="__span-103-11"><a id="__codelineno-103-11" name="__codelineno-103-11" href="#__codelineno-103-11"></a>    # with a structured output (e.g. force it to return an output with a &quot;next_agent&quot; field)
</span><span id="__span-103-12"><a id="__codelineno-103-12" name="__codelineno-103-12" href="#__codelineno-103-12"></a>    response = model.invoke(...)
</span><span id="__span-103-13"><a id="__codelineno-103-13" name="__codelineno-103-13" href="#__codelineno-103-13"></a>    # route to one of the agents or exit based on the LLM&#39;s decision
</span><span id="__span-103-14"><a id="__codelineno-103-14" name="__codelineno-103-14" href="#__codelineno-103-14"></a>    # if the LLM returns &quot;__end__&quot;, the graph will finish execution
</span><span id="__span-103-15"><a id="__codelineno-103-15" name="__codelineno-103-15" href="#__codelineno-103-15"></a>    return Command(
</span><span id="__span-103-16"><a id="__codelineno-103-16" name="__codelineno-103-16" href="#__codelineno-103-16"></a>        goto=response[&quot;next_agent&quot;],
</span><span id="__span-103-17"><a id="__codelineno-103-17" name="__codelineno-103-17" href="#__codelineno-103-17"></a>        update={&quot;messages&quot;: [response[&quot;content&quot;]]},
</span><span id="__span-103-18"><a id="__codelineno-103-18" name="__codelineno-103-18" href="#__codelineno-103-18"></a>    )
</span><span id="__span-103-19"><a id="__codelineno-103-19" name="__codelineno-103-19" href="#__codelineno-103-19"></a>
</span><span id="__span-103-20"><a id="__codelineno-103-20" name="__codelineno-103-20" href="#__codelineno-103-20"></a>def agent_2(state: MessagesState) -&gt; Command[Literal[&quot;agent_1&quot;, &quot;agent_3&quot;, END]]:
</span><span id="__span-103-21"><a id="__codelineno-103-21" name="__codelineno-103-21" href="#__codelineno-103-21"></a>    response = model.invoke(...)
</span><span id="__span-103-22"><a id="__codelineno-103-22" name="__codelineno-103-22" href="#__codelineno-103-22"></a>    return Command(
</span><span id="__span-103-23"><a id="__codelineno-103-23" name="__codelineno-103-23" href="#__codelineno-103-23"></a>        goto=response[&quot;next_agent&quot;],
</span><span id="__span-103-24"><a id="__codelineno-103-24" name="__codelineno-103-24" href="#__codelineno-103-24"></a>        update={&quot;messages&quot;: [response[&quot;content&quot;]]},
</span><span id="__span-103-25"><a id="__codelineno-103-25" name="__codelineno-103-25" href="#__codelineno-103-25"></a>    )
</span><span id="__span-103-26"><a id="__codelineno-103-26" name="__codelineno-103-26" href="#__codelineno-103-26"></a>
</span><span id="__span-103-27"><a id="__codelineno-103-27" name="__codelineno-103-27" href="#__codelineno-103-27"></a>def agent_3(state: MessagesState) -&gt; Command[Literal[&quot;agent_1&quot;, &quot;agent_2&quot;, END]]:
</span><span id="__span-103-28"><a id="__codelineno-103-28" name="__codelineno-103-28" href="#__codelineno-103-28"></a>    ...
</span><span id="__span-103-29"><a id="__codelineno-103-29" name="__codelineno-103-29" href="#__codelineno-103-29"></a>    return Command(
</span><span id="__span-103-30"><a id="__codelineno-103-30" name="__codelineno-103-30" href="#__codelineno-103-30"></a>        goto=response[&quot;next_agent&quot;],
</span><span id="__span-103-31"><a id="__codelineno-103-31" name="__codelineno-103-31" href="#__codelineno-103-31"></a>        update={&quot;messages&quot;: [response[&quot;content&quot;]]},
</span><span id="__span-103-32"><a id="__codelineno-103-32" name="__codelineno-103-32" href="#__codelineno-103-32"></a>    )
</span><span id="__span-103-33"><a id="__codelineno-103-33" name="__codelineno-103-33" href="#__codelineno-103-33"></a>
</span><span id="__span-103-34"><a id="__codelineno-103-34" name="__codelineno-103-34" href="#__codelineno-103-34"></a>builder = StateGraph(MessagesState)
</span><span id="__span-103-35"><a id="__codelineno-103-35" name="__codelineno-103-35" href="#__codelineno-103-35"></a>builder.add_node(agent_1)
</span><span id="__span-103-36"><a id="__codelineno-103-36" name="__codelineno-103-36" href="#__codelineno-103-36"></a>builder.add_node(agent_2)
</span><span id="__span-103-37"><a id="__codelineno-103-37" name="__codelineno-103-37" href="#__codelineno-103-37"></a>builder.add_node(agent_3)
</span><span id="__span-103-38"><a id="__codelineno-103-38" name="__codelineno-103-38" href="#__codelineno-103-38"></a>
</span><span id="__span-103-39"><a id="__codelineno-103-39" name="__codelineno-103-39" href="#__codelineno-103-39"></a>builder.add_edge(START, &quot;agent_1&quot;)
</span><span id="__span-103-40"><a id="__codelineno-103-40" name="__codelineno-103-40" href="#__codelineno-103-40"></a>network = builder.compile()
</span></code></pre></div>
<p><strong>Supervisor</strong></p>
<p>In this architecture, we define agents as nodes and add a supervisor node (LLM) that decides which agent nodes should be called next. We use Command to route execution to the appropriate agent node based on supervisor's decision. This architecture also lends itself well to running multiple agents in parallel or using <code>map-reduce pattern</code>.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-104-1"><a id="__codelineno-104-1" name="__codelineno-104-1" href="#__codelineno-104-1"></a>from typing import Literal
</span><span id="__span-104-2"><a id="__codelineno-104-2" name="__codelineno-104-2" href="#__codelineno-104-2"></a>from langchain_openai import ChatOpenAI
</span><span id="__span-104-3"><a id="__codelineno-104-3" name="__codelineno-104-3" href="#__codelineno-104-3"></a>from langgraph.types import Command
</span><span id="__span-104-4"><a id="__codelineno-104-4" name="__codelineno-104-4" href="#__codelineno-104-4"></a>from langgraph.graph import StateGraph, MessagesState, START, END
</span><span id="__span-104-5"><a id="__codelineno-104-5" name="__codelineno-104-5" href="#__codelineno-104-5"></a>
</span><span id="__span-104-6"><a id="__codelineno-104-6" name="__codelineno-104-6" href="#__codelineno-104-6"></a>model = ChatOpenAI()
</span><span id="__span-104-7"><a id="__codelineno-104-7" name="__codelineno-104-7" href="#__codelineno-104-7"></a>
</span><span id="__span-104-8"><a id="__codelineno-104-8" name="__codelineno-104-8" href="#__codelineno-104-8"></a>def supervisor(state: MessagesState) -&gt; Command[Literal[&quot;agent_1&quot;, &quot;agent_2&quot;, END]]:
</span><span id="__span-104-9"><a id="__codelineno-104-9" name="__codelineno-104-9" href="#__codelineno-104-9"></a>    # you can pass relevant parts of the state to the LLM (e.g., state[&quot;messages&quot;])
</span><span id="__span-104-10"><a id="__codelineno-104-10" name="__codelineno-104-10" href="#__codelineno-104-10"></a>    # to determine which agent to call next. a common pattern is to call the model
</span><span id="__span-104-11"><a id="__codelineno-104-11" name="__codelineno-104-11" href="#__codelineno-104-11"></a>    # with a structured output (e.g. force it to return an output with a &quot;next_agent&quot; field)
</span><span id="__span-104-12"><a id="__codelineno-104-12" name="__codelineno-104-12" href="#__codelineno-104-12"></a>    response = model.invoke(...)
</span><span id="__span-104-13"><a id="__codelineno-104-13" name="__codelineno-104-13" href="#__codelineno-104-13"></a>    # route to one of the agents or exit based on the supervisor&#39;s decision
</span><span id="__span-104-14"><a id="__codelineno-104-14" name="__codelineno-104-14" href="#__codelineno-104-14"></a>    # if the supervisor returns &quot;__end__&quot;, the graph will finish execution
</span><span id="__span-104-15"><a id="__codelineno-104-15" name="__codelineno-104-15" href="#__codelineno-104-15"></a>    return Command(goto=response[&quot;next_agent&quot;])
</span><span id="__span-104-16"><a id="__codelineno-104-16" name="__codelineno-104-16" href="#__codelineno-104-16"></a>
</span><span id="__span-104-17"><a id="__codelineno-104-17" name="__codelineno-104-17" href="#__codelineno-104-17"></a>def agent_1(state: MessagesState) -&gt; Command[Literal[&quot;supervisor&quot;]]:
</span><span id="__span-104-18"><a id="__codelineno-104-18" name="__codelineno-104-18" href="#__codelineno-104-18"></a>    # you can pass relevant parts of the state to the LLM (e.g., state[&quot;messages&quot;])
</span><span id="__span-104-19"><a id="__codelineno-104-19" name="__codelineno-104-19" href="#__codelineno-104-19"></a>    # and add any additional logic (different models, custom prompts, structured output, etc.)
</span><span id="__span-104-20"><a id="__codelineno-104-20" name="__codelineno-104-20" href="#__codelineno-104-20"></a>    response = model.invoke(...)
</span><span id="__span-104-21"><a id="__codelineno-104-21" name="__codelineno-104-21" href="#__codelineno-104-21"></a>    return Command(
</span><span id="__span-104-22"><a id="__codelineno-104-22" name="__codelineno-104-22" href="#__codelineno-104-22"></a>        goto=&quot;supervisor&quot;,
</span><span id="__span-104-23"><a id="__codelineno-104-23" name="__codelineno-104-23" href="#__codelineno-104-23"></a>        update={&quot;messages&quot;: [response]},
</span><span id="__span-104-24"><a id="__codelineno-104-24" name="__codelineno-104-24" href="#__codelineno-104-24"></a>    )
</span><span id="__span-104-25"><a id="__codelineno-104-25" name="__codelineno-104-25" href="#__codelineno-104-25"></a>
</span><span id="__span-104-26"><a id="__codelineno-104-26" name="__codelineno-104-26" href="#__codelineno-104-26"></a>def agent_2(state: MessagesState) -&gt; Command[Literal[&quot;supervisor&quot;]]:
</span><span id="__span-104-27"><a id="__codelineno-104-27" name="__codelineno-104-27" href="#__codelineno-104-27"></a>    response = model.invoke(...)
</span><span id="__span-104-28"><a id="__codelineno-104-28" name="__codelineno-104-28" href="#__codelineno-104-28"></a>    return Command(
</span><span id="__span-104-29"><a id="__codelineno-104-29" name="__codelineno-104-29" href="#__codelineno-104-29"></a>        goto=&quot;supervisor&quot;,
</span><span id="__span-104-30"><a id="__codelineno-104-30" name="__codelineno-104-30" href="#__codelineno-104-30"></a>        update={&quot;messages&quot;: [response]},
</span><span id="__span-104-31"><a id="__codelineno-104-31" name="__codelineno-104-31" href="#__codelineno-104-31"></a>    )
</span><span id="__span-104-32"><a id="__codelineno-104-32" name="__codelineno-104-32" href="#__codelineno-104-32"></a>
</span><span id="__span-104-33"><a id="__codelineno-104-33" name="__codelineno-104-33" href="#__codelineno-104-33"></a>builder = StateGraph(MessagesState)
</span><span id="__span-104-34"><a id="__codelineno-104-34" name="__codelineno-104-34" href="#__codelineno-104-34"></a>builder.add_node(supervisor)
</span><span id="__span-104-35"><a id="__codelineno-104-35" name="__codelineno-104-35" href="#__codelineno-104-35"></a>builder.add_node(agent_1)
</span><span id="__span-104-36"><a id="__codelineno-104-36" name="__codelineno-104-36" href="#__codelineno-104-36"></a>builder.add_node(agent_2)
</span><span id="__span-104-37"><a id="__codelineno-104-37" name="__codelineno-104-37" href="#__codelineno-104-37"></a>
</span><span id="__span-104-38"><a id="__codelineno-104-38" name="__codelineno-104-38" href="#__codelineno-104-38"></a>builder.add_edge(START, &quot;supervisor&quot;)
</span><span id="__span-104-39"><a id="__codelineno-104-39" name="__codelineno-104-39" href="#__codelineno-104-39"></a>
</span><span id="__span-104-40"><a id="__codelineno-104-40" name="__codelineno-104-40" href="#__codelineno-104-40"></a>supervisor = builder.compile()
</span></code></pre></div>
<p><strong>Supervisor (tool-calling)</strong></p>
<p>In this variant of the supervisor architecture, we define a supervisor agent which is responsible for calling sub-agents. The sub-agents are exposed to the supervisor as tools, and the supervisor agent decides which tool to call next. The supervisor agent follows a standard implementation as an LLM running in a while loop calling tools until it decides to stop.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-105-1"><a id="__codelineno-105-1" name="__codelineno-105-1" href="#__codelineno-105-1"></a>from typing import Annotated
</span><span id="__span-105-2"><a id="__codelineno-105-2" name="__codelineno-105-2" href="#__codelineno-105-2"></a>from langchain_openai import ChatOpenAI
</span><span id="__span-105-3"><a id="__codelineno-105-3" name="__codelineno-105-3" href="#__codelineno-105-3"></a>from langgraph.prebuilt import InjectedState, create_react_agent
</span><span id="__span-105-4"><a id="__codelineno-105-4" name="__codelineno-105-4" href="#__codelineno-105-4"></a>
</span><span id="__span-105-5"><a id="__codelineno-105-5" name="__codelineno-105-5" href="#__codelineno-105-5"></a>model = ChatOpenAI()
</span><span id="__span-105-6"><a id="__codelineno-105-6" name="__codelineno-105-6" href="#__codelineno-105-6"></a>
</span><span id="__span-105-7"><a id="__codelineno-105-7" name="__codelineno-105-7" href="#__codelineno-105-7"></a># this is the agent function that will be called as tool
</span><span id="__span-105-8"><a id="__codelineno-105-8" name="__codelineno-105-8" href="#__codelineno-105-8"></a># notice that you can pass the state to the tool via InjectedState annotation
</span><span id="__span-105-9"><a id="__codelineno-105-9" name="__codelineno-105-9" href="#__codelineno-105-9"></a>def agent_1(state: Annotated[dict, InjectedState]):
</span><span id="__span-105-10"><a id="__codelineno-105-10" name="__codelineno-105-10" href="#__codelineno-105-10"></a>    # you can pass relevant parts of the state to the LLM (e.g., state[&quot;messages&quot;])
</span><span id="__span-105-11"><a id="__codelineno-105-11" name="__codelineno-105-11" href="#__codelineno-105-11"></a>    # and add any additional logic (different models, custom prompts, structured output, etc.)
</span><span id="__span-105-12"><a id="__codelineno-105-12" name="__codelineno-105-12" href="#__codelineno-105-12"></a>    response = model.invoke(...)
</span><span id="__span-105-13"><a id="__codelineno-105-13" name="__codelineno-105-13" href="#__codelineno-105-13"></a>    # return the LLM response as a string (expected tool response format)
</span><span id="__span-105-14"><a id="__codelineno-105-14" name="__codelineno-105-14" href="#__codelineno-105-14"></a>    # this will be automatically turned to ToolMessage
</span><span id="__span-105-15"><a id="__codelineno-105-15" name="__codelineno-105-15" href="#__codelineno-105-15"></a>    # by the prebuilt create_react_agent (supervisor)
</span><span id="__span-105-16"><a id="__codelineno-105-16" name="__codelineno-105-16" href="#__codelineno-105-16"></a>    return response.content
</span><span id="__span-105-17"><a id="__codelineno-105-17" name="__codelineno-105-17" href="#__codelineno-105-17"></a>
</span><span id="__span-105-18"><a id="__codelineno-105-18" name="__codelineno-105-18" href="#__codelineno-105-18"></a>def agent_2(state: Annotated[dict, InjectedState]):
</span><span id="__span-105-19"><a id="__codelineno-105-19" name="__codelineno-105-19" href="#__codelineno-105-19"></a>    response = model.invoke(...)
</span><span id="__span-105-20"><a id="__codelineno-105-20" name="__codelineno-105-20" href="#__codelineno-105-20"></a>    return response.content
</span><span id="__span-105-21"><a id="__codelineno-105-21" name="__codelineno-105-21" href="#__codelineno-105-21"></a>
</span><span id="__span-105-22"><a id="__codelineno-105-22" name="__codelineno-105-22" href="#__codelineno-105-22"></a>tools = [agent_1, agent_2]
</span><span id="__span-105-23"><a id="__codelineno-105-23" name="__codelineno-105-23" href="#__codelineno-105-23"></a># the simplest way to build a supervisor w/ tool-calling is to use prebuilt ReAct agent graph
</span><span id="__span-105-24"><a id="__codelineno-105-24" name="__codelineno-105-24" href="#__codelineno-105-24"></a># that consists of a tool-calling LLM node (i.e. supervisor) and a tool-executing node
</span><span id="__span-105-25"><a id="__codelineno-105-25" name="__codelineno-105-25" href="#__codelineno-105-25"></a>supervisor = create_react_agent(model, tools)
</span></code></pre></div>
<p><strong>Hierarchical</strong></p>
<p>As you add more agents to your system, it might become too hard for the supervisor to manage all of them. The supervisor might start making poor decisions about which agent to call next, or the context might become too complex for a single supervisor to keep track of. In other words, you end up with the same problems that motivated the multi-agent architecture in the first place.</p>
<p>To address this, you can design your system hierarchically. For example, you can create separate, specialized teams of agents managed by individual supervisors, and a top-level supervisor to manage the teams.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-106-1"><a id="__codelineno-106-1" name="__codelineno-106-1" href="#__codelineno-106-1"></a>from typing import Literal
</span><span id="__span-106-2"><a id="__codelineno-106-2" name="__codelineno-106-2" href="#__codelineno-106-2"></a>from langchain_openai import ChatOpenAI
</span><span id="__span-106-3"><a id="__codelineno-106-3" name="__codelineno-106-3" href="#__codelineno-106-3"></a>from langgraph.graph import StateGraph, MessagesState, START, END
</span><span id="__span-106-4"><a id="__codelineno-106-4" name="__codelineno-106-4" href="#__codelineno-106-4"></a>from langgraph.types import Command
</span><span id="__span-106-5"><a id="__codelineno-106-5" name="__codelineno-106-5" href="#__codelineno-106-5"></a>model = ChatOpenAI()
</span><span id="__span-106-6"><a id="__codelineno-106-6" name="__codelineno-106-6" href="#__codelineno-106-6"></a>
</span><span id="__span-106-7"><a id="__codelineno-106-7" name="__codelineno-106-7" href="#__codelineno-106-7"></a># define team 1 (same as the single supervisor example above)
</span><span id="__span-106-8"><a id="__codelineno-106-8" name="__codelineno-106-8" href="#__codelineno-106-8"></a>
</span><span id="__span-106-9"><a id="__codelineno-106-9" name="__codelineno-106-9" href="#__codelineno-106-9"></a>def team_1_supervisor(state: MessagesState) -&gt; Command[Literal[&quot;team_1_agent_1&quot;, &quot;team_1_agent_2&quot;, END]]:
</span><span id="__span-106-10"><a id="__codelineno-106-10" name="__codelineno-106-10" href="#__codelineno-106-10"></a>    response = model.invoke(...)
</span><span id="__span-106-11"><a id="__codelineno-106-11" name="__codelineno-106-11" href="#__codelineno-106-11"></a>    return Command(goto=response[&quot;next_agent&quot;])
</span><span id="__span-106-12"><a id="__codelineno-106-12" name="__codelineno-106-12" href="#__codelineno-106-12"></a>
</span><span id="__span-106-13"><a id="__codelineno-106-13" name="__codelineno-106-13" href="#__codelineno-106-13"></a>def team_1_agent_1(state: MessagesState) -&gt; Command[Literal[&quot;team_1_supervisor&quot;]]:
</span><span id="__span-106-14"><a id="__codelineno-106-14" name="__codelineno-106-14" href="#__codelineno-106-14"></a>    response = model.invoke(...)
</span><span id="__span-106-15"><a id="__codelineno-106-15" name="__codelineno-106-15" href="#__codelineno-106-15"></a>    return Command(goto=&quot;team_1_supervisor&quot;, update={&quot;messages&quot;: [response]})
</span><span id="__span-106-16"><a id="__codelineno-106-16" name="__codelineno-106-16" href="#__codelineno-106-16"></a>
</span><span id="__span-106-17"><a id="__codelineno-106-17" name="__codelineno-106-17" href="#__codelineno-106-17"></a>def team_1_agent_2(state: MessagesState) -&gt; Command[Literal[&quot;team_1_supervisor&quot;]]:
</span><span id="__span-106-18"><a id="__codelineno-106-18" name="__codelineno-106-18" href="#__codelineno-106-18"></a>    response = model.invoke(...)
</span><span id="__span-106-19"><a id="__codelineno-106-19" name="__codelineno-106-19" href="#__codelineno-106-19"></a>    return Command(goto=&quot;team_1_supervisor&quot;, update={&quot;messages&quot;: [response]})
</span><span id="__span-106-20"><a id="__codelineno-106-20" name="__codelineno-106-20" href="#__codelineno-106-20"></a>
</span><span id="__span-106-21"><a id="__codelineno-106-21" name="__codelineno-106-21" href="#__codelineno-106-21"></a>team_1_builder = StateGraph(Team1State)
</span><span id="__span-106-22"><a id="__codelineno-106-22" name="__codelineno-106-22" href="#__codelineno-106-22"></a>team_1_builder.add_node(team_1_supervisor)
</span><span id="__span-106-23"><a id="__codelineno-106-23" name="__codelineno-106-23" href="#__codelineno-106-23"></a>team_1_builder.add_node(team_1_agent_1)
</span><span id="__span-106-24"><a id="__codelineno-106-24" name="__codelineno-106-24" href="#__codelineno-106-24"></a>team_1_builder.add_node(team_1_agent_2)
</span><span id="__span-106-25"><a id="__codelineno-106-25" name="__codelineno-106-25" href="#__codelineno-106-25"></a>team_1_builder.add_edge(START, &quot;team_1_supervisor&quot;)
</span><span id="__span-106-26"><a id="__codelineno-106-26" name="__codelineno-106-26" href="#__codelineno-106-26"></a>team_1_graph = team_1_builder.compile()
</span><span id="__span-106-27"><a id="__codelineno-106-27" name="__codelineno-106-27" href="#__codelineno-106-27"></a>
</span><span id="__span-106-28"><a id="__codelineno-106-28" name="__codelineno-106-28" href="#__codelineno-106-28"></a># define team 2 (same as the single supervisor example above)
</span><span id="__span-106-29"><a id="__codelineno-106-29" name="__codelineno-106-29" href="#__codelineno-106-29"></a>class Team2State(MessagesState):
</span><span id="__span-106-30"><a id="__codelineno-106-30" name="__codelineno-106-30" href="#__codelineno-106-30"></a>    next: Literal[&quot;team_2_agent_1&quot;, &quot;team_2_agent_2&quot;, &quot;__end__&quot;]
</span><span id="__span-106-31"><a id="__codelineno-106-31" name="__codelineno-106-31" href="#__codelineno-106-31"></a>
</span><span id="__span-106-32"><a id="__codelineno-106-32" name="__codelineno-106-32" href="#__codelineno-106-32"></a>def team_2_supervisor(state: Team2State):
</span><span id="__span-106-33"><a id="__codelineno-106-33" name="__codelineno-106-33" href="#__codelineno-106-33"></a>    ...
</span><span id="__span-106-34"><a id="__codelineno-106-34" name="__codelineno-106-34" href="#__codelineno-106-34"></a>
</span><span id="__span-106-35"><a id="__codelineno-106-35" name="__codelineno-106-35" href="#__codelineno-106-35"></a>def team_2_agent_1(state: Team2State):
</span><span id="__span-106-36"><a id="__codelineno-106-36" name="__codelineno-106-36" href="#__codelineno-106-36"></a>    ...
</span><span id="__span-106-37"><a id="__codelineno-106-37" name="__codelineno-106-37" href="#__codelineno-106-37"></a>
</span><span id="__span-106-38"><a id="__codelineno-106-38" name="__codelineno-106-38" href="#__codelineno-106-38"></a>def team_2_agent_2(state: Team2State):
</span><span id="__span-106-39"><a id="__codelineno-106-39" name="__codelineno-106-39" href="#__codelineno-106-39"></a>    ...
</span><span id="__span-106-40"><a id="__codelineno-106-40" name="__codelineno-106-40" href="#__codelineno-106-40"></a>
</span><span id="__span-106-41"><a id="__codelineno-106-41" name="__codelineno-106-41" href="#__codelineno-106-41"></a>team_2_builder = StateGraph(Team2State)
</span><span id="__span-106-42"><a id="__codelineno-106-42" name="__codelineno-106-42" href="#__codelineno-106-42"></a>...
</span><span id="__span-106-43"><a id="__codelineno-106-43" name="__codelineno-106-43" href="#__codelineno-106-43"></a>team_2_graph = team_2_builder.compile()
</span><span id="__span-106-44"><a id="__codelineno-106-44" name="__codelineno-106-44" href="#__codelineno-106-44"></a>
</span><span id="__span-106-45"><a id="__codelineno-106-45" name="__codelineno-106-45" href="#__codelineno-106-45"></a>
</span><span id="__span-106-46"><a id="__codelineno-106-46" name="__codelineno-106-46" href="#__codelineno-106-46"></a># define top-level supervisor
</span><span id="__span-106-47"><a id="__codelineno-106-47" name="__codelineno-106-47" href="#__codelineno-106-47"></a>
</span><span id="__span-106-48"><a id="__codelineno-106-48" name="__codelineno-106-48" href="#__codelineno-106-48"></a>builder = StateGraph(MessagesState)
</span><span id="__span-106-49"><a id="__codelineno-106-49" name="__codelineno-106-49" href="#__codelineno-106-49"></a>def top_level_supervisor(state: MessagesState) -&gt; Command[Literal[&quot;team_1_graph&quot;, &quot;team_2_graph&quot;, END]]:
</span><span id="__span-106-50"><a id="__codelineno-106-50" name="__codelineno-106-50" href="#__codelineno-106-50"></a>    # you can pass relevant parts of the state to the LLM (e.g., state[&quot;messages&quot;])
</span><span id="__span-106-51"><a id="__codelineno-106-51" name="__codelineno-106-51" href="#__codelineno-106-51"></a>    # to determine which team to call next. a common pattern is to call the model
</span><span id="__span-106-52"><a id="__codelineno-106-52" name="__codelineno-106-52" href="#__codelineno-106-52"></a>    # with a structured output (e.g. force it to return an output with a &quot;next_team&quot; field)
</span><span id="__span-106-53"><a id="__codelineno-106-53" name="__codelineno-106-53" href="#__codelineno-106-53"></a>    response = model.invoke(...)
</span><span id="__span-106-54"><a id="__codelineno-106-54" name="__codelineno-106-54" href="#__codelineno-106-54"></a>    # route to one of the teams or exit based on the supervisor&#39;s decision
</span><span id="__span-106-55"><a id="__codelineno-106-55" name="__codelineno-106-55" href="#__codelineno-106-55"></a>    # if the supervisor returns &quot;__end__&quot;, the graph will finish execution
</span><span id="__span-106-56"><a id="__codelineno-106-56" name="__codelineno-106-56" href="#__codelineno-106-56"></a>    return Command(goto=response[&quot;next_team&quot;])
</span><span id="__span-106-57"><a id="__codelineno-106-57" name="__codelineno-106-57" href="#__codelineno-106-57"></a>
</span><span id="__span-106-58"><a id="__codelineno-106-58" name="__codelineno-106-58" href="#__codelineno-106-58"></a>builder = StateGraph(MessagesState)
</span><span id="__span-106-59"><a id="__codelineno-106-59" name="__codelineno-106-59" href="#__codelineno-106-59"></a>builder.add_node(top_level_supervisor)
</span><span id="__span-106-60"><a id="__codelineno-106-60" name="__codelineno-106-60" href="#__codelineno-106-60"></a>builder.add_node(&quot;team_1_graph&quot;, team_1_graph)
</span><span id="__span-106-61"><a id="__codelineno-106-61" name="__codelineno-106-61" href="#__codelineno-106-61"></a>builder.add_node(&quot;team_2_graph&quot;, team_2_graph)
</span><span id="__span-106-62"><a id="__codelineno-106-62" name="__codelineno-106-62" href="#__codelineno-106-62"></a>builder.add_edge(START, &quot;top_level_supervisor&quot;)
</span><span id="__span-106-63"><a id="__codelineno-106-63" name="__codelineno-106-63" href="#__codelineno-106-63"></a>builder.add_edge(&quot;team_1_graph&quot;, &quot;top_level_supervisor&quot;)
</span><span id="__span-106-64"><a id="__codelineno-106-64" name="__codelineno-106-64" href="#__codelineno-106-64"></a>builder.add_edge(&quot;team_2_graph&quot;, &quot;top_level_supervisor&quot;)
</span><span id="__span-106-65"><a id="__codelineno-106-65" name="__codelineno-106-65" href="#__codelineno-106-65"></a>graph = builder.compile()
</span></code></pre></div>
<p><strong>Custom multi-agent workflow</strong></p>
<p>In this architecture we add individual agents as graph nodes and define the order in which agents are called ahead of time, in a custom workflow. In LangGraph the workflow can be defined in two ways:</p>
<ul>
<li>
<p><strong>Explicit control flow (normal edges):</strong> LangGraph allows you to explicitly define the control flow of your application (i.e. the sequence of how agents communicate) explicitly, via normal graph edges. This is the most deterministic variant of this architecture above — we always know which agent will be called next ahead of time.</p>
</li>
<li>
<p><strong>Dynamic control flow (Command):</strong> in LangGraph you can allow LLMs to decide parts of your application control flow. This can be achieved by using Command. A special case of this is a supervisor tool-calling architecture. In that case, the tool-calling LLM powering the supervisor agent will make decisions about the order in which the tools (agents) are being called.</p>
</li>
</ul>
<div class="language-text highlight"><pre><span></span><code><span id="__span-107-1"><a id="__codelineno-107-1" name="__codelineno-107-1" href="#__codelineno-107-1"></a>from langchain_openai import ChatOpenAI
</span><span id="__span-107-2"><a id="__codelineno-107-2" name="__codelineno-107-2" href="#__codelineno-107-2"></a>from langgraph.graph import StateGraph, MessagesState, START
</span><span id="__span-107-3"><a id="__codelineno-107-3" name="__codelineno-107-3" href="#__codelineno-107-3"></a>
</span><span id="__span-107-4"><a id="__codelineno-107-4" name="__codelineno-107-4" href="#__codelineno-107-4"></a>model = ChatOpenAI()
</span><span id="__span-107-5"><a id="__codelineno-107-5" name="__codelineno-107-5" href="#__codelineno-107-5"></a>
</span><span id="__span-107-6"><a id="__codelineno-107-6" name="__codelineno-107-6" href="#__codelineno-107-6"></a>def agent_1(state: MessagesState):
</span><span id="__span-107-7"><a id="__codelineno-107-7" name="__codelineno-107-7" href="#__codelineno-107-7"></a>    response = model.invoke(...)
</span><span id="__span-107-8"><a id="__codelineno-107-8" name="__codelineno-107-8" href="#__codelineno-107-8"></a>    return {&quot;messages&quot;: [response]}
</span><span id="__span-107-9"><a id="__codelineno-107-9" name="__codelineno-107-9" href="#__codelineno-107-9"></a>
</span><span id="__span-107-10"><a id="__codelineno-107-10" name="__codelineno-107-10" href="#__codelineno-107-10"></a>def agent_2(state: MessagesState):
</span><span id="__span-107-11"><a id="__codelineno-107-11" name="__codelineno-107-11" href="#__codelineno-107-11"></a>    response = model.invoke(...)
</span><span id="__span-107-12"><a id="__codelineno-107-12" name="__codelineno-107-12" href="#__codelineno-107-12"></a>    return {&quot;messages&quot;: [response]}
</span><span id="__span-107-13"><a id="__codelineno-107-13" name="__codelineno-107-13" href="#__codelineno-107-13"></a>
</span><span id="__span-107-14"><a id="__codelineno-107-14" name="__codelineno-107-14" href="#__codelineno-107-14"></a>builder = StateGraph(MessagesState)
</span><span id="__span-107-15"><a id="__codelineno-107-15" name="__codelineno-107-15" href="#__codelineno-107-15"></a>builder.add_node(agent_1)
</span><span id="__span-107-16"><a id="__codelineno-107-16" name="__codelineno-107-16" href="#__codelineno-107-16"></a>builder.add_node(agent_2)
</span><span id="__span-107-17"><a id="__codelineno-107-17" name="__codelineno-107-17" href="#__codelineno-107-17"></a># define the flow explicitly
</span><span id="__span-107-18"><a id="__codelineno-107-18" name="__codelineno-107-18" href="#__codelineno-107-18"></a>builder.add_edge(START, &quot;agent_1&quot;)
</span><span id="__span-107-19"><a id="__codelineno-107-19" name="__codelineno-107-19" href="#__codelineno-107-19"></a>builder.add_edge(&quot;agent_1&quot;, &quot;agent_2&quot;)
</span></code></pre></div>
<p><strong>Communication and state management</strong></p>
<p>The most important thing when building multi-agent systems is figuring out how the agents communicate.</p>
<p><strong>Handoffs vs tool calls</strong></p>
<p>What is the "payload" that is being passed around between agents? In most of the architectures discussed above, the agents communicate via handoffs and pass the graph state as part of the handoff payload. Specifically, agents pass around lists of messages as part of the graph state. In the case of the supervisor with tool-calling, the payloads are tool call arguments.</p>
<p><img alt="alt text" src="./image/langgraph12.png" /></p>
<p><strong>Message passing between agents</strong></p>
<p>The most common way for agents to communicate is via a shared state channel, typically a list of messages. This assumes that there is always at least a single channel (key) in the state that is shared by the agents (e.g., messages). When communicating via a shared message list, there is an additional consideration: should the agents share the full history of their thought process or only the final result?</p>
<p><img alt="alt text" src="./image/langgraph13.png" /></p>
<p><strong>Sharing full thought process</strong></p>
<p>Agents can share the full history of their thought process (i.e., "scratchpad") with all other agents. This "scratchpad" would typically look like a list of messages. The benefit of sharing the full thought process is that it might help other agents make better decisions and improve reasoning ability for the system as a whole. The downside is that as the number of agents and their complexity grows, the "scratchpad" will grow quickly and might require additional strategies for memory management.</p>
<p><strong>Sharing only final results</strong></p>
<p>Agents can have their own private "scratchpad" and only share the final result with the rest of the agents. This approach might work better for systems with many agents or agents that are more complex. In this case, you would need to define agents with different state schemas.</p>
<p>For agents called as tools, the supervisor determines the inputs based on the tool schema. Additionally, LangGraph allows passing state to individual tools at runtime, so subordinate agents can access parent state, if needed.</p>
<p><strong>Indicating agent name in messages</strong></p>
<p>It can be helpful to indicate which agent a particular AI message is from, especially for long message histories. Some LLM providers (like OpenAI) support adding a name parameter to messages — you can use that to attach the agent name to the message. If that is not supported, you can consider manually injecting the agent name into the message content, e.g., <agent>alice</agent><message>message from alice</message>.</p>
<h2 id="multi-agent">Multi-agent<a class="headerlink" href="#multi-agent" title="Permanent link">#</a></h2>
<p>A single agent might struggle if it needs to specialize in multiple domains or manage many tools. To tackle this, you can break your agent into smaller, independent agents and compose them into a multi-agent system.</p>
<p>In multi-agent systems, agents need to communicate between each other. They do so via handoffs — a primitive that describes which agent to hand control to and the payload to send to that agent.</p>
<p>Two of the most popular multi-agent architectures are:</p>
<ul>
<li>
<p><strong>supervisor</strong> — individual agents are coordinated by a central supervisor agent. The supervisor controls all communication flow and task delegation, making decisions about which agent to invoke based on the current context and task requirements.</p>
</li>
<li>
<p><strong>swarm</strong> — agents dynamically hand off control to one another based on their specializations. The system remembers which agent was last active, ensuring that on subsequent interactions, the conversation resumes with that agent.</p>
</li>
</ul>
<p><img alt="alt text" src="./image/langgraph14.png" /></p>
<p>Use <code>langgraph-supervisor</code> library to create a supervisor multi-agent system:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-108-1"><a id="__codelineno-108-1" name="__codelineno-108-1" href="#__codelineno-108-1"></a>pip install langgraph-supervisor
</span></code></pre></div>
<div class="language-text highlight"><pre><span></span><code><span id="__span-109-1"><a id="__codelineno-109-1" name="__codelineno-109-1" href="#__codelineno-109-1"></a>from langchain_openai import ChatOpenAI
</span><span id="__span-109-2"><a id="__codelineno-109-2" name="__codelineno-109-2" href="#__codelineno-109-2"></a>from langgraph.prebuilt import create_react_agent
</span><span id="__span-109-3"><a id="__codelineno-109-3" name="__codelineno-109-3" href="#__codelineno-109-3"></a>from langgraph_supervisor import create_supervisor
</span><span id="__span-109-4"><a id="__codelineno-109-4" name="__codelineno-109-4" href="#__codelineno-109-4"></a>
</span><span id="__span-109-5"><a id="__codelineno-109-5" name="__codelineno-109-5" href="#__codelineno-109-5"></a>def book_hotel(hotel_name: str):
</span><span id="__span-109-6"><a id="__codelineno-109-6" name="__codelineno-109-6" href="#__codelineno-109-6"></a>    &quot;&quot;&quot;Book a hotel&quot;&quot;&quot;
</span><span id="__span-109-7"><a id="__codelineno-109-7" name="__codelineno-109-7" href="#__codelineno-109-7"></a>    return f&quot;Successfully booked a stay at {hotel_name}.&quot;
</span><span id="__span-109-8"><a id="__codelineno-109-8" name="__codelineno-109-8" href="#__codelineno-109-8"></a>
</span><span id="__span-109-9"><a id="__codelineno-109-9" name="__codelineno-109-9" href="#__codelineno-109-9"></a>def book_flight(from_airport: str, to_airport: str):
</span><span id="__span-109-10"><a id="__codelineno-109-10" name="__codelineno-109-10" href="#__codelineno-109-10"></a>    &quot;&quot;&quot;Book a flight&quot;&quot;&quot;
</span><span id="__span-109-11"><a id="__codelineno-109-11" name="__codelineno-109-11" href="#__codelineno-109-11"></a>    return f&quot;Successfully booked a flight from {from_airport} to {to_airport}.&quot;
</span><span id="__span-109-12"><a id="__codelineno-109-12" name="__codelineno-109-12" href="#__codelineno-109-12"></a>
</span><span id="__span-109-13"><a id="__codelineno-109-13" name="__codelineno-109-13" href="#__codelineno-109-13"></a>flight_assistant = create_react_agent(
</span><span id="__span-109-14"><a id="__codelineno-109-14" name="__codelineno-109-14" href="#__codelineno-109-14"></a>    model=&quot;openai:gpt-4o&quot;,
</span><span id="__span-109-15"><a id="__codelineno-109-15" name="__codelineno-109-15" href="#__codelineno-109-15"></a>    tools=[book_flight],
</span><span id="__span-109-16"><a id="__codelineno-109-16" name="__codelineno-109-16" href="#__codelineno-109-16"></a>    prompt=&quot;You are a flight booking assistant&quot;,
</span><span id="__span-109-17"><a id="__codelineno-109-17" name="__codelineno-109-17" href="#__codelineno-109-17"></a>    name=&quot;flight_assistant&quot;
</span><span id="__span-109-18"><a id="__codelineno-109-18" name="__codelineno-109-18" href="#__codelineno-109-18"></a>)
</span><span id="__span-109-19"><a id="__codelineno-109-19" name="__codelineno-109-19" href="#__codelineno-109-19"></a>
</span><span id="__span-109-20"><a id="__codelineno-109-20" name="__codelineno-109-20" href="#__codelineno-109-20"></a>hotel_assistant = create_react_agent(
</span><span id="__span-109-21"><a id="__codelineno-109-21" name="__codelineno-109-21" href="#__codelineno-109-21"></a>    model=&quot;openai:gpt-4o&quot;,
</span><span id="__span-109-22"><a id="__codelineno-109-22" name="__codelineno-109-22" href="#__codelineno-109-22"></a>    tools=[book_hotel],
</span><span id="__span-109-23"><a id="__codelineno-109-23" name="__codelineno-109-23" href="#__codelineno-109-23"></a>    prompt=&quot;You are a hotel booking assistant&quot;,
</span><span id="__span-109-24"><a id="__codelineno-109-24" name="__codelineno-109-24" href="#__codelineno-109-24"></a>    name=&quot;hotel_assistant&quot;
</span><span id="__span-109-25"><a id="__codelineno-109-25" name="__codelineno-109-25" href="#__codelineno-109-25"></a>)
</span><span id="__span-109-26"><a id="__codelineno-109-26" name="__codelineno-109-26" href="#__codelineno-109-26"></a>
</span><span id="__span-109-27"><a id="__codelineno-109-27" name="__codelineno-109-27" href="#__codelineno-109-27"></a>supervisor = create_supervisor(
</span><span id="__span-109-28"><a id="__codelineno-109-28" name="__codelineno-109-28" href="#__codelineno-109-28"></a>    agents=[flight_assistant, hotel_assistant],
</span><span id="__span-109-29"><a id="__codelineno-109-29" name="__codelineno-109-29" href="#__codelineno-109-29"></a>    model=ChatOpenAI(model=&quot;gpt-4o&quot;),
</span><span id="__span-109-30"><a id="__codelineno-109-30" name="__codelineno-109-30" href="#__codelineno-109-30"></a>    prompt=(
</span><span id="__span-109-31"><a id="__codelineno-109-31" name="__codelineno-109-31" href="#__codelineno-109-31"></a>        &quot;You manage a hotel booking assistant and a&quot;
</span><span id="__span-109-32"><a id="__codelineno-109-32" name="__codelineno-109-32" href="#__codelineno-109-32"></a>        &quot;flight booking assistant. Assign work to them.&quot;
</span><span id="__span-109-33"><a id="__codelineno-109-33" name="__codelineno-109-33" href="#__codelineno-109-33"></a>    )
</span><span id="__span-109-34"><a id="__codelineno-109-34" name="__codelineno-109-34" href="#__codelineno-109-34"></a>).compile()
</span><span id="__span-109-35"><a id="__codelineno-109-35" name="__codelineno-109-35" href="#__codelineno-109-35"></a>
</span><span id="__span-109-36"><a id="__codelineno-109-36" name="__codelineno-109-36" href="#__codelineno-109-36"></a>for chunk in supervisor.stream(
</span><span id="__span-109-37"><a id="__codelineno-109-37" name="__codelineno-109-37" href="#__codelineno-109-37"></a>    {
</span><span id="__span-109-38"><a id="__codelineno-109-38" name="__codelineno-109-38" href="#__codelineno-109-38"></a>        &quot;messages&quot;: [
</span><span id="__span-109-39"><a id="__codelineno-109-39" name="__codelineno-109-39" href="#__codelineno-109-39"></a>            {
</span><span id="__span-109-40"><a id="__codelineno-109-40" name="__codelineno-109-40" href="#__codelineno-109-40"></a>                &quot;role&quot;: &quot;user&quot;,
</span><span id="__span-109-41"><a id="__codelineno-109-41" name="__codelineno-109-41" href="#__codelineno-109-41"></a>                &quot;content&quot;: &quot;book a flight from BOS to JFK and a stay at McKittrick Hotel&quot;
</span><span id="__span-109-42"><a id="__codelineno-109-42" name="__codelineno-109-42" href="#__codelineno-109-42"></a>            }
</span><span id="__span-109-43"><a id="__codelineno-109-43" name="__codelineno-109-43" href="#__codelineno-109-43"></a>        ]
</span><span id="__span-109-44"><a id="__codelineno-109-44" name="__codelineno-109-44" href="#__codelineno-109-44"></a>    }
</span><span id="__span-109-45"><a id="__codelineno-109-45" name="__codelineno-109-45" href="#__codelineno-109-45"></a>):
</span><span id="__span-109-46"><a id="__codelineno-109-46" name="__codelineno-109-46" href="#__codelineno-109-46"></a>    print(chunk)
</span><span id="__span-109-47"><a id="__codelineno-109-47" name="__codelineno-109-47" href="#__codelineno-109-47"></a>    print(&quot;\n&quot;)
</span></code></pre></div>
<p><img alt="alt text" src="./image/langgraph15.png" /></p>
<p>Use <code>langgraph-swarm</code> library to create a swarm multi-agent system:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-110-1"><a id="__codelineno-110-1" name="__codelineno-110-1" href="#__codelineno-110-1"></a>pip install langgraph-swarm
</span></code></pre></div>
<div class="language-text highlight"><pre><span></span><code><span id="__span-111-1"><a id="__codelineno-111-1" name="__codelineno-111-1" href="#__codelineno-111-1"></a>from langgraph.prebuilt import create_react_agent
</span><span id="__span-111-2"><a id="__codelineno-111-2" name="__codelineno-111-2" href="#__codelineno-111-2"></a>from langgraph_swarm import create_swarm, create_handoff_tool
</span><span id="__span-111-3"><a id="__codelineno-111-3" name="__codelineno-111-3" href="#__codelineno-111-3"></a>
</span><span id="__span-111-4"><a id="__codelineno-111-4" name="__codelineno-111-4" href="#__codelineno-111-4"></a>transfer_to_hotel_assistant = create_handoff_tool(
</span><span id="__span-111-5"><a id="__codelineno-111-5" name="__codelineno-111-5" href="#__codelineno-111-5"></a>    agent_name=&quot;hotel_assistant&quot;,
</span><span id="__span-111-6"><a id="__codelineno-111-6" name="__codelineno-111-6" href="#__codelineno-111-6"></a>    description=&quot;Transfer user to the hotel-booking assistant.&quot;,
</span><span id="__span-111-7"><a id="__codelineno-111-7" name="__codelineno-111-7" href="#__codelineno-111-7"></a>)
</span><span id="__span-111-8"><a id="__codelineno-111-8" name="__codelineno-111-8" href="#__codelineno-111-8"></a>transfer_to_flight_assistant = create_handoff_tool(
</span><span id="__span-111-9"><a id="__codelineno-111-9" name="__codelineno-111-9" href="#__codelineno-111-9"></a>    agent_name=&quot;flight_assistant&quot;,
</span><span id="__span-111-10"><a id="__codelineno-111-10" name="__codelineno-111-10" href="#__codelineno-111-10"></a>    description=&quot;Transfer user to the flight-booking assistant.&quot;,
</span><span id="__span-111-11"><a id="__codelineno-111-11" name="__codelineno-111-11" href="#__codelineno-111-11"></a>)
</span><span id="__span-111-12"><a id="__codelineno-111-12" name="__codelineno-111-12" href="#__codelineno-111-12"></a>
</span><span id="__span-111-13"><a id="__codelineno-111-13" name="__codelineno-111-13" href="#__codelineno-111-13"></a>flight_assistant = create_react_agent(
</span><span id="__span-111-14"><a id="__codelineno-111-14" name="__codelineno-111-14" href="#__codelineno-111-14"></a>    model=&quot;anthropic:claude-3-5-sonnet-latest&quot;,
</span><span id="__span-111-15"><a id="__codelineno-111-15" name="__codelineno-111-15" href="#__codelineno-111-15"></a>    tools=[book_flight, transfer_to_hotel_assistant],
</span><span id="__span-111-16"><a id="__codelineno-111-16" name="__codelineno-111-16" href="#__codelineno-111-16"></a>    prompt=&quot;You are a flight booking assistant&quot;,
</span><span id="__span-111-17"><a id="__codelineno-111-17" name="__codelineno-111-17" href="#__codelineno-111-17"></a>    name=&quot;flight_assistant&quot;
</span><span id="__span-111-18"><a id="__codelineno-111-18" name="__codelineno-111-18" href="#__codelineno-111-18"></a>)
</span><span id="__span-111-19"><a id="__codelineno-111-19" name="__codelineno-111-19" href="#__codelineno-111-19"></a>hotel_assistant = create_react_agent(
</span><span id="__span-111-20"><a id="__codelineno-111-20" name="__codelineno-111-20" href="#__codelineno-111-20"></a>    model=&quot;anthropic:claude-3-5-sonnet-latest&quot;,
</span><span id="__span-111-21"><a id="__codelineno-111-21" name="__codelineno-111-21" href="#__codelineno-111-21"></a>    tools=[book_hotel, transfer_to_flight_assistant],
</span><span id="__span-111-22"><a id="__codelineno-111-22" name="__codelineno-111-22" href="#__codelineno-111-22"></a>    prompt=&quot;You are a hotel booking assistant&quot;,
</span><span id="__span-111-23"><a id="__codelineno-111-23" name="__codelineno-111-23" href="#__codelineno-111-23"></a>    name=&quot;hotel_assistant&quot;
</span><span id="__span-111-24"><a id="__codelineno-111-24" name="__codelineno-111-24" href="#__codelineno-111-24"></a>)
</span><span id="__span-111-25"><a id="__codelineno-111-25" name="__codelineno-111-25" href="#__codelineno-111-25"></a>
</span><span id="__span-111-26"><a id="__codelineno-111-26" name="__codelineno-111-26" href="#__codelineno-111-26"></a>swarm = create_swarm(
</span><span id="__span-111-27"><a id="__codelineno-111-27" name="__codelineno-111-27" href="#__codelineno-111-27"></a>    agents=[flight_assistant, hotel_assistant],
</span><span id="__span-111-28"><a id="__codelineno-111-28" name="__codelineno-111-28" href="#__codelineno-111-28"></a>    default_active_agent=&quot;flight_assistant&quot;
</span><span id="__span-111-29"><a id="__codelineno-111-29" name="__codelineno-111-29" href="#__codelineno-111-29"></a>).compile()
</span><span id="__span-111-30"><a id="__codelineno-111-30" name="__codelineno-111-30" href="#__codelineno-111-30"></a>
</span><span id="__span-111-31"><a id="__codelineno-111-31" name="__codelineno-111-31" href="#__codelineno-111-31"></a>for chunk in swarm.stream(
</span><span id="__span-111-32"><a id="__codelineno-111-32" name="__codelineno-111-32" href="#__codelineno-111-32"></a>    {
</span><span id="__span-111-33"><a id="__codelineno-111-33" name="__codelineno-111-33" href="#__codelineno-111-33"></a>        &quot;messages&quot;: [
</span><span id="__span-111-34"><a id="__codelineno-111-34" name="__codelineno-111-34" href="#__codelineno-111-34"></a>            {
</span><span id="__span-111-35"><a id="__codelineno-111-35" name="__codelineno-111-35" href="#__codelineno-111-35"></a>                &quot;role&quot;: &quot;user&quot;,
</span><span id="__span-111-36"><a id="__codelineno-111-36" name="__codelineno-111-36" href="#__codelineno-111-36"></a>                &quot;content&quot;: &quot;book a flight from BOS to JFK and a stay at McKittrick Hotel&quot;
</span><span id="__span-111-37"><a id="__codelineno-111-37" name="__codelineno-111-37" href="#__codelineno-111-37"></a>            }
</span><span id="__span-111-38"><a id="__codelineno-111-38" name="__codelineno-111-38" href="#__codelineno-111-38"></a>        ]
</span><span id="__span-111-39"><a id="__codelineno-111-39" name="__codelineno-111-39" href="#__codelineno-111-39"></a>    }
</span><span id="__span-111-40"><a id="__codelineno-111-40" name="__codelineno-111-40" href="#__codelineno-111-40"></a>):
</span><span id="__span-111-41"><a id="__codelineno-111-41" name="__codelineno-111-41" href="#__codelineno-111-41"></a>    print(chunk)
</span><span id="__span-111-42"><a id="__codelineno-111-42" name="__codelineno-111-42" href="#__codelineno-111-42"></a>    print(&quot;\n&quot;)
</span></code></pre></div>
<p><strong>Handoffs</strong></p>
<p>A common pattern in multi-agent interactions is handoffs, where one agent hands off control to another. Handoffs allow you to specify:</p>
<ul>
<li>
<p><strong>destination:</strong> target agent to navigate to</p>
</li>
<li>
<p><strong>payload:</strong> information to pass to that agent</p>
</li>
</ul>
<p>This is used both by <code>langgraph-supervisor</code>(supervisor hands off to individual agents) and <code>langgraph-swarm</code> (an individual agent can hand off to other agents).</p>
<p>To implement handoffs with <code>create_react_agent</code>, you need to:</p>
<ol>
<li>Create a special tool that can transfer control to a different agent</li>
</ol>
<div class="language-text highlight"><pre><span></span><code><span id="__span-112-1"><a id="__codelineno-112-1" name="__codelineno-112-1" href="#__codelineno-112-1"></a>def transfer_to_bob():
</span><span id="__span-112-2"><a id="__codelineno-112-2" name="__codelineno-112-2" href="#__codelineno-112-2"></a>    &quot;&quot;&quot;Transfer to bob.&quot;&quot;&quot;
</span><span id="__span-112-3"><a id="__codelineno-112-3" name="__codelineno-112-3" href="#__codelineno-112-3"></a>    return Command(
</span><span id="__span-112-4"><a id="__codelineno-112-4" name="__codelineno-112-4" href="#__codelineno-112-4"></a>        # name of the agent (node) to go to
</span><span id="__span-112-5"><a id="__codelineno-112-5" name="__codelineno-112-5" href="#__codelineno-112-5"></a>        goto=&quot;bob&quot;,
</span><span id="__span-112-6"><a id="__codelineno-112-6" name="__codelineno-112-6" href="#__codelineno-112-6"></a>        # data to send to the agent
</span><span id="__span-112-7"><a id="__codelineno-112-7" name="__codelineno-112-7" href="#__codelineno-112-7"></a>        update={&quot;messages&quot;: [...]},
</span><span id="__span-112-8"><a id="__codelineno-112-8" name="__codelineno-112-8" href="#__codelineno-112-8"></a>        # indicate to LangGraph that we need to navigate to
</span><span id="__span-112-9"><a id="__codelineno-112-9" name="__codelineno-112-9" href="#__codelineno-112-9"></a>        # agent node in a parent graph
</span><span id="__span-112-10"><a id="__codelineno-112-10" name="__codelineno-112-10" href="#__codelineno-112-10"></a>        graph=Command.PARENT,
</span><span id="__span-112-11"><a id="__codelineno-112-11" name="__codelineno-112-11" href="#__codelineno-112-11"></a>    )
</span></code></pre></div>
<ol>
<li>Create individual agents that have access to handoff tools:</li>
</ol>
<div class="language-text highlight"><pre><span></span><code><span id="__span-113-1"><a id="__codelineno-113-1" name="__codelineno-113-1" href="#__codelineno-113-1"></a>flight_assistant = create_react_agent(
</span><span id="__span-113-2"><a id="__codelineno-113-2" name="__codelineno-113-2" href="#__codelineno-113-2"></a>    ..., tools=[book_flight, transfer_to_hotel_assistant]
</span><span id="__span-113-3"><a id="__codelineno-113-3" name="__codelineno-113-3" href="#__codelineno-113-3"></a>)
</span><span id="__span-113-4"><a id="__codelineno-113-4" name="__codelineno-113-4" href="#__codelineno-113-4"></a>hotel_assistant = create_react_agent(
</span><span id="__span-113-5"><a id="__codelineno-113-5" name="__codelineno-113-5" href="#__codelineno-113-5"></a>    ..., tools=[book_hotel, transfer_to_flight_assistant]
</span><span id="__span-113-6"><a id="__codelineno-113-6" name="__codelineno-113-6" href="#__codelineno-113-6"></a>)
</span></code></pre></div>
<ol>
<li>Define a parent graph that contains individual agents as nodes:</li>
</ol>
<div class="language-text highlight"><pre><span></span><code><span id="__span-114-1"><a id="__codelineno-114-1" name="__codelineno-114-1" href="#__codelineno-114-1"></a>from langgraph.graph import StateGraph, MessagesState
</span><span id="__span-114-2"><a id="__codelineno-114-2" name="__codelineno-114-2" href="#__codelineno-114-2"></a>multi_agent_graph = (
</span><span id="__span-114-3"><a id="__codelineno-114-3" name="__codelineno-114-3" href="#__codelineno-114-3"></a>    StateGraph(MessagesState)
</span><span id="__span-114-4"><a id="__codelineno-114-4" name="__codelineno-114-4" href="#__codelineno-114-4"></a>    .add_node(flight_assistant)
</span><span id="__span-114-5"><a id="__codelineno-114-5" name="__codelineno-114-5" href="#__codelineno-114-5"></a>    .add_node(hotel_assistant)
</span><span id="__span-114-6"><a id="__codelineno-114-6" name="__codelineno-114-6" href="#__codelineno-114-6"></a>    ...
</span><span id="__span-114-7"><a id="__codelineno-114-7" name="__codelineno-114-7" href="#__codelineno-114-7"></a>)
</span></code></pre></div>
<p>Putting this together, here is how you can implement a simple multi-agent system with two agents — a flight booking assistant and a hotel booking assistant:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-115-1"><a id="__codelineno-115-1" name="__codelineno-115-1" href="#__codelineno-115-1"></a>from typing import Annotated
</span><span id="__span-115-2"><a id="__codelineno-115-2" name="__codelineno-115-2" href="#__codelineno-115-2"></a>from langchain_core.tools import tool, InjectedToolCallId
</span><span id="__span-115-3"><a id="__codelineno-115-3" name="__codelineno-115-3" href="#__codelineno-115-3"></a>from langgraph.prebuilt import create_react_agent, InjectedState
</span><span id="__span-115-4"><a id="__codelineno-115-4" name="__codelineno-115-4" href="#__codelineno-115-4"></a>from langgraph.graph import StateGraph, START, MessagesState
</span><span id="__span-115-5"><a id="__codelineno-115-5" name="__codelineno-115-5" href="#__codelineno-115-5"></a>from langgraph.types import Command
</span><span id="__span-115-6"><a id="__codelineno-115-6" name="__codelineno-115-6" href="#__codelineno-115-6"></a>
</span><span id="__span-115-7"><a id="__codelineno-115-7" name="__codelineno-115-7" href="#__codelineno-115-7"></a>def create_handoff_tool(*, agent_name: str, description: str | None = None):
</span><span id="__span-115-8"><a id="__codelineno-115-8" name="__codelineno-115-8" href="#__codelineno-115-8"></a>    name = f&quot;transfer_to_{agent_name}&quot;
</span><span id="__span-115-9"><a id="__codelineno-115-9" name="__codelineno-115-9" href="#__codelineno-115-9"></a>    description = description or f&quot;Transfer to {agent_name}&quot;
</span><span id="__span-115-10"><a id="__codelineno-115-10" name="__codelineno-115-10" href="#__codelineno-115-10"></a>
</span><span id="__span-115-11"><a id="__codelineno-115-11" name="__codelineno-115-11" href="#__codelineno-115-11"></a>    @tool(name, description=description)
</span><span id="__span-115-12"><a id="__codelineno-115-12" name="__codelineno-115-12" href="#__codelineno-115-12"></a>    def handoff_tool(
</span><span id="__span-115-13"><a id="__codelineno-115-13" name="__codelineno-115-13" href="#__codelineno-115-13"></a>        state: Annotated[MessagesState, InjectedState], 
</span><span id="__span-115-14"><a id="__codelineno-115-14" name="__codelineno-115-14" href="#__codelineno-115-14"></a>        tool_call_id: Annotated[str, InjectedToolCallId],
</span><span id="__span-115-15"><a id="__codelineno-115-15" name="__codelineno-115-15" href="#__codelineno-115-15"></a>    ) -&gt; Command:
</span><span id="__span-115-16"><a id="__codelineno-115-16" name="__codelineno-115-16" href="#__codelineno-115-16"></a>        tool_message = {
</span><span id="__span-115-17"><a id="__codelineno-115-17" name="__codelineno-115-17" href="#__codelineno-115-17"></a>            &quot;role&quot;: &quot;tool&quot;,
</span><span id="__span-115-18"><a id="__codelineno-115-18" name="__codelineno-115-18" href="#__codelineno-115-18"></a>            &quot;content&quot;: f&quot;Successfully transferred to {agent_name}&quot;,
</span><span id="__span-115-19"><a id="__codelineno-115-19" name="__codelineno-115-19" href="#__codelineno-115-19"></a>            &quot;name&quot;: name,
</span><span id="__span-115-20"><a id="__codelineno-115-20" name="__codelineno-115-20" href="#__codelineno-115-20"></a>            &quot;tool_call_id&quot;: tool_call_id,
</span><span id="__span-115-21"><a id="__codelineno-115-21" name="__codelineno-115-21" href="#__codelineno-115-21"></a>        }
</span><span id="__span-115-22"><a id="__codelineno-115-22" name="__codelineno-115-22" href="#__codelineno-115-22"></a>        return Command(  
</span><span id="__span-115-23"><a id="__codelineno-115-23" name="__codelineno-115-23" href="#__codelineno-115-23"></a>            goto=agent_name,  
</span><span id="__span-115-24"><a id="__codelineno-115-24" name="__codelineno-115-24" href="#__codelineno-115-24"></a>            update={&quot;messages&quot;: state[&quot;messages&quot;] + [tool_message]},  
</span><span id="__span-115-25"><a id="__codelineno-115-25" name="__codelineno-115-25" href="#__codelineno-115-25"></a>            graph=Command.PARENT,  
</span><span id="__span-115-26"><a id="__codelineno-115-26" name="__codelineno-115-26" href="#__codelineno-115-26"></a>        )
</span><span id="__span-115-27"><a id="__codelineno-115-27" name="__codelineno-115-27" href="#__codelineno-115-27"></a>    return handoff_tool
</span><span id="__span-115-28"><a id="__codelineno-115-28" name="__codelineno-115-28" href="#__codelineno-115-28"></a>
</span><span id="__span-115-29"><a id="__codelineno-115-29" name="__codelineno-115-29" href="#__codelineno-115-29"></a># Handoffs
</span><span id="__span-115-30"><a id="__codelineno-115-30" name="__codelineno-115-30" href="#__codelineno-115-30"></a>transfer_to_hotel_assistant = create_handoff_tool(
</span><span id="__span-115-31"><a id="__codelineno-115-31" name="__codelineno-115-31" href="#__codelineno-115-31"></a>    agent_name=&quot;hotel_assistant&quot;,
</span><span id="__span-115-32"><a id="__codelineno-115-32" name="__codelineno-115-32" href="#__codelineno-115-32"></a>    description=&quot;Transfer user to the hotel-booking assistant.&quot;,
</span><span id="__span-115-33"><a id="__codelineno-115-33" name="__codelineno-115-33" href="#__codelineno-115-33"></a>)
</span><span id="__span-115-34"><a id="__codelineno-115-34" name="__codelineno-115-34" href="#__codelineno-115-34"></a>transfer_to_flight_assistant = create_handoff_tool(
</span><span id="__span-115-35"><a id="__codelineno-115-35" name="__codelineno-115-35" href="#__codelineno-115-35"></a>    agent_name=&quot;flight_assistant&quot;,
</span><span id="__span-115-36"><a id="__codelineno-115-36" name="__codelineno-115-36" href="#__codelineno-115-36"></a>    description=&quot;Transfer user to the flight-booking assistant.&quot;,
</span><span id="__span-115-37"><a id="__codelineno-115-37" name="__codelineno-115-37" href="#__codelineno-115-37"></a>)
</span><span id="__span-115-38"><a id="__codelineno-115-38" name="__codelineno-115-38" href="#__codelineno-115-38"></a>
</span><span id="__span-115-39"><a id="__codelineno-115-39" name="__codelineno-115-39" href="#__codelineno-115-39"></a># Simple agent tools
</span><span id="__span-115-40"><a id="__codelineno-115-40" name="__codelineno-115-40" href="#__codelineno-115-40"></a>def book_hotel(hotel_name: str):
</span><span id="__span-115-41"><a id="__codelineno-115-41" name="__codelineno-115-41" href="#__codelineno-115-41"></a>    &quot;&quot;&quot;Book a hotel&quot;&quot;&quot;
</span><span id="__span-115-42"><a id="__codelineno-115-42" name="__codelineno-115-42" href="#__codelineno-115-42"></a>    return f&quot;Successfully booked a stay at {hotel_name}.&quot;
</span><span id="__span-115-43"><a id="__codelineno-115-43" name="__codelineno-115-43" href="#__codelineno-115-43"></a>
</span><span id="__span-115-44"><a id="__codelineno-115-44" name="__codelineno-115-44" href="#__codelineno-115-44"></a>def book_flight(from_airport: str, to_airport: str):
</span><span id="__span-115-45"><a id="__codelineno-115-45" name="__codelineno-115-45" href="#__codelineno-115-45"></a>    &quot;&quot;&quot;Book a flight&quot;&quot;&quot;
</span><span id="__span-115-46"><a id="__codelineno-115-46" name="__codelineno-115-46" href="#__codelineno-115-46"></a>    return f&quot;Successfully booked a flight from {from_airport} to {to_airport}.&quot;
</span><span id="__span-115-47"><a id="__codelineno-115-47" name="__codelineno-115-47" href="#__codelineno-115-47"></a>
</span><span id="__span-115-48"><a id="__codelineno-115-48" name="__codelineno-115-48" href="#__codelineno-115-48"></a># Define agents
</span><span id="__span-115-49"><a id="__codelineno-115-49" name="__codelineno-115-49" href="#__codelineno-115-49"></a>flight_assistant = create_react_agent(
</span><span id="__span-115-50"><a id="__codelineno-115-50" name="__codelineno-115-50" href="#__codelineno-115-50"></a>    model=&quot;anthropic:claude-3-5-sonnet-latest&quot;,
</span><span id="__span-115-51"><a id="__codelineno-115-51" name="__codelineno-115-51" href="#__codelineno-115-51"></a>    tools=[book_flight, transfer_to_hotel_assistant],
</span><span id="__span-115-52"><a id="__codelineno-115-52" name="__codelineno-115-52" href="#__codelineno-115-52"></a>    prompt=&quot;You are a flight booking assistant&quot;,
</span><span id="__span-115-53"><a id="__codelineno-115-53" name="__codelineno-115-53" href="#__codelineno-115-53"></a>    name=&quot;flight_assistant&quot;
</span><span id="__span-115-54"><a id="__codelineno-115-54" name="__codelineno-115-54" href="#__codelineno-115-54"></a>)
</span><span id="__span-115-55"><a id="__codelineno-115-55" name="__codelineno-115-55" href="#__codelineno-115-55"></a>hotel_assistant = create_react_agent(
</span><span id="__span-115-56"><a id="__codelineno-115-56" name="__codelineno-115-56" href="#__codelineno-115-56"></a>    model=&quot;anthropic:claude-3-5-sonnet-latest&quot;,
</span><span id="__span-115-57"><a id="__codelineno-115-57" name="__codelineno-115-57" href="#__codelineno-115-57"></a>    tools=[book_hotel, transfer_to_flight_assistant],
</span><span id="__span-115-58"><a id="__codelineno-115-58" name="__codelineno-115-58" href="#__codelineno-115-58"></a>    prompt=&quot;You are a hotel booking assistant&quot;,
</span><span id="__span-115-59"><a id="__codelineno-115-59" name="__codelineno-115-59" href="#__codelineno-115-59"></a>    name=&quot;hotel_assistant&quot;
</span><span id="__span-115-60"><a id="__codelineno-115-60" name="__codelineno-115-60" href="#__codelineno-115-60"></a>)
</span><span id="__span-115-61"><a id="__codelineno-115-61" name="__codelineno-115-61" href="#__codelineno-115-61"></a>
</span><span id="__span-115-62"><a id="__codelineno-115-62" name="__codelineno-115-62" href="#__codelineno-115-62"></a># Define multi-agent graph
</span><span id="__span-115-63"><a id="__codelineno-115-63" name="__codelineno-115-63" href="#__codelineno-115-63"></a>multi_agent_graph = (
</span><span id="__span-115-64"><a id="__codelineno-115-64" name="__codelineno-115-64" href="#__codelineno-115-64"></a>    StateGraph(MessagesState)
</span><span id="__span-115-65"><a id="__codelineno-115-65" name="__codelineno-115-65" href="#__codelineno-115-65"></a>    .add_node(flight_assistant)
</span><span id="__span-115-66"><a id="__codelineno-115-66" name="__codelineno-115-66" href="#__codelineno-115-66"></a>    .add_node(hotel_assistant)
</span><span id="__span-115-67"><a id="__codelineno-115-67" name="__codelineno-115-67" href="#__codelineno-115-67"></a>    .add_edge(START, &quot;flight_assistant&quot;)
</span><span id="__span-115-68"><a id="__codelineno-115-68" name="__codelineno-115-68" href="#__codelineno-115-68"></a>    .compile()
</span><span id="__span-115-69"><a id="__codelineno-115-69" name="__codelineno-115-69" href="#__codelineno-115-69"></a>)
</span><span id="__span-115-70"><a id="__codelineno-115-70" name="__codelineno-115-70" href="#__codelineno-115-70"></a>
</span><span id="__span-115-71"><a id="__codelineno-115-71" name="__codelineno-115-71" href="#__codelineno-115-71"></a># Run the multi-agent graph
</span><span id="__span-115-72"><a id="__codelineno-115-72" name="__codelineno-115-72" href="#__codelineno-115-72"></a>for chunk in multi_agent_graph.stream(
</span><span id="__span-115-73"><a id="__codelineno-115-73" name="__codelineno-115-73" href="#__codelineno-115-73"></a>    {
</span><span id="__span-115-74"><a id="__codelineno-115-74" name="__codelineno-115-74" href="#__codelineno-115-74"></a>        &quot;messages&quot;: [
</span><span id="__span-115-75"><a id="__codelineno-115-75" name="__codelineno-115-75" href="#__codelineno-115-75"></a>            {
</span><span id="__span-115-76"><a id="__codelineno-115-76" name="__codelineno-115-76" href="#__codelineno-115-76"></a>                &quot;role&quot;: &quot;user&quot;,
</span><span id="__span-115-77"><a id="__codelineno-115-77" name="__codelineno-115-77" href="#__codelineno-115-77"></a>                &quot;content&quot;: &quot;book a flight from BOS to JFK and a stay at McKittrick Hotel&quot;
</span><span id="__span-115-78"><a id="__codelineno-115-78" name="__codelineno-115-78" href="#__codelineno-115-78"></a>            }
</span><span id="__span-115-79"><a id="__codelineno-115-79" name="__codelineno-115-79" href="#__codelineno-115-79"></a>        ]
</span><span id="__span-115-80"><a id="__codelineno-115-80" name="__codelineno-115-80" href="#__codelineno-115-80"></a>    }
</span><span id="__span-115-81"><a id="__codelineno-115-81" name="__codelineno-115-81" href="#__codelineno-115-81"></a>):
</span><span id="__span-115-82"><a id="__codelineno-115-82" name="__codelineno-115-82" href="#__codelineno-115-82"></a>    print(chunk)
</span><span id="__span-115-83"><a id="__codelineno-115-83" name="__codelineno-115-83" href="#__codelineno-115-83"></a>    print(&quot;\n&quot;)
</span></code></pre></div>
<h2 id="build-multi-agent-systems">Build multi-agent systems<a class="headerlink" href="#build-multi-agent-systems" title="Permanent link">#</a></h2>
<p><strong>Handoffs</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-116-1"><a id="__codelineno-116-1" name="__codelineno-116-1" href="#__codelineno-116-1"></a>from typing import Annotated
</span><span id="__span-116-2"><a id="__codelineno-116-2" name="__codelineno-116-2" href="#__codelineno-116-2"></a>from langchain_core.tools import tool, InjectedToolCallId
</span><span id="__span-116-3"><a id="__codelineno-116-3" name="__codelineno-116-3" href="#__codelineno-116-3"></a>from langgraph.prebuilt import create_react_agent, InjectedState
</span><span id="__span-116-4"><a id="__codelineno-116-4" name="__codelineno-116-4" href="#__codelineno-116-4"></a>from langgraph.graph import StateGraph, START, MessagesState
</span><span id="__span-116-5"><a id="__codelineno-116-5" name="__codelineno-116-5" href="#__codelineno-116-5"></a>from langgraph.types import Command
</span><span id="__span-116-6"><a id="__codelineno-116-6" name="__codelineno-116-6" href="#__codelineno-116-6"></a>
</span><span id="__span-116-7"><a id="__codelineno-116-7" name="__codelineno-116-7" href="#__codelineno-116-7"></a>def create_handoff_tool(*, agent_name: str, description: str | None = None):
</span><span id="__span-116-8"><a id="__codelineno-116-8" name="__codelineno-116-8" href="#__codelineno-116-8"></a>    name = f&quot;transfer_to_{agent_name}&quot;
</span><span id="__span-116-9"><a id="__codelineno-116-9" name="__codelineno-116-9" href="#__codelineno-116-9"></a>    description = description or f&quot;Transfer to {agent_name}&quot;
</span><span id="__span-116-10"><a id="__codelineno-116-10" name="__codelineno-116-10" href="#__codelineno-116-10"></a>
</span><span id="__span-116-11"><a id="__codelineno-116-11" name="__codelineno-116-11" href="#__codelineno-116-11"></a>    @tool(name, description=description)
</span><span id="__span-116-12"><a id="__codelineno-116-12" name="__codelineno-116-12" href="#__codelineno-116-12"></a>    def handoff_tool(
</span><span id="__span-116-13"><a id="__codelineno-116-13" name="__codelineno-116-13" href="#__codelineno-116-13"></a>        state: Annotated[MessagesState, InjectedState], 
</span><span id="__span-116-14"><a id="__codelineno-116-14" name="__codelineno-116-14" href="#__codelineno-116-14"></a>        tool_call_id: Annotated[str, InjectedToolCallId],
</span><span id="__span-116-15"><a id="__codelineno-116-15" name="__codelineno-116-15" href="#__codelineno-116-15"></a>    ) -&gt; Command:
</span><span id="__span-116-16"><a id="__codelineno-116-16" name="__codelineno-116-16" href="#__codelineno-116-16"></a>        tool_message = {
</span><span id="__span-116-17"><a id="__codelineno-116-17" name="__codelineno-116-17" href="#__codelineno-116-17"></a>            &quot;role&quot;: &quot;tool&quot;,
</span><span id="__span-116-18"><a id="__codelineno-116-18" name="__codelineno-116-18" href="#__codelineno-116-18"></a>            &quot;content&quot;: f&quot;Successfully transferred to {agent_name}&quot;,
</span><span id="__span-116-19"><a id="__codelineno-116-19" name="__codelineno-116-19" href="#__codelineno-116-19"></a>            &quot;name&quot;: name,
</span><span id="__span-116-20"><a id="__codelineno-116-20" name="__codelineno-116-20" href="#__codelineno-116-20"></a>            &quot;tool_call_id&quot;: tool_call_id,
</span><span id="__span-116-21"><a id="__codelineno-116-21" name="__codelineno-116-21" href="#__codelineno-116-21"></a>        }
</span><span id="__span-116-22"><a id="__codelineno-116-22" name="__codelineno-116-22" href="#__codelineno-116-22"></a>        return Command(  
</span><span id="__span-116-23"><a id="__codelineno-116-23" name="__codelineno-116-23" href="#__codelineno-116-23"></a>            goto=agent_name,  
</span><span id="__span-116-24"><a id="__codelineno-116-24" name="__codelineno-116-24" href="#__codelineno-116-24"></a>            update={&quot;messages&quot;: state[&quot;messages&quot;] + [tool_message]},  
</span><span id="__span-116-25"><a id="__codelineno-116-25" name="__codelineno-116-25" href="#__codelineno-116-25"></a>            graph=Command.PARENT,  
</span><span id="__span-116-26"><a id="__codelineno-116-26" name="__codelineno-116-26" href="#__codelineno-116-26"></a>        )
</span><span id="__span-116-27"><a id="__codelineno-116-27" name="__codelineno-116-27" href="#__codelineno-116-27"></a>    return handoff_tool
</span></code></pre></div>
<p><strong>Control agent inputs</strong></p>
<p>You can use the Send() primitive to directly send data to the worker agents during the handoff. For example, you can request that the calling agent populate a task description for the next agent:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-117-1"><a id="__codelineno-117-1" name="__codelineno-117-1" href="#__codelineno-117-1"></a>from typing import Annotated
</span><span id="__span-117-2"><a id="__codelineno-117-2" name="__codelineno-117-2" href="#__codelineno-117-2"></a>from langchain_core.tools import tool, InjectedToolCallId
</span><span id="__span-117-3"><a id="__codelineno-117-3" name="__codelineno-117-3" href="#__codelineno-117-3"></a>from langgraph.prebuilt import InjectedState
</span><span id="__span-117-4"><a id="__codelineno-117-4" name="__codelineno-117-4" href="#__codelineno-117-4"></a>from langgraph.graph import StateGraph, START, MessagesState
</span><span id="__span-117-5"><a id="__codelineno-117-5" name="__codelineno-117-5" href="#__codelineno-117-5"></a>from langgraph.types import Command, Send
</span><span id="__span-117-6"><a id="__codelineno-117-6" name="__codelineno-117-6" href="#__codelineno-117-6"></a>
</span><span id="__span-117-7"><a id="__codelineno-117-7" name="__codelineno-117-7" href="#__codelineno-117-7"></a>def create_task_description_handoff_tool(
</span><span id="__span-117-8"><a id="__codelineno-117-8" name="__codelineno-117-8" href="#__codelineno-117-8"></a>    *, agent_name: str, description: str | None = None
</span><span id="__span-117-9"><a id="__codelineno-117-9" name="__codelineno-117-9" href="#__codelineno-117-9"></a>):
</span><span id="__span-117-10"><a id="__codelineno-117-10" name="__codelineno-117-10" href="#__codelineno-117-10"></a>    name = f&quot;transfer_to_{agent_name}&quot;
</span><span id="__span-117-11"><a id="__codelineno-117-11" name="__codelineno-117-11" href="#__codelineno-117-11"></a>    description = description or f&quot;Ask {agent_name} for help.&quot;
</span><span id="__span-117-12"><a id="__codelineno-117-12" name="__codelineno-117-12" href="#__codelineno-117-12"></a>
</span><span id="__span-117-13"><a id="__codelineno-117-13" name="__codelineno-117-13" href="#__codelineno-117-13"></a>    @tool(name, description=description)
</span><span id="__span-117-14"><a id="__codelineno-117-14" name="__codelineno-117-14" href="#__codelineno-117-14"></a>    def handoff_tool(
</span><span id="__span-117-15"><a id="__codelineno-117-15" name="__codelineno-117-15" href="#__codelineno-117-15"></a>        # this is populated by the calling agent
</span><span id="__span-117-16"><a id="__codelineno-117-16" name="__codelineno-117-16" href="#__codelineno-117-16"></a>        task_description: Annotated[
</span><span id="__span-117-17"><a id="__codelineno-117-17" name="__codelineno-117-17" href="#__codelineno-117-17"></a>            str,
</span><span id="__span-117-18"><a id="__codelineno-117-18" name="__codelineno-117-18" href="#__codelineno-117-18"></a>            &quot;Description of what the next agent should do, including all of the relevant context.&quot;,
</span><span id="__span-117-19"><a id="__codelineno-117-19" name="__codelineno-117-19" href="#__codelineno-117-19"></a>        ],
</span><span id="__span-117-20"><a id="__codelineno-117-20" name="__codelineno-117-20" href="#__codelineno-117-20"></a>        # these parameters are ignored by the LLM
</span><span id="__span-117-21"><a id="__codelineno-117-21" name="__codelineno-117-21" href="#__codelineno-117-21"></a>        state: Annotated[MessagesState, InjectedState],
</span><span id="__span-117-22"><a id="__codelineno-117-22" name="__codelineno-117-22" href="#__codelineno-117-22"></a>    ) -&gt; Command:
</span><span id="__span-117-23"><a id="__codelineno-117-23" name="__codelineno-117-23" href="#__codelineno-117-23"></a>        task_description_message = {&quot;role&quot;: &quot;user&quot;, &quot;content&quot;: task_description}
</span><span id="__span-117-24"><a id="__codelineno-117-24" name="__codelineno-117-24" href="#__codelineno-117-24"></a>        agent_input = {**state, &quot;messages&quot;: [task_description_message]}
</span><span id="__span-117-25"><a id="__codelineno-117-25" name="__codelineno-117-25" href="#__codelineno-117-25"></a>        return Command(
</span><span id="__span-117-26"><a id="__codelineno-117-26" name="__codelineno-117-26" href="#__codelineno-117-26"></a>            goto=[Send(agent_name, agent_input)],
</span><span id="__span-117-27"><a id="__codelineno-117-27" name="__codelineno-117-27" href="#__codelineno-117-27"></a>            graph=Command.PARENT,
</span><span id="__span-117-28"><a id="__codelineno-117-28" name="__codelineno-117-28" href="#__codelineno-117-28"></a>        )
</span><span id="__span-117-29"><a id="__codelineno-117-29" name="__codelineno-117-29" href="#__codelineno-117-29"></a>
</span><span id="__span-117-30"><a id="__codelineno-117-30" name="__codelineno-117-30" href="#__codelineno-117-30"></a>    return handoff_tool
</span></code></pre></div>
<p><strong>Build a multi-agent system</strong></p>
<p>You can use handoffs in any agents built with LangGraph. We recommend using the prebuilt agent or ToolNode, as they natively support handoffs tools returning Command. Below is an example of how you can implement a multi-agent system for booking travel using handoffs:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-118-1"><a id="__codelineno-118-1" name="__codelineno-118-1" href="#__codelineno-118-1"></a>from langgraph.prebuilt import create_react_agent
</span><span id="__span-118-2"><a id="__codelineno-118-2" name="__codelineno-118-2" href="#__codelineno-118-2"></a>from langgraph.graph import StateGraph, START, MessagesState
</span><span id="__span-118-3"><a id="__codelineno-118-3" name="__codelineno-118-3" href="#__codelineno-118-3"></a>
</span><span id="__span-118-4"><a id="__codelineno-118-4" name="__codelineno-118-4" href="#__codelineno-118-4"></a>def create_handoff_tool(*, agent_name: str, description: str | None = None):
</span><span id="__span-118-5"><a id="__codelineno-118-5" name="__codelineno-118-5" href="#__codelineno-118-5"></a>    # same implementation as above
</span><span id="__span-118-6"><a id="__codelineno-118-6" name="__codelineno-118-6" href="#__codelineno-118-6"></a>    ...
</span><span id="__span-118-7"><a id="__codelineno-118-7" name="__codelineno-118-7" href="#__codelineno-118-7"></a>    return Command(...)
</span><span id="__span-118-8"><a id="__codelineno-118-8" name="__codelineno-118-8" href="#__codelineno-118-8"></a>
</span><span id="__span-118-9"><a id="__codelineno-118-9" name="__codelineno-118-9" href="#__codelineno-118-9"></a># Handoffs
</span><span id="__span-118-10"><a id="__codelineno-118-10" name="__codelineno-118-10" href="#__codelineno-118-10"></a>transfer_to_hotel_assistant = create_handoff_tool(agent_name=&quot;hotel_assistant&quot;)
</span><span id="__span-118-11"><a id="__codelineno-118-11" name="__codelineno-118-11" href="#__codelineno-118-11"></a>transfer_to_flight_assistant = create_handoff_tool(agent_name=&quot;flight_assistant&quot;)
</span><span id="__span-118-12"><a id="__codelineno-118-12" name="__codelineno-118-12" href="#__codelineno-118-12"></a>
</span><span id="__span-118-13"><a id="__codelineno-118-13" name="__codelineno-118-13" href="#__codelineno-118-13"></a># Define agents
</span><span id="__span-118-14"><a id="__codelineno-118-14" name="__codelineno-118-14" href="#__codelineno-118-14"></a>flight_assistant = create_react_agent(
</span><span id="__span-118-15"><a id="__codelineno-118-15" name="__codelineno-118-15" href="#__codelineno-118-15"></a>    model=&quot;anthropic:claude-3-5-sonnet-latest&quot;,
</span><span id="__span-118-16"><a id="__codelineno-118-16" name="__codelineno-118-16" href="#__codelineno-118-16"></a>    tools=[..., transfer_to_hotel_assistant],
</span><span id="__span-118-17"><a id="__codelineno-118-17" name="__codelineno-118-17" href="#__codelineno-118-17"></a>    name=&quot;flight_assistant&quot;
</span><span id="__span-118-18"><a id="__codelineno-118-18" name="__codelineno-118-18" href="#__codelineno-118-18"></a>)
</span><span id="__span-118-19"><a id="__codelineno-118-19" name="__codelineno-118-19" href="#__codelineno-118-19"></a>hotel_assistant = create_react_agent(
</span><span id="__span-118-20"><a id="__codelineno-118-20" name="__codelineno-118-20" href="#__codelineno-118-20"></a>    model=&quot;anthropic:claude-3-5-sonnet-latest&quot;,
</span><span id="__span-118-21"><a id="__codelineno-118-21" name="__codelineno-118-21" href="#__codelineno-118-21"></a>    tools=[..., transfer_to_flight_assistant],
</span><span id="__span-118-22"><a id="__codelineno-118-22" name="__codelineno-118-22" href="#__codelineno-118-22"></a>    name=&quot;hotel_assistant&quot;
</span><span id="__span-118-23"><a id="__codelineno-118-23" name="__codelineno-118-23" href="#__codelineno-118-23"></a>)
</span><span id="__span-118-24"><a id="__codelineno-118-24" name="__codelineno-118-24" href="#__codelineno-118-24"></a>
</span><span id="__span-118-25"><a id="__codelineno-118-25" name="__codelineno-118-25" href="#__codelineno-118-25"></a># Define multi-agent graph
</span><span id="__span-118-26"><a id="__codelineno-118-26" name="__codelineno-118-26" href="#__codelineno-118-26"></a>multi_agent_graph = (
</span><span id="__span-118-27"><a id="__codelineno-118-27" name="__codelineno-118-27" href="#__codelineno-118-27"></a>    StateGraph(MessagesState)
</span><span id="__span-118-28"><a id="__codelineno-118-28" name="__codelineno-118-28" href="#__codelineno-118-28"></a>    .add_node(flight_assistant)
</span><span id="__span-118-29"><a id="__codelineno-118-29" name="__codelineno-118-29" href="#__codelineno-118-29"></a>    .add_node(hotel_assistant)
</span><span id="__span-118-30"><a id="__codelineno-118-30" name="__codelineno-118-30" href="#__codelineno-118-30"></a>    .add_edge(START, &quot;flight_assistant&quot;)
</span><span id="__span-118-31"><a id="__codelineno-118-31" name="__codelineno-118-31" href="#__codelineno-118-31"></a>    .compile()
</span><span id="__span-118-32"><a id="__codelineno-118-32" name="__codelineno-118-32" href="#__codelineno-118-32"></a>)
</span></code></pre></div>
<p><strong>Full example: Multi-agent system for booking travel</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-119-1"><a id="__codelineno-119-1" name="__codelineno-119-1" href="#__codelineno-119-1"></a>from typing import Annotated
</span><span id="__span-119-2"><a id="__codelineno-119-2" name="__codelineno-119-2" href="#__codelineno-119-2"></a>from langchain_core.messages import convert_to_messages
</span><span id="__span-119-3"><a id="__codelineno-119-3" name="__codelineno-119-3" href="#__codelineno-119-3"></a>from langchain_core.tools import tool, InjectedToolCallId
</span><span id="__span-119-4"><a id="__codelineno-119-4" name="__codelineno-119-4" href="#__codelineno-119-4"></a>from langgraph.prebuilt import create_react_agent, InjectedState
</span><span id="__span-119-5"><a id="__codelineno-119-5" name="__codelineno-119-5" href="#__codelineno-119-5"></a>from langgraph.graph import StateGraph, START, MessagesState
</span><span id="__span-119-6"><a id="__codelineno-119-6" name="__codelineno-119-6" href="#__codelineno-119-6"></a>from langgraph.types import Command
</span><span id="__span-119-7"><a id="__codelineno-119-7" name="__codelineno-119-7" href="#__codelineno-119-7"></a>
</span><span id="__span-119-8"><a id="__codelineno-119-8" name="__codelineno-119-8" href="#__codelineno-119-8"></a># We&#39;ll use `pretty_print_messages` helper to render the streamed agent outputs nicely
</span><span id="__span-119-9"><a id="__codelineno-119-9" name="__codelineno-119-9" href="#__codelineno-119-9"></a>
</span><span id="__span-119-10"><a id="__codelineno-119-10" name="__codelineno-119-10" href="#__codelineno-119-10"></a>def pretty_print_message(message, indent=False):
</span><span id="__span-119-11"><a id="__codelineno-119-11" name="__codelineno-119-11" href="#__codelineno-119-11"></a>    pretty_message = message.pretty_repr(html=True)
</span><span id="__span-119-12"><a id="__codelineno-119-12" name="__codelineno-119-12" href="#__codelineno-119-12"></a>    if not indent:
</span><span id="__span-119-13"><a id="__codelineno-119-13" name="__codelineno-119-13" href="#__codelineno-119-13"></a>        print(pretty_message)
</span><span id="__span-119-14"><a id="__codelineno-119-14" name="__codelineno-119-14" href="#__codelineno-119-14"></a>        return
</span><span id="__span-119-15"><a id="__codelineno-119-15" name="__codelineno-119-15" href="#__codelineno-119-15"></a>
</span><span id="__span-119-16"><a id="__codelineno-119-16" name="__codelineno-119-16" href="#__codelineno-119-16"></a>    indented = &quot;\n&quot;.join(&quot;\t&quot; + c for c in pretty_message.split(&quot;\n&quot;))
</span><span id="__span-119-17"><a id="__codelineno-119-17" name="__codelineno-119-17" href="#__codelineno-119-17"></a>    print(indented)
</span><span id="__span-119-18"><a id="__codelineno-119-18" name="__codelineno-119-18" href="#__codelineno-119-18"></a>
</span><span id="__span-119-19"><a id="__codelineno-119-19" name="__codelineno-119-19" href="#__codelineno-119-19"></a>
</span><span id="__span-119-20"><a id="__codelineno-119-20" name="__codelineno-119-20" href="#__codelineno-119-20"></a>def pretty_print_messages(update, last_message=False):
</span><span id="__span-119-21"><a id="__codelineno-119-21" name="__codelineno-119-21" href="#__codelineno-119-21"></a>    is_subgraph = False
</span><span id="__span-119-22"><a id="__codelineno-119-22" name="__codelineno-119-22" href="#__codelineno-119-22"></a>    if isinstance(update, tuple):
</span><span id="__span-119-23"><a id="__codelineno-119-23" name="__codelineno-119-23" href="#__codelineno-119-23"></a>        ns, update = update
</span><span id="__span-119-24"><a id="__codelineno-119-24" name="__codelineno-119-24" href="#__codelineno-119-24"></a>        # skip parent graph updates in the printouts
</span><span id="__span-119-25"><a id="__codelineno-119-25" name="__codelineno-119-25" href="#__codelineno-119-25"></a>        if len(ns) == 0:
</span><span id="__span-119-26"><a id="__codelineno-119-26" name="__codelineno-119-26" href="#__codelineno-119-26"></a>            return
</span><span id="__span-119-27"><a id="__codelineno-119-27" name="__codelineno-119-27" href="#__codelineno-119-27"></a>
</span><span id="__span-119-28"><a id="__codelineno-119-28" name="__codelineno-119-28" href="#__codelineno-119-28"></a>        graph_id = ns[-1].split(&quot;:&quot;)[0]
</span><span id="__span-119-29"><a id="__codelineno-119-29" name="__codelineno-119-29" href="#__codelineno-119-29"></a>        print(f&quot;Update from subgraph {graph_id}:&quot;)
</span><span id="__span-119-30"><a id="__codelineno-119-30" name="__codelineno-119-30" href="#__codelineno-119-30"></a>        print(&quot;\n&quot;)
</span><span id="__span-119-31"><a id="__codelineno-119-31" name="__codelineno-119-31" href="#__codelineno-119-31"></a>        is_subgraph = True
</span><span id="__span-119-32"><a id="__codelineno-119-32" name="__codelineno-119-32" href="#__codelineno-119-32"></a>
</span><span id="__span-119-33"><a id="__codelineno-119-33" name="__codelineno-119-33" href="#__codelineno-119-33"></a>    for node_name, node_update in update.items():
</span><span id="__span-119-34"><a id="__codelineno-119-34" name="__codelineno-119-34" href="#__codelineno-119-34"></a>        update_label = f&quot;Update from node {node_name}:&quot;
</span><span id="__span-119-35"><a id="__codelineno-119-35" name="__codelineno-119-35" href="#__codelineno-119-35"></a>        if is_subgraph:
</span><span id="__span-119-36"><a id="__codelineno-119-36" name="__codelineno-119-36" href="#__codelineno-119-36"></a>            update_label = &quot;\t&quot; + update_label
</span><span id="__span-119-37"><a id="__codelineno-119-37" name="__codelineno-119-37" href="#__codelineno-119-37"></a>
</span><span id="__span-119-38"><a id="__codelineno-119-38" name="__codelineno-119-38" href="#__codelineno-119-38"></a>        print(update_label)
</span><span id="__span-119-39"><a id="__codelineno-119-39" name="__codelineno-119-39" href="#__codelineno-119-39"></a>        print(&quot;\n&quot;)
</span><span id="__span-119-40"><a id="__codelineno-119-40" name="__codelineno-119-40" href="#__codelineno-119-40"></a>
</span><span id="__span-119-41"><a id="__codelineno-119-41" name="__codelineno-119-41" href="#__codelineno-119-41"></a>        messages = convert_to_messages(node_update[&quot;messages&quot;])
</span><span id="__span-119-42"><a id="__codelineno-119-42" name="__codelineno-119-42" href="#__codelineno-119-42"></a>        if last_message:
</span><span id="__span-119-43"><a id="__codelineno-119-43" name="__codelineno-119-43" href="#__codelineno-119-43"></a>            messages = messages[-1:]
</span><span id="__span-119-44"><a id="__codelineno-119-44" name="__codelineno-119-44" href="#__codelineno-119-44"></a>
</span><span id="__span-119-45"><a id="__codelineno-119-45" name="__codelineno-119-45" href="#__codelineno-119-45"></a>        for m in messages:
</span><span id="__span-119-46"><a id="__codelineno-119-46" name="__codelineno-119-46" href="#__codelineno-119-46"></a>            pretty_print_message(m, indent=is_subgraph)
</span><span id="__span-119-47"><a id="__codelineno-119-47" name="__codelineno-119-47" href="#__codelineno-119-47"></a>        print(&quot;\n&quot;)
</span><span id="__span-119-48"><a id="__codelineno-119-48" name="__codelineno-119-48" href="#__codelineno-119-48"></a>
</span><span id="__span-119-49"><a id="__codelineno-119-49" name="__codelineno-119-49" href="#__codelineno-119-49"></a>
</span><span id="__span-119-50"><a id="__codelineno-119-50" name="__codelineno-119-50" href="#__codelineno-119-50"></a>def create_handoff_tool(*, agent_name: str, description: str | None = None):
</span><span id="__span-119-51"><a id="__codelineno-119-51" name="__codelineno-119-51" href="#__codelineno-119-51"></a>    name = f&quot;transfer_to_{agent_name}&quot;
</span><span id="__span-119-52"><a id="__codelineno-119-52" name="__codelineno-119-52" href="#__codelineno-119-52"></a>    description = description or f&quot;Transfer to {agent_name}&quot;
</span><span id="__span-119-53"><a id="__codelineno-119-53" name="__codelineno-119-53" href="#__codelineno-119-53"></a>
</span><span id="__span-119-54"><a id="__codelineno-119-54" name="__codelineno-119-54" href="#__codelineno-119-54"></a>    @tool(name, description=description)
</span><span id="__span-119-55"><a id="__codelineno-119-55" name="__codelineno-119-55" href="#__codelineno-119-55"></a>    def handoff_tool(
</span><span id="__span-119-56"><a id="__codelineno-119-56" name="__codelineno-119-56" href="#__codelineno-119-56"></a>        state: Annotated[MessagesState, InjectedState], 
</span><span id="__span-119-57"><a id="__codelineno-119-57" name="__codelineno-119-57" href="#__codelineno-119-57"></a>        tool_call_id: Annotated[str, InjectedToolCallId],
</span><span id="__span-119-58"><a id="__codelineno-119-58" name="__codelineno-119-58" href="#__codelineno-119-58"></a>    ) -&gt; Command:
</span><span id="__span-119-59"><a id="__codelineno-119-59" name="__codelineno-119-59" href="#__codelineno-119-59"></a>        tool_message = {
</span><span id="__span-119-60"><a id="__codelineno-119-60" name="__codelineno-119-60" href="#__codelineno-119-60"></a>            &quot;role&quot;: &quot;tool&quot;,
</span><span id="__span-119-61"><a id="__codelineno-119-61" name="__codelineno-119-61" href="#__codelineno-119-61"></a>            &quot;content&quot;: f&quot;Successfully transferred to {agent_name}&quot;,
</span><span id="__span-119-62"><a id="__codelineno-119-62" name="__codelineno-119-62" href="#__codelineno-119-62"></a>            &quot;name&quot;: name,
</span><span id="__span-119-63"><a id="__codelineno-119-63" name="__codelineno-119-63" href="#__codelineno-119-63"></a>            &quot;tool_call_id&quot;: tool_call_id,
</span><span id="__span-119-64"><a id="__codelineno-119-64" name="__codelineno-119-64" href="#__codelineno-119-64"></a>        }
</span><span id="__span-119-65"><a id="__codelineno-119-65" name="__codelineno-119-65" href="#__codelineno-119-65"></a>        return Command(  
</span><span id="__span-119-66"><a id="__codelineno-119-66" name="__codelineno-119-66" href="#__codelineno-119-66"></a>            goto=agent_name,  
</span><span id="__span-119-67"><a id="__codelineno-119-67" name="__codelineno-119-67" href="#__codelineno-119-67"></a>            update={&quot;messages&quot;: state[&quot;messages&quot;] + [tool_message]},  
</span><span id="__span-119-68"><a id="__codelineno-119-68" name="__codelineno-119-68" href="#__codelineno-119-68"></a>            graph=Command.PARENT,  
</span><span id="__span-119-69"><a id="__codelineno-119-69" name="__codelineno-119-69" href="#__codelineno-119-69"></a>        )
</span><span id="__span-119-70"><a id="__codelineno-119-70" name="__codelineno-119-70" href="#__codelineno-119-70"></a>    return handoff_tool
</span><span id="__span-119-71"><a id="__codelineno-119-71" name="__codelineno-119-71" href="#__codelineno-119-71"></a>
</span><span id="__span-119-72"><a id="__codelineno-119-72" name="__codelineno-119-72" href="#__codelineno-119-72"></a># Handoffs
</span><span id="__span-119-73"><a id="__codelineno-119-73" name="__codelineno-119-73" href="#__codelineno-119-73"></a>transfer_to_hotel_assistant = create_handoff_tool(
</span><span id="__span-119-74"><a id="__codelineno-119-74" name="__codelineno-119-74" href="#__codelineno-119-74"></a>    agent_name=&quot;hotel_assistant&quot;,
</span><span id="__span-119-75"><a id="__codelineno-119-75" name="__codelineno-119-75" href="#__codelineno-119-75"></a>    description=&quot;Transfer user to the hotel-booking assistant.&quot;,
</span><span id="__span-119-76"><a id="__codelineno-119-76" name="__codelineno-119-76" href="#__codelineno-119-76"></a>)
</span><span id="__span-119-77"><a id="__codelineno-119-77" name="__codelineno-119-77" href="#__codelineno-119-77"></a>transfer_to_flight_assistant = create_handoff_tool(
</span><span id="__span-119-78"><a id="__codelineno-119-78" name="__codelineno-119-78" href="#__codelineno-119-78"></a>    agent_name=&quot;flight_assistant&quot;,
</span><span id="__span-119-79"><a id="__codelineno-119-79" name="__codelineno-119-79" href="#__codelineno-119-79"></a>    description=&quot;Transfer user to the flight-booking assistant.&quot;,
</span><span id="__span-119-80"><a id="__codelineno-119-80" name="__codelineno-119-80" href="#__codelineno-119-80"></a>)
</span><span id="__span-119-81"><a id="__codelineno-119-81" name="__codelineno-119-81" href="#__codelineno-119-81"></a>
</span><span id="__span-119-82"><a id="__codelineno-119-82" name="__codelineno-119-82" href="#__codelineno-119-82"></a># Simple agent tools
</span><span id="__span-119-83"><a id="__codelineno-119-83" name="__codelineno-119-83" href="#__codelineno-119-83"></a>def book_hotel(hotel_name: str):
</span><span id="__span-119-84"><a id="__codelineno-119-84" name="__codelineno-119-84" href="#__codelineno-119-84"></a>    &quot;&quot;&quot;Book a hotel&quot;&quot;&quot;
</span><span id="__span-119-85"><a id="__codelineno-119-85" name="__codelineno-119-85" href="#__codelineno-119-85"></a>    return f&quot;Successfully booked a stay at {hotel_name}.&quot;
</span><span id="__span-119-86"><a id="__codelineno-119-86" name="__codelineno-119-86" href="#__codelineno-119-86"></a>
</span><span id="__span-119-87"><a id="__codelineno-119-87" name="__codelineno-119-87" href="#__codelineno-119-87"></a>def book_flight(from_airport: str, to_airport: str):
</span><span id="__span-119-88"><a id="__codelineno-119-88" name="__codelineno-119-88" href="#__codelineno-119-88"></a>    &quot;&quot;&quot;Book a flight&quot;&quot;&quot;
</span><span id="__span-119-89"><a id="__codelineno-119-89" name="__codelineno-119-89" href="#__codelineno-119-89"></a>    return f&quot;Successfully booked a flight from {from_airport} to {to_airport}.&quot;
</span><span id="__span-119-90"><a id="__codelineno-119-90" name="__codelineno-119-90" href="#__codelineno-119-90"></a>
</span><span id="__span-119-91"><a id="__codelineno-119-91" name="__codelineno-119-91" href="#__codelineno-119-91"></a># Define agents
</span><span id="__span-119-92"><a id="__codelineno-119-92" name="__codelineno-119-92" href="#__codelineno-119-92"></a>flight_assistant = create_react_agent(
</span><span id="__span-119-93"><a id="__codelineno-119-93" name="__codelineno-119-93" href="#__codelineno-119-93"></a>    model=&quot;anthropic:claude-3-5-sonnet-latest&quot;,
</span><span id="__span-119-94"><a id="__codelineno-119-94" name="__codelineno-119-94" href="#__codelineno-119-94"></a>    tools=[book_flight, transfer_to_hotel_assistant],
</span><span id="__span-119-95"><a id="__codelineno-119-95" name="__codelineno-119-95" href="#__codelineno-119-95"></a>    prompt=&quot;You are a flight booking assistant&quot;,
</span><span id="__span-119-96"><a id="__codelineno-119-96" name="__codelineno-119-96" href="#__codelineno-119-96"></a>    name=&quot;flight_assistant&quot;
</span><span id="__span-119-97"><a id="__codelineno-119-97" name="__codelineno-119-97" href="#__codelineno-119-97"></a>)
</span><span id="__span-119-98"><a id="__codelineno-119-98" name="__codelineno-119-98" href="#__codelineno-119-98"></a>hotel_assistant = create_react_agent(
</span><span id="__span-119-99"><a id="__codelineno-119-99" name="__codelineno-119-99" href="#__codelineno-119-99"></a>    model=&quot;anthropic:claude-3-5-sonnet-latest&quot;,
</span><span id="__span-119-100"><a id="__codelineno-119-100" name="__codelineno-119-100" href="#__codelineno-119-100"></a>    tools=[book_hotel, transfer_to_flight_assistant],
</span><span id="__span-119-101"><a id="__codelineno-119-101" name="__codelineno-119-101" href="#__codelineno-119-101"></a>    prompt=&quot;You are a hotel booking assistant&quot;,
</span><span id="__span-119-102"><a id="__codelineno-119-102" name="__codelineno-119-102" href="#__codelineno-119-102"></a>    name=&quot;hotel_assistant&quot;
</span><span id="__span-119-103"><a id="__codelineno-119-103" name="__codelineno-119-103" href="#__codelineno-119-103"></a>)
</span><span id="__span-119-104"><a id="__codelineno-119-104" name="__codelineno-119-104" href="#__codelineno-119-104"></a>
</span><span id="__span-119-105"><a id="__codelineno-119-105" name="__codelineno-119-105" href="#__codelineno-119-105"></a># Define multi-agent graph
</span><span id="__span-119-106"><a id="__codelineno-119-106" name="__codelineno-119-106" href="#__codelineno-119-106"></a>multi_agent_graph = (
</span><span id="__span-119-107"><a id="__codelineno-119-107" name="__codelineno-119-107" href="#__codelineno-119-107"></a>    StateGraph(MessagesState)
</span><span id="__span-119-108"><a id="__codelineno-119-108" name="__codelineno-119-108" href="#__codelineno-119-108"></a>    .add_node(flight_assistant)
</span><span id="__span-119-109"><a id="__codelineno-119-109" name="__codelineno-119-109" href="#__codelineno-119-109"></a>    .add_node(hotel_assistant)
</span><span id="__span-119-110"><a id="__codelineno-119-110" name="__codelineno-119-110" href="#__codelineno-119-110"></a>    .add_edge(START, &quot;flight_assistant&quot;)
</span><span id="__span-119-111"><a id="__codelineno-119-111" name="__codelineno-119-111" href="#__codelineno-119-111"></a>    .compile()
</span><span id="__span-119-112"><a id="__codelineno-119-112" name="__codelineno-119-112" href="#__codelineno-119-112"></a>)
</span><span id="__span-119-113"><a id="__codelineno-119-113" name="__codelineno-119-113" href="#__codelineno-119-113"></a>
</span><span id="__span-119-114"><a id="__codelineno-119-114" name="__codelineno-119-114" href="#__codelineno-119-114"></a># Run the multi-agent graph
</span><span id="__span-119-115"><a id="__codelineno-119-115" name="__codelineno-119-115" href="#__codelineno-119-115"></a>for chunk in multi_agent_graph.stream(
</span><span id="__span-119-116"><a id="__codelineno-119-116" name="__codelineno-119-116" href="#__codelineno-119-116"></a>    {
</span><span id="__span-119-117"><a id="__codelineno-119-117" name="__codelineno-119-117" href="#__codelineno-119-117"></a>        &quot;messages&quot;: [
</span><span id="__span-119-118"><a id="__codelineno-119-118" name="__codelineno-119-118" href="#__codelineno-119-118"></a>            {
</span><span id="__span-119-119"><a id="__codelineno-119-119" name="__codelineno-119-119" href="#__codelineno-119-119"></a>                &quot;role&quot;: &quot;user&quot;,
</span><span id="__span-119-120"><a id="__codelineno-119-120" name="__codelineno-119-120" href="#__codelineno-119-120"></a>                &quot;content&quot;: &quot;book a flight from BOS to JFK and a stay at McKittrick Hotel&quot;
</span><span id="__span-119-121"><a id="__codelineno-119-121" name="__codelineno-119-121" href="#__codelineno-119-121"></a>            }
</span><span id="__span-119-122"><a id="__codelineno-119-122" name="__codelineno-119-122" href="#__codelineno-119-122"></a>        ]
</span><span id="__span-119-123"><a id="__codelineno-119-123" name="__codelineno-119-123" href="#__codelineno-119-123"></a>    },
</span><span id="__span-119-124"><a id="__codelineno-119-124" name="__codelineno-119-124" href="#__codelineno-119-124"></a>    subgraphs=True
</span><span id="__span-119-125"><a id="__codelineno-119-125" name="__codelineno-119-125" href="#__codelineno-119-125"></a>):
</span><span id="__span-119-126"><a id="__codelineno-119-126" name="__codelineno-119-126" href="#__codelineno-119-126"></a>    pretty_print_messages(chunk)
</span></code></pre></div>
<p><strong>Multi-turn conversation</strong></p>
<p>Users might want to engage in a multi-turn conversation with one or more agents. To build a system that can handle this, you can create a node that uses an interrupt to collect user input and routes back to the active agent.</p>
<p>The agents can then be implemented as nodes in a graph that executes agent steps and determines the next action:</p>
<ol>
<li>
<p><strong>Wait for user input</strong> to continue the conversation, or</p>
</li>
<li>
<p><strong>Route to another agent</strong> (or back to itself, such as in a loop) via a handoff</p>
</li>
</ol>
<div class="language-text highlight"><pre><span></span><code><span id="__span-120-1"><a id="__codelineno-120-1" name="__codelineno-120-1" href="#__codelineno-120-1"></a>def human(state) -&gt; Command[Literal[&quot;agent&quot;, &quot;another_agent&quot;]]:
</span><span id="__span-120-2"><a id="__codelineno-120-2" name="__codelineno-120-2" href="#__codelineno-120-2"></a>    &quot;&quot;&quot;A node for collecting user input.&quot;&quot;&quot;
</span><span id="__span-120-3"><a id="__codelineno-120-3" name="__codelineno-120-3" href="#__codelineno-120-3"></a>    user_input = interrupt(value=&quot;Ready for user input.&quot;)
</span><span id="__span-120-4"><a id="__codelineno-120-4" name="__codelineno-120-4" href="#__codelineno-120-4"></a>
</span><span id="__span-120-5"><a id="__codelineno-120-5" name="__codelineno-120-5" href="#__codelineno-120-5"></a>    # Determine the active agent.
</span><span id="__span-120-6"><a id="__codelineno-120-6" name="__codelineno-120-6" href="#__codelineno-120-6"></a>    active_agent = ...
</span><span id="__span-120-7"><a id="__codelineno-120-7" name="__codelineno-120-7" href="#__codelineno-120-7"></a>
</span><span id="__span-120-8"><a id="__codelineno-120-8" name="__codelineno-120-8" href="#__codelineno-120-8"></a>    ...
</span><span id="__span-120-9"><a id="__codelineno-120-9" name="__codelineno-120-9" href="#__codelineno-120-9"></a>    return Command(
</span><span id="__span-120-10"><a id="__codelineno-120-10" name="__codelineno-120-10" href="#__codelineno-120-10"></a>        update={
</span><span id="__span-120-11"><a id="__codelineno-120-11" name="__codelineno-120-11" href="#__codelineno-120-11"></a>            &quot;messages&quot;: [{
</span><span id="__span-120-12"><a id="__codelineno-120-12" name="__codelineno-120-12" href="#__codelineno-120-12"></a>                &quot;role&quot;: &quot;human&quot;,
</span><span id="__span-120-13"><a id="__codelineno-120-13" name="__codelineno-120-13" href="#__codelineno-120-13"></a>                &quot;content&quot;: user_input,
</span><span id="__span-120-14"><a id="__codelineno-120-14" name="__codelineno-120-14" href="#__codelineno-120-14"></a>            }]
</span><span id="__span-120-15"><a id="__codelineno-120-15" name="__codelineno-120-15" href="#__codelineno-120-15"></a>        },
</span><span id="__span-120-16"><a id="__codelineno-120-16" name="__codelineno-120-16" href="#__codelineno-120-16"></a>        goto=active_agent
</span><span id="__span-120-17"><a id="__codelineno-120-17" name="__codelineno-120-17" href="#__codelineno-120-17"></a>    )
</span><span id="__span-120-18"><a id="__codelineno-120-18" name="__codelineno-120-18" href="#__codelineno-120-18"></a>
</span><span id="__span-120-19"><a id="__codelineno-120-19" name="__codelineno-120-19" href="#__codelineno-120-19"></a>def agent(state) -&gt; Command[Literal[&quot;agent&quot;, &quot;another_agent&quot;, &quot;human&quot;]]:
</span><span id="__span-120-20"><a id="__codelineno-120-20" name="__codelineno-120-20" href="#__codelineno-120-20"></a>    # The condition for routing/halting can be anything, e.g. LLM tool call / structured output, etc.
</span><span id="__span-120-21"><a id="__codelineno-120-21" name="__codelineno-120-21" href="#__codelineno-120-21"></a>    goto = get_next_agent(...)  # &#39;agent&#39; / &#39;another_agent&#39;
</span><span id="__span-120-22"><a id="__codelineno-120-22" name="__codelineno-120-22" href="#__codelineno-120-22"></a>    if goto:
</span><span id="__span-120-23"><a id="__codelineno-120-23" name="__codelineno-120-23" href="#__codelineno-120-23"></a>        return Command(goto=goto, update={&quot;my_state_key&quot;: &quot;my_state_value&quot;})
</span><span id="__span-120-24"><a id="__codelineno-120-24" name="__codelineno-120-24" href="#__codelineno-120-24"></a>    else:
</span><span id="__span-120-25"><a id="__codelineno-120-25" name="__codelineno-120-25" href="#__codelineno-120-25"></a>        return Command(goto=&quot;human&quot;) # Go to human node
</span></code></pre></div>
<h2 id="mcp">MCP<a class="headerlink" href="#mcp" title="Permanent link">#</a></h2>
<p>Model Context Protocol (MCP) is an open protocol that standardizes how applications provide tools and context to language models. LangGraph agents can use tools defined on MCP servers through the langchain-mcp-adapters library.</p>
<p><img alt="alt text" src="./image/langgraph16.png" /></p>
<p>Install the <code>langchain-mcp-adapters</code> library to use MCP tools in LangGraph:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-121-1"><a id="__codelineno-121-1" name="__codelineno-121-1" href="#__codelineno-121-1"></a>pip install langchain-mcp-adapters
</span></code></pre></div>
<p><strong>Use MCP tools</strong></p>
<p>The <code>langchain-mcp-adapters</code> package enables agents to use tools defined across one or more MCP servers.</p>
<p><strong>In an agent</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-122-1"><a id="__codelineno-122-1" name="__codelineno-122-1" href="#__codelineno-122-1"></a>from langchain_mcp_adapters.client import MultiServerMCPClient
</span><span id="__span-122-2"><a id="__codelineno-122-2" name="__codelineno-122-2" href="#__codelineno-122-2"></a>from langgraph.prebuilt import create_react_agent
</span><span id="__span-122-3"><a id="__codelineno-122-3" name="__codelineno-122-3" href="#__codelineno-122-3"></a>
</span><span id="__span-122-4"><a id="__codelineno-122-4" name="__codelineno-122-4" href="#__codelineno-122-4"></a>client = MultiServerMCPClient(
</span><span id="__span-122-5"><a id="__codelineno-122-5" name="__codelineno-122-5" href="#__codelineno-122-5"></a>    {
</span><span id="__span-122-6"><a id="__codelineno-122-6" name="__codelineno-122-6" href="#__codelineno-122-6"></a>        &quot;math&quot;: {
</span><span id="__span-122-7"><a id="__codelineno-122-7" name="__codelineno-122-7" href="#__codelineno-122-7"></a>            &quot;command&quot;: &quot;python&quot;,
</span><span id="__span-122-8"><a id="__codelineno-122-8" name="__codelineno-122-8" href="#__codelineno-122-8"></a>            # Replace with absolute path to your math_server.py file
</span><span id="__span-122-9"><a id="__codelineno-122-9" name="__codelineno-122-9" href="#__codelineno-122-9"></a>            &quot;args&quot;: [&quot;/path/to/math_server.py&quot;],
</span><span id="__span-122-10"><a id="__codelineno-122-10" name="__codelineno-122-10" href="#__codelineno-122-10"></a>            &quot;transport&quot;: &quot;stdio&quot;,
</span><span id="__span-122-11"><a id="__codelineno-122-11" name="__codelineno-122-11" href="#__codelineno-122-11"></a>        },
</span><span id="__span-122-12"><a id="__codelineno-122-12" name="__codelineno-122-12" href="#__codelineno-122-12"></a>        &quot;weather&quot;: {
</span><span id="__span-122-13"><a id="__codelineno-122-13" name="__codelineno-122-13" href="#__codelineno-122-13"></a>            # Ensure you start your weather server on port 8000
</span><span id="__span-122-14"><a id="__codelineno-122-14" name="__codelineno-122-14" href="#__codelineno-122-14"></a>            &quot;url&quot;: &quot;http://localhost:8000/mcp&quot;,
</span><span id="__span-122-15"><a id="__codelineno-122-15" name="__codelineno-122-15" href="#__codelineno-122-15"></a>            &quot;transport&quot;: &quot;streamable_http&quot;,
</span><span id="__span-122-16"><a id="__codelineno-122-16" name="__codelineno-122-16" href="#__codelineno-122-16"></a>        }
</span><span id="__span-122-17"><a id="__codelineno-122-17" name="__codelineno-122-17" href="#__codelineno-122-17"></a>    }
</span><span id="__span-122-18"><a id="__codelineno-122-18" name="__codelineno-122-18" href="#__codelineno-122-18"></a>)
</span><span id="__span-122-19"><a id="__codelineno-122-19" name="__codelineno-122-19" href="#__codelineno-122-19"></a>tools = await client.get_tools()
</span><span id="__span-122-20"><a id="__codelineno-122-20" name="__codelineno-122-20" href="#__codelineno-122-20"></a>agent = create_react_agent(
</span><span id="__span-122-21"><a id="__codelineno-122-21" name="__codelineno-122-21" href="#__codelineno-122-21"></a>    &quot;anthropic:claude-3-7-sonnet-latest&quot;,
</span><span id="__span-122-22"><a id="__codelineno-122-22" name="__codelineno-122-22" href="#__codelineno-122-22"></a>    tools
</span><span id="__span-122-23"><a id="__codelineno-122-23" name="__codelineno-122-23" href="#__codelineno-122-23"></a>)
</span><span id="__span-122-24"><a id="__codelineno-122-24" name="__codelineno-122-24" href="#__codelineno-122-24"></a>math_response = await agent.ainvoke(
</span><span id="__span-122-25"><a id="__codelineno-122-25" name="__codelineno-122-25" href="#__codelineno-122-25"></a>    {&quot;messages&quot;: [{&quot;role&quot;: &quot;user&quot;, &quot;content&quot;: &quot;what&#39;s (3 + 5) x 12?&quot;}]}
</span><span id="__span-122-26"><a id="__codelineno-122-26" name="__codelineno-122-26" href="#__codelineno-122-26"></a>)
</span><span id="__span-122-27"><a id="__codelineno-122-27" name="__codelineno-122-27" href="#__codelineno-122-27"></a>weather_response = await agent.ainvoke(
</span><span id="__span-122-28"><a id="__codelineno-122-28" name="__codelineno-122-28" href="#__codelineno-122-28"></a>    {&quot;messages&quot;: [{&quot;role&quot;: &quot;user&quot;, &quot;content&quot;: &quot;what is the weather in nyc?&quot;}]}
</span><span id="__span-122-29"><a id="__codelineno-122-29" name="__codelineno-122-29" href="#__codelineno-122-29"></a>)
</span></code></pre></div>
<p><strong>In a workflow</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-123-1"><a id="__codelineno-123-1" name="__codelineno-123-1" href="#__codelineno-123-1"></a>from langchain_mcp_adapters.client import MultiServerMCPClient
</span><span id="__span-123-2"><a id="__codelineno-123-2" name="__codelineno-123-2" href="#__codelineno-123-2"></a>from langchain.chat_models import init_chat_model
</span><span id="__span-123-3"><a id="__codelineno-123-3" name="__codelineno-123-3" href="#__codelineno-123-3"></a>from langgraph.graph import StateGraph, MessagesState, START, END
</span><span id="__span-123-4"><a id="__codelineno-123-4" name="__codelineno-123-4" href="#__codelineno-123-4"></a>from langgraph.prebuilt import ToolNode
</span><span id="__span-123-5"><a id="__codelineno-123-5" name="__codelineno-123-5" href="#__codelineno-123-5"></a>
</span><span id="__span-123-6"><a id="__codelineno-123-6" name="__codelineno-123-6" href="#__codelineno-123-6"></a># Initialize the model
</span><span id="__span-123-7"><a id="__codelineno-123-7" name="__codelineno-123-7" href="#__codelineno-123-7"></a>model = init_chat_model(&quot;anthropic:claude-3-5-sonnet-latest&quot;)
</span><span id="__span-123-8"><a id="__codelineno-123-8" name="__codelineno-123-8" href="#__codelineno-123-8"></a>
</span><span id="__span-123-9"><a id="__codelineno-123-9" name="__codelineno-123-9" href="#__codelineno-123-9"></a># Set up MCP client
</span><span id="__span-123-10"><a id="__codelineno-123-10" name="__codelineno-123-10" href="#__codelineno-123-10"></a>client = MultiServerMCPClient(
</span><span id="__span-123-11"><a id="__codelineno-123-11" name="__codelineno-123-11" href="#__codelineno-123-11"></a>    {
</span><span id="__span-123-12"><a id="__codelineno-123-12" name="__codelineno-123-12" href="#__codelineno-123-12"></a>        &quot;math&quot;: {
</span><span id="__span-123-13"><a id="__codelineno-123-13" name="__codelineno-123-13" href="#__codelineno-123-13"></a>            &quot;command&quot;: &quot;python&quot;,
</span><span id="__span-123-14"><a id="__codelineno-123-14" name="__codelineno-123-14" href="#__codelineno-123-14"></a>            # Make sure to update to the full absolute path to your math_server.py file
</span><span id="__span-123-15"><a id="__codelineno-123-15" name="__codelineno-123-15" href="#__codelineno-123-15"></a>            &quot;args&quot;: [&quot;./examples/math_server.py&quot;],
</span><span id="__span-123-16"><a id="__codelineno-123-16" name="__codelineno-123-16" href="#__codelineno-123-16"></a>            &quot;transport&quot;: &quot;stdio&quot;,
</span><span id="__span-123-17"><a id="__codelineno-123-17" name="__codelineno-123-17" href="#__codelineno-123-17"></a>        },
</span><span id="__span-123-18"><a id="__codelineno-123-18" name="__codelineno-123-18" href="#__codelineno-123-18"></a>        &quot;weather&quot;: {
</span><span id="__span-123-19"><a id="__codelineno-123-19" name="__codelineno-123-19" href="#__codelineno-123-19"></a>            # make sure you start your weather server on port 8000
</span><span id="__span-123-20"><a id="__codelineno-123-20" name="__codelineno-123-20" href="#__codelineno-123-20"></a>            &quot;url&quot;: &quot;http://localhost:8000/mcp/&quot;,
</span><span id="__span-123-21"><a id="__codelineno-123-21" name="__codelineno-123-21" href="#__codelineno-123-21"></a>            &quot;transport&quot;: &quot;streamable_http&quot;,
</span><span id="__span-123-22"><a id="__codelineno-123-22" name="__codelineno-123-22" href="#__codelineno-123-22"></a>        }
</span><span id="__span-123-23"><a id="__codelineno-123-23" name="__codelineno-123-23" href="#__codelineno-123-23"></a>    }
</span><span id="__span-123-24"><a id="__codelineno-123-24" name="__codelineno-123-24" href="#__codelineno-123-24"></a>)
</span><span id="__span-123-25"><a id="__codelineno-123-25" name="__codelineno-123-25" href="#__codelineno-123-25"></a>tools = await client.get_tools()
</span><span id="__span-123-26"><a id="__codelineno-123-26" name="__codelineno-123-26" href="#__codelineno-123-26"></a>
</span><span id="__span-123-27"><a id="__codelineno-123-27" name="__codelineno-123-27" href="#__codelineno-123-27"></a># Bind tools to model
</span><span id="__span-123-28"><a id="__codelineno-123-28" name="__codelineno-123-28" href="#__codelineno-123-28"></a>model_with_tools = model.bind_tools(tools)
</span><span id="__span-123-29"><a id="__codelineno-123-29" name="__codelineno-123-29" href="#__codelineno-123-29"></a>
</span><span id="__span-123-30"><a id="__codelineno-123-30" name="__codelineno-123-30" href="#__codelineno-123-30"></a># Create ToolNode
</span><span id="__span-123-31"><a id="__codelineno-123-31" name="__codelineno-123-31" href="#__codelineno-123-31"></a>tool_node = ToolNode(tools)
</span><span id="__span-123-32"><a id="__codelineno-123-32" name="__codelineno-123-32" href="#__codelineno-123-32"></a>
</span><span id="__span-123-33"><a id="__codelineno-123-33" name="__codelineno-123-33" href="#__codelineno-123-33"></a>def should_continue(state: MessagesState):
</span><span id="__span-123-34"><a id="__codelineno-123-34" name="__codelineno-123-34" href="#__codelineno-123-34"></a>    messages = state[&quot;messages&quot;]
</span><span id="__span-123-35"><a id="__codelineno-123-35" name="__codelineno-123-35" href="#__codelineno-123-35"></a>    last_message = messages[-1]
</span><span id="__span-123-36"><a id="__codelineno-123-36" name="__codelineno-123-36" href="#__codelineno-123-36"></a>    if last_message.tool_calls:
</span><span id="__span-123-37"><a id="__codelineno-123-37" name="__codelineno-123-37" href="#__codelineno-123-37"></a>        return &quot;tools&quot;
</span><span id="__span-123-38"><a id="__codelineno-123-38" name="__codelineno-123-38" href="#__codelineno-123-38"></a>    return END
</span><span id="__span-123-39"><a id="__codelineno-123-39" name="__codelineno-123-39" href="#__codelineno-123-39"></a>
</span><span id="__span-123-40"><a id="__codelineno-123-40" name="__codelineno-123-40" href="#__codelineno-123-40"></a># Define call_model function
</span><span id="__span-123-41"><a id="__codelineno-123-41" name="__codelineno-123-41" href="#__codelineno-123-41"></a>async def call_model(state: MessagesState):
</span><span id="__span-123-42"><a id="__codelineno-123-42" name="__codelineno-123-42" href="#__codelineno-123-42"></a>    messages = state[&quot;messages&quot;]
</span><span id="__span-123-43"><a id="__codelineno-123-43" name="__codelineno-123-43" href="#__codelineno-123-43"></a>    response = await model_with_tools.ainvoke(messages)
</span><span id="__span-123-44"><a id="__codelineno-123-44" name="__codelineno-123-44" href="#__codelineno-123-44"></a>    return {&quot;messages&quot;: [response]}
</span><span id="__span-123-45"><a id="__codelineno-123-45" name="__codelineno-123-45" href="#__codelineno-123-45"></a>
</span><span id="__span-123-46"><a id="__codelineno-123-46" name="__codelineno-123-46" href="#__codelineno-123-46"></a># Build the graph
</span><span id="__span-123-47"><a id="__codelineno-123-47" name="__codelineno-123-47" href="#__codelineno-123-47"></a>builder = StateGraph(MessagesState)
</span><span id="__span-123-48"><a id="__codelineno-123-48" name="__codelineno-123-48" href="#__codelineno-123-48"></a>builder.add_node(&quot;call_model&quot;, call_model)
</span><span id="__span-123-49"><a id="__codelineno-123-49" name="__codelineno-123-49" href="#__codelineno-123-49"></a>builder.add_node(&quot;tools&quot;, tool_node)
</span><span id="__span-123-50"><a id="__codelineno-123-50" name="__codelineno-123-50" href="#__codelineno-123-50"></a>
</span><span id="__span-123-51"><a id="__codelineno-123-51" name="__codelineno-123-51" href="#__codelineno-123-51"></a>builder.add_edge(START, &quot;call_model&quot;)
</span><span id="__span-123-52"><a id="__codelineno-123-52" name="__codelineno-123-52" href="#__codelineno-123-52"></a>builder.add_conditional_edges(
</span><span id="__span-123-53"><a id="__codelineno-123-53" name="__codelineno-123-53" href="#__codelineno-123-53"></a>    &quot;call_model&quot;,
</span><span id="__span-123-54"><a id="__codelineno-123-54" name="__codelineno-123-54" href="#__codelineno-123-54"></a>    should_continue,
</span><span id="__span-123-55"><a id="__codelineno-123-55" name="__codelineno-123-55" href="#__codelineno-123-55"></a>)
</span><span id="__span-123-56"><a id="__codelineno-123-56" name="__codelineno-123-56" href="#__codelineno-123-56"></a>builder.add_edge(&quot;tools&quot;, &quot;call_model&quot;)
</span><span id="__span-123-57"><a id="__codelineno-123-57" name="__codelineno-123-57" href="#__codelineno-123-57"></a>
</span><span id="__span-123-58"><a id="__codelineno-123-58" name="__codelineno-123-58" href="#__codelineno-123-58"></a># Compile the graph
</span><span id="__span-123-59"><a id="__codelineno-123-59" name="__codelineno-123-59" href="#__codelineno-123-59"></a>graph = builder.compile()
</span><span id="__span-123-60"><a id="__codelineno-123-60" name="__codelineno-123-60" href="#__codelineno-123-60"></a>
</span><span id="__span-123-61"><a id="__codelineno-123-61" name="__codelineno-123-61" href="#__codelineno-123-61"></a># Test the graph
</span><span id="__span-123-62"><a id="__codelineno-123-62" name="__codelineno-123-62" href="#__codelineno-123-62"></a>math_response = await graph.ainvoke(
</span><span id="__span-123-63"><a id="__codelineno-123-63" name="__codelineno-123-63" href="#__codelineno-123-63"></a>    {&quot;messages&quot;: [{&quot;role&quot;: &quot;user&quot;, &quot;content&quot;: &quot;what&#39;s (3 + 5) x 12?&quot;}]}
</span><span id="__span-123-64"><a id="__codelineno-123-64" name="__codelineno-123-64" href="#__codelineno-123-64"></a>)
</span><span id="__span-123-65"><a id="__codelineno-123-65" name="__codelineno-123-65" href="#__codelineno-123-65"></a>weather_response = await graph.ainvoke(
</span><span id="__span-123-66"><a id="__codelineno-123-66" name="__codelineno-123-66" href="#__codelineno-123-66"></a>    {&quot;messages&quot;: [{&quot;role&quot;: &quot;user&quot;, &quot;content&quot;: &quot;what is the weather in nyc?&quot;}]}
</span><span id="__span-123-67"><a id="__codelineno-123-67" name="__codelineno-123-67" href="#__codelineno-123-67"></a>)
</span></code></pre></div>
<p><strong>Custom MCP servers</strong></p>
<p>To create your own MCP servers, you can use the mcp library. This library provides a simple way to define tools and run them as servers.</p>
<p>Install the MCP library:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-124-1"><a id="__codelineno-124-1" name="__codelineno-124-1" href="#__codelineno-124-1"></a>pip install mcp
</span></code></pre></div>
<p>Use the following reference implementations to test your agent with MCP tool servers.</p>
<p><strong>Example Math Server (stdio transport)</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-125-1"><a id="__codelineno-125-1" name="__codelineno-125-1" href="#__codelineno-125-1"></a>from mcp.server.fastmcp import FastMCP
</span><span id="__span-125-2"><a id="__codelineno-125-2" name="__codelineno-125-2" href="#__codelineno-125-2"></a>
</span><span id="__span-125-3"><a id="__codelineno-125-3" name="__codelineno-125-3" href="#__codelineno-125-3"></a>mcp = FastMCP(&quot;Math&quot;)
</span><span id="__span-125-4"><a id="__codelineno-125-4" name="__codelineno-125-4" href="#__codelineno-125-4"></a>
</span><span id="__span-125-5"><a id="__codelineno-125-5" name="__codelineno-125-5" href="#__codelineno-125-5"></a>@mcp.tool()
</span><span id="__span-125-6"><a id="__codelineno-125-6" name="__codelineno-125-6" href="#__codelineno-125-6"></a>def add(a: int, b: int) -&gt; int:
</span><span id="__span-125-7"><a id="__codelineno-125-7" name="__codelineno-125-7" href="#__codelineno-125-7"></a>    &quot;&quot;&quot;Add two numbers&quot;&quot;&quot;
</span><span id="__span-125-8"><a id="__codelineno-125-8" name="__codelineno-125-8" href="#__codelineno-125-8"></a>    return a + b
</span><span id="__span-125-9"><a id="__codelineno-125-9" name="__codelineno-125-9" href="#__codelineno-125-9"></a>
</span><span id="__span-125-10"><a id="__codelineno-125-10" name="__codelineno-125-10" href="#__codelineno-125-10"></a>@mcp.tool()
</span><span id="__span-125-11"><a id="__codelineno-125-11" name="__codelineno-125-11" href="#__codelineno-125-11"></a>def multiply(a: int, b: int) -&gt; int:
</span><span id="__span-125-12"><a id="__codelineno-125-12" name="__codelineno-125-12" href="#__codelineno-125-12"></a>    &quot;&quot;&quot;Multiply two numbers&quot;&quot;&quot;
</span><span id="__span-125-13"><a id="__codelineno-125-13" name="__codelineno-125-13" href="#__codelineno-125-13"></a>    return a * b
</span><span id="__span-125-14"><a id="__codelineno-125-14" name="__codelineno-125-14" href="#__codelineno-125-14"></a>
</span><span id="__span-125-15"><a id="__codelineno-125-15" name="__codelineno-125-15" href="#__codelineno-125-15"></a>if __name__ == &quot;__main__&quot;:
</span><span id="__span-125-16"><a id="__codelineno-125-16" name="__codelineno-125-16" href="#__codelineno-125-16"></a>    mcp.run(transport=&quot;stdio&quot;)
</span></code></pre></div>
<p><strong>Example Weather Server (Streamable HTTP transport)</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-126-1"><a id="__codelineno-126-1" name="__codelineno-126-1" href="#__codelineno-126-1"></a>from mcp.server.fastmcp import FastMCP
</span><span id="__span-126-2"><a id="__codelineno-126-2" name="__codelineno-126-2" href="#__codelineno-126-2"></a>
</span><span id="__span-126-3"><a id="__codelineno-126-3" name="__codelineno-126-3" href="#__codelineno-126-3"></a>mcp = FastMCP(&quot;Weather&quot;)
</span><span id="__span-126-4"><a id="__codelineno-126-4" name="__codelineno-126-4" href="#__codelineno-126-4"></a>
</span><span id="__span-126-5"><a id="__codelineno-126-5" name="__codelineno-126-5" href="#__codelineno-126-5"></a>@mcp.tool()
</span><span id="__span-126-6"><a id="__codelineno-126-6" name="__codelineno-126-6" href="#__codelineno-126-6"></a>async def get_weather(location: str) -&gt; str:
</span><span id="__span-126-7"><a id="__codelineno-126-7" name="__codelineno-126-7" href="#__codelineno-126-7"></a>    &quot;&quot;&quot;Get weather for location.&quot;&quot;&quot;
</span><span id="__span-126-8"><a id="__codelineno-126-8" name="__codelineno-126-8" href="#__codelineno-126-8"></a>    return &quot;It&#39;s always sunny in New York&quot;
</span><span id="__span-126-9"><a id="__codelineno-126-9" name="__codelineno-126-9" href="#__codelineno-126-9"></a>
</span><span id="__span-126-10"><a id="__codelineno-126-10" name="__codelineno-126-10" href="#__codelineno-126-10"></a>if __name__ == &quot;__main__&quot;:
</span><span id="__span-126-11"><a id="__codelineno-126-11" name="__codelineno-126-11" href="#__codelineno-126-11"></a>    mcp.run(transport=&quot;streamable-http&quot;)
</span></code></pre></div>
<h2 id="tracing">Tracing<a class="headerlink" href="#tracing" title="Permanent link">#</a></h2>
<p>Traces are a series of steps that your application takes to go from input to output. Each of these individual steps is represented by a run. You can use <code>LangSmith</code> to visualize these execution steps. To use it, enable tracing for your application. This enables you to do the following:</p>
<p><strong>Enable tracing for your application</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-127-1"><a id="__codelineno-127-1" name="__codelineno-127-1" href="#__codelineno-127-1"></a>export LANGSMITH_TRACING=true
</span><span id="__span-127-2"><a id="__codelineno-127-2" name="__codelineno-127-2" href="#__codelineno-127-2"></a>export LANGSMITH_API_KEY=&lt;your-api-key&gt;
</span></code></pre></div>
<h2 id="evals">Evals<a class="headerlink" href="#evals" title="Permanent link">#</a></h2>
<p>To evaluate your agent's performance you can use LangSmith evaluations. You would need to first define an evaluator function to judge the results from an agent, such as final outputs or trajectory. Depending on your evaluation technique, this may or may not involve a reference output:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-128-1"><a id="__codelineno-128-1" name="__codelineno-128-1" href="#__codelineno-128-1"></a>def evaluator(*, outputs: dict, reference_outputs: dict):
</span><span id="__span-128-2"><a id="__codelineno-128-2" name="__codelineno-128-2" href="#__codelineno-128-2"></a>    # compare agent outputs against reference outputs
</span><span id="__span-128-3"><a id="__codelineno-128-3" name="__codelineno-128-3" href="#__codelineno-128-3"></a>    output_messages = outputs[&quot;messages&quot;]
</span><span id="__span-128-4"><a id="__codelineno-128-4" name="__codelineno-128-4" href="#__codelineno-128-4"></a>    reference_messages = reference_outputs[&quot;messages&quot;]
</span><span id="__span-128-5"><a id="__codelineno-128-5" name="__codelineno-128-5" href="#__codelineno-128-5"></a>    score = compare_messages(output_messages, reference_messages)
</span><span id="__span-128-6"><a id="__codelineno-128-6" name="__codelineno-128-6" href="#__codelineno-128-6"></a>    return {&quot;key&quot;: &quot;evaluator_score&quot;, &quot;score&quot;: score}
</span></code></pre></div>
<p>To get started, you can use prebuilt evaluators from AgentEvals package:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-129-1"><a id="__codelineno-129-1" name="__codelineno-129-1" href="#__codelineno-129-1"></a>pip install -U agentevals
</span></code></pre></div>
<p><strong>Create evaluator</strong></p>
<p>A common way to evaluate agent performance is by comparing its trajectory (the order in which it calls its tools) against a reference trajectory:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-130-1"><a id="__codelineno-130-1" name="__codelineno-130-1" href="#__codelineno-130-1"></a>import json
</span><span id="__span-130-2"><a id="__codelineno-130-2" name="__codelineno-130-2" href="#__codelineno-130-2"></a>from agentevals.trajectory.match import create_trajectory_match_evaluator
</span><span id="__span-130-3"><a id="__codelineno-130-3" name="__codelineno-130-3" href="#__codelineno-130-3"></a>
</span><span id="__span-130-4"><a id="__codelineno-130-4" name="__codelineno-130-4" href="#__codelineno-130-4"></a>outputs = [
</span><span id="__span-130-5"><a id="__codelineno-130-5" name="__codelineno-130-5" href="#__codelineno-130-5"></a>    {
</span><span id="__span-130-6"><a id="__codelineno-130-6" name="__codelineno-130-6" href="#__codelineno-130-6"></a>        &quot;role&quot;: &quot;assistant&quot;,
</span><span id="__span-130-7"><a id="__codelineno-130-7" name="__codelineno-130-7" href="#__codelineno-130-7"></a>        &quot;tool_calls&quot;: [
</span><span id="__span-130-8"><a id="__codelineno-130-8" name="__codelineno-130-8" href="#__codelineno-130-8"></a>            {
</span><span id="__span-130-9"><a id="__codelineno-130-9" name="__codelineno-130-9" href="#__codelineno-130-9"></a>                &quot;function&quot;: {
</span><span id="__span-130-10"><a id="__codelineno-130-10" name="__codelineno-130-10" href="#__codelineno-130-10"></a>                    &quot;name&quot;: &quot;get_weather&quot;,
</span><span id="__span-130-11"><a id="__codelineno-130-11" name="__codelineno-130-11" href="#__codelineno-130-11"></a>                    &quot;arguments&quot;: json.dumps({&quot;city&quot;: &quot;san francisco&quot;}),
</span><span id="__span-130-12"><a id="__codelineno-130-12" name="__codelineno-130-12" href="#__codelineno-130-12"></a>                }
</span><span id="__span-130-13"><a id="__codelineno-130-13" name="__codelineno-130-13" href="#__codelineno-130-13"></a>            },
</span><span id="__span-130-14"><a id="__codelineno-130-14" name="__codelineno-130-14" href="#__codelineno-130-14"></a>            {
</span><span id="__span-130-15"><a id="__codelineno-130-15" name="__codelineno-130-15" href="#__codelineno-130-15"></a>                &quot;function&quot;: {
</span><span id="__span-130-16"><a id="__codelineno-130-16" name="__codelineno-130-16" href="#__codelineno-130-16"></a>                    &quot;name&quot;: &quot;get_directions&quot;,
</span><span id="__span-130-17"><a id="__codelineno-130-17" name="__codelineno-130-17" href="#__codelineno-130-17"></a>                    &quot;arguments&quot;: json.dumps({&quot;destination&quot;: &quot;presidio&quot;}),
</span><span id="__span-130-18"><a id="__codelineno-130-18" name="__codelineno-130-18" href="#__codelineno-130-18"></a>                }
</span><span id="__span-130-19"><a id="__codelineno-130-19" name="__codelineno-130-19" href="#__codelineno-130-19"></a>            }
</span><span id="__span-130-20"><a id="__codelineno-130-20" name="__codelineno-130-20" href="#__codelineno-130-20"></a>        ],
</span><span id="__span-130-21"><a id="__codelineno-130-21" name="__codelineno-130-21" href="#__codelineno-130-21"></a>    }
</span><span id="__span-130-22"><a id="__codelineno-130-22" name="__codelineno-130-22" href="#__codelineno-130-22"></a>]
</span><span id="__span-130-23"><a id="__codelineno-130-23" name="__codelineno-130-23" href="#__codelineno-130-23"></a>reference_outputs = [
</span><span id="__span-130-24"><a id="__codelineno-130-24" name="__codelineno-130-24" href="#__codelineno-130-24"></a>    {
</span><span id="__span-130-25"><a id="__codelineno-130-25" name="__codelineno-130-25" href="#__codelineno-130-25"></a>        &quot;role&quot;: &quot;assistant&quot;,
</span><span id="__span-130-26"><a id="__codelineno-130-26" name="__codelineno-130-26" href="#__codelineno-130-26"></a>        &quot;tool_calls&quot;: [
</span><span id="__span-130-27"><a id="__codelineno-130-27" name="__codelineno-130-27" href="#__codelineno-130-27"></a>            {
</span><span id="__span-130-28"><a id="__codelineno-130-28" name="__codelineno-130-28" href="#__codelineno-130-28"></a>                &quot;function&quot;: {
</span><span id="__span-130-29"><a id="__codelineno-130-29" name="__codelineno-130-29" href="#__codelineno-130-29"></a>                    &quot;name&quot;: &quot;get_weather&quot;,
</span><span id="__span-130-30"><a id="__codelineno-130-30" name="__codelineno-130-30" href="#__codelineno-130-30"></a>                    &quot;arguments&quot;: json.dumps({&quot;city&quot;: &quot;san francisco&quot;}),
</span><span id="__span-130-31"><a id="__codelineno-130-31" name="__codelineno-130-31" href="#__codelineno-130-31"></a>                }
</span><span id="__span-130-32"><a id="__codelineno-130-32" name="__codelineno-130-32" href="#__codelineno-130-32"></a>            },
</span><span id="__span-130-33"><a id="__codelineno-130-33" name="__codelineno-130-33" href="#__codelineno-130-33"></a>        ],
</span><span id="__span-130-34"><a id="__codelineno-130-34" name="__codelineno-130-34" href="#__codelineno-130-34"></a>    }
</span><span id="__span-130-35"><a id="__codelineno-130-35" name="__codelineno-130-35" href="#__codelineno-130-35"></a>]
</span><span id="__span-130-36"><a id="__codelineno-130-36" name="__codelineno-130-36" href="#__codelineno-130-36"></a>
</span><span id="__span-130-37"><a id="__codelineno-130-37" name="__codelineno-130-37" href="#__codelineno-130-37"></a># Create the evaluator
</span><span id="__span-130-38"><a id="__codelineno-130-38" name="__codelineno-130-38" href="#__codelineno-130-38"></a>evaluator = create_trajectory_match_evaluator(
</span><span id="__span-130-39"><a id="__codelineno-130-39" name="__codelineno-130-39" href="#__codelineno-130-39"></a>    trajectory_match_mode=&quot;superset&quot;,  
</span><span id="__span-130-40"><a id="__codelineno-130-40" name="__codelineno-130-40" href="#__codelineno-130-40"></a>)
</span><span id="__span-130-41"><a id="__codelineno-130-41" name="__codelineno-130-41" href="#__codelineno-130-41"></a>
</span><span id="__span-130-42"><a id="__codelineno-130-42" name="__codelineno-130-42" href="#__codelineno-130-42"></a># Run the evaluator
</span><span id="__span-130-43"><a id="__codelineno-130-43" name="__codelineno-130-43" href="#__codelineno-130-43"></a>result = evaluator(
</span><span id="__span-130-44"><a id="__codelineno-130-44" name="__codelineno-130-44" href="#__codelineno-130-44"></a>    outputs=outputs, reference_outputs=reference_outputs
</span><span id="__span-130-45"><a id="__codelineno-130-45" name="__codelineno-130-45" href="#__codelineno-130-45"></a>)
</span></code></pre></div>
<p><strong>LLM-as-a-judge</strong></p>
<p>You can use LLM-as-a-judge evaluator that uses an LLM to compare the trajectory against the reference outputs and output a score:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-131-1"><a id="__codelineno-131-1" name="__codelineno-131-1" href="#__codelineno-131-1"></a>import json
</span><span id="__span-131-2"><a id="__codelineno-131-2" name="__codelineno-131-2" href="#__codelineno-131-2"></a>from agentevals.trajectory.llm import (
</span><span id="__span-131-3"><a id="__codelineno-131-3" name="__codelineno-131-3" href="#__codelineno-131-3"></a>    create_trajectory_llm_as_judge,
</span><span id="__span-131-4"><a id="__codelineno-131-4" name="__codelineno-131-4" href="#__codelineno-131-4"></a>    TRAJECTORY_ACCURACY_PROMPT_WITH_REFERENCE
</span><span id="__span-131-5"><a id="__codelineno-131-5" name="__codelineno-131-5" href="#__codelineno-131-5"></a>)
</span><span id="__span-131-6"><a id="__codelineno-131-6" name="__codelineno-131-6" href="#__codelineno-131-6"></a>
</span><span id="__span-131-7"><a id="__codelineno-131-7" name="__codelineno-131-7" href="#__codelineno-131-7"></a>evaluator = create_trajectory_llm_as_judge(
</span><span id="__span-131-8"><a id="__codelineno-131-8" name="__codelineno-131-8" href="#__codelineno-131-8"></a>    prompt=TRAJECTORY_ACCURACY_PROMPT_WITH_REFERENCE,
</span><span id="__span-131-9"><a id="__codelineno-131-9" name="__codelineno-131-9" href="#__codelineno-131-9"></a>    model=&quot;openai:o3-mini&quot;
</span><span id="__span-131-10"><a id="__codelineno-131-10" name="__codelineno-131-10" href="#__codelineno-131-10"></a>)
</span></code></pre></div>
<p><strong>Run evaluator</strong></p>
<p>To run an evaluator, you will first need to create a LangSmith dataset. To use the prebuilt AgentEvals evaluators, you will need a dataset with the following schema:</p>
<ul>
<li><strong>input</strong>: {"messages": [...]} input messages to call the agent with.</li>
<li><strong>output</strong>: {"messages": [...]} expected message history in the agent output. For trajectory evaluation, you can choose to keep only assistant messages.</li>
</ul>
<div class="language-text highlight"><pre><span></span><code><span id="__span-132-1"><a id="__codelineno-132-1" name="__codelineno-132-1" href="#__codelineno-132-1"></a>from langsmith import Client
</span><span id="__span-132-2"><a id="__codelineno-132-2" name="__codelineno-132-2" href="#__codelineno-132-2"></a>from langgraph.prebuilt import create_react_agent
</span><span id="__span-132-3"><a id="__codelineno-132-3" name="__codelineno-132-3" href="#__codelineno-132-3"></a>from agentevals.trajectory.match import create_trajectory_match_evaluator
</span><span id="__span-132-4"><a id="__codelineno-132-4" name="__codelineno-132-4" href="#__codelineno-132-4"></a>
</span><span id="__span-132-5"><a id="__codelineno-132-5" name="__codelineno-132-5" href="#__codelineno-132-5"></a>client = Client()
</span><span id="__span-132-6"><a id="__codelineno-132-6" name="__codelineno-132-6" href="#__codelineno-132-6"></a>agent = create_react_agent(...)
</span><span id="__span-132-7"><a id="__codelineno-132-7" name="__codelineno-132-7" href="#__codelineno-132-7"></a>evaluator = create_trajectory_match_evaluator(...)
</span><span id="__span-132-8"><a id="__codelineno-132-8" name="__codelineno-132-8" href="#__codelineno-132-8"></a>
</span><span id="__span-132-9"><a id="__codelineno-132-9" name="__codelineno-132-9" href="#__codelineno-132-9"></a>experiment_results = client.evaluate(
</span><span id="__span-132-10"><a id="__codelineno-132-10" name="__codelineno-132-10" href="#__codelineno-132-10"></a>    lambda inputs: agent.invoke(inputs),
</span><span id="__span-132-11"><a id="__codelineno-132-11" name="__codelineno-132-11" href="#__codelineno-132-11"></a>    # replace with your dataset name
</span><span id="__span-132-12"><a id="__codelineno-132-12" name="__codelineno-132-12" href="#__codelineno-132-12"></a>    data=&quot;&lt;Name of your dataset&gt;&quot;,
</span><span id="__span-132-13"><a id="__codelineno-132-13" name="__codelineno-132-13" href="#__codelineno-132-13"></a>    evaluators=[evaluator]
</span><span id="__span-132-14"><a id="__codelineno-132-14" name="__codelineno-132-14" href="#__codelineno-132-14"></a>)
</span></code></pre></div>
<h2 id="reference">Reference<a class="headerlink" href="#reference" title="Permanent link">#</a></h2>
<p><a href="https://langchain-ai.github.io/langgraph/reference/">!LangGraph</a></p>







  
    
  
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Last update">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date" title="February 27, 2026 10:12:34 UTC">February 27, 2026</span>
  </span>

    
    
    
      
  
  <span class="md-source-file__fact">
    <span class="md-icon" title="Contributors">
      
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 4a4 4 0 0 1 4 4 4 4 0 0 1-4 4 4 4 0 0 1-4-4 4 4 0 0 1 4-4m0 10c4.42 0 8 1.79 8 4v2H4v-2c0-2.21 3.58-4 8-4"/></svg>
      
    </span>
    <nav>
      
        <a href="mailto:51238163+ganeshkinkar@users.noreply.github.com">ganeshkinkar</a>
    </nav>
  </span>

    
    
  </aside>





                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../../crewai/" class="md-footer__link md-footer__link--prev" aria-label="Previous: crewai">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                crewai
              </div>
            </div>
          </a>
        
        
          
          <a href="../LangGraphDetails/" class="md-footer__link md-footer__link--next" aria-label="Next: LangGraph Graph API">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                LangGraph Graph API
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-progress" data-md-component="progress" role="progressbar"></div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../../..", "features": ["navigation.instant", "navigation.instant.progress", "navigation.tracking", "navigation.sections", "navigation.expand", "navigation.top", "navigation.path", "navigation.footer", "navigation.indexes", "toc.follow", "search.highlight", "search.suggest", "search.share", "content.code.copy", "content.code.annotate"], "search": "../../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
    
  </body>
</html>